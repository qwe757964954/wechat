{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/hall/scripts/userInfoPrefabCtr.ts"],"names":["Label","Node","Sprite","Toggle","_decorator","GCache","AppEvent","AppSound","GConstants","GameRes","ReportConfig","UIID","Utils","SpriteLoad","EventManager","BaseComponent","Platform","ccclass","property","menu","prefab_playerCenter","tooltip","type","userSexNum","cacheSex","wechatNick","avatar","_isWxLogin","_openViewCount","_isGameIn","onLoad","updateUserInfo","WxAuthSettingButtonParam","node_PositionSizeToScreen","btnGetWXInfo","updateWXSettingButtonVisible","addModelListener","VIEW_UI_OPENED","onOpenedViewCallback","VIEW_UI_CLOSED","onClosedViewCallback","onInitModuleEvent","USER_UPDATE_INFO","USER_UPDATE_PROPERTY","updateUserMoney","PLATFORM_AUTHSETTING_UPDATE","respAuthButtonCreator","checkIsInGame","userId","User","getUserMid","number_valueOf","LoginRoomState","event","body","gender","getUserSex","sexBtnNode","active","maleNode","femaleNode","sp","getComponent","spriteFrame","userName","string","getUserName","changeSex","isNotNull","dispatch","SYS_TOAST_TIP","content","userID","otherUserID","changeBtnActive","coinLabel","string_matchStr","getUserMoneyByID","value","spriteLoad","headNode","headArray","getUserHeadArray","b","self","setRemoteUrl","setLocalLoad","Picture_UserBigHead_girl","bundle","path","Picture_UserBigHead_boy","onEnable","onDisable","viewParam","node","Prefab_ToastTip","visible","updateWxAuthSettingButtonVisible","isValid","respPlatformFail","errorCode","console","log","LoginStateCode","platform_fail_wx_access_token_error","platform_fail_wx_notAuthSetting","button","WxAuthSettingUserInfo","WxUserInfo","__toChangeInfo","onClickClose","SYS_PLAY_EFFECT","CommClick","VIEW_UI_CLOSE","PlayerInfoCenter","sex","NET_REQ_SET_USERINFO","REPORT_CLIENT_CLICK","eventID","userInfo_1","onClickSex","custom","userInfo_2","getChildByName","isChecked","onClickCopy","e","copyClipboard","userInfo_3","start","AppCommon_GetUserInfo_WX","isWXPlatform","onClickSyncWXInfo","tmpName","name","string_isEmpty","nick","String","userInfo_4","onDestroy","onMaskClose","destroy"],"mappings":"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","sourcesContent":["\nimport { EventTouch, Label, Node, Sprite, Toggle, _decorator } from 'cc';\nimport { GCache } from '../../../cache/GCache';\nimport { AppEvent } from '../../../config/AppEvent';\nimport { AppSound } from '../../../config/AppSound';\nimport { GConstants } from '../../../config/GameConstant';\nimport { GameRes } from '../../../config/GameRes';\nimport { ReportConfig } from '../../../config/ReportConfig';\nimport { UIID } from '../../../config/UIConfig';\nimport { Utils } from '../../../framework/Utils';\nimport SpriteLoad from '../../../framework/gui/sprite/SpriteLoad';\nimport { EventManager } from '../../../framework/manager/EventManager';\nimport { BaseComponent } from '../../../framework/vc/BaseComponent';\nimport { Platform } from '../../../platform/Platform';\nconst { ccclass, property, menu } = _decorator;\n\n/**\n * Name = prefab_playerCenter\n * URL = db://assets/resources/prefab/prefab_playerCenter.ts\n * Time = Thu Apr 07 2022 11:37:28 GMT+0800 (中国标准时间)\n * Author = Tomoe\n *\n * Life: onLoad-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n */\n\n@ccclass('prefab_playerCenter')\n//方便编辑器识别的菜单项目\n@menu('prefab/hall/playerCenter')\n\nexport class prefab_playerCenter extends BaseComponent {\n\t/**性别选择按钮父节点 */\n\t@property(Node)\n\tsexBtnNode: Node = null!;\n\t/** 银币数量*/\n\t@property(Label)\n\tcoinLabel: Label = null!;\n\t/**用户昵称 */\n\t@property(Label)\n\tuserName: Label = null!;\n\t/** 用户ID*/\n\t@property(Label)\n\tuserID: Label = null!;\n\n\t@property(Label)\n\totherUserID: Label = null!;\n\t/** 用户头像*/\n\t@property(Node)\n\theadNode: Node = null!;\n\n\t//同步微信用户信息\n\t@property({ tooltip: \"同步微信用户信息\", type: Node })\n\tprivate btnGetWXInfo: Node | null = null;\n\n\t@property({ tooltip: \"男性图标\", type: Node })\n\tprivate maleNode: Node | null = null;\n\n\t@property({ tooltip: \"女性图标\", type: Node })\n\tprivate femaleNode: Node | null = null;\n\n\t\n\t/** 用户性别 */\n\tuserSexNum: number;\n\t/** 修改性别缓存 */\n\tcacheSex = null;\n\t/** 微信昵称 */\n\twechatNick = null;\n\t/** 头像 */\n\tavatar = null;\n\t/** 是否是微信登录 */\n\tprivate _isWxLogin = false;\n\tprivate _openViewCount = 0;\n\t/** 是否在游戏中 */\n\tprivate _isGameIn = false;\n\tonLoad() {\n\n\t\tthis.updateUserInfo(null);\n\t\t//设置授权按钮的坐标\n\t\tPlatform.WxAuthSettingButtonParam = Utils.node_PositionSizeToScreen(this.btnGetWXInfo);\n\t\tthis._openViewCount = 0;\n\t\tthis.updateWXSettingButtonVisible(false);\n\t\t//打开了界面\n\t\tthis.addModelListener(AppEvent.VIEW_UI_OPENED, this.onOpenedViewCallback)\n\t\t//关闭了界面\n\t\tthis.addModelListener(AppEvent.VIEW_UI_CLOSED, this.onClosedViewCallback)\n\t};\n\n\n\tprotected onInitModuleEvent() {\n\t\t//用户信息更新\n\t\tthis.addModelListener(AppEvent.USER_UPDATE_INFO, this.updateUserInfo)\n\t\t//用户资产更新\n\t\tthis.addModelListener(AppEvent.USER_UPDATE_PROPERTY, this.updateUserMoney)\n\n\t\t//授权按钮创建成功/授权成功\n\t\tthis.addModelListener(AppEvent.PLATFORM_AUTHSETTING_UPDATE, this.respAuthButtonCreator)\n\t}\n\n\t\n\tcheckIsInGame() {\n\t\tlet userId = GCache.User.getUserMid(\"\");\n\t\tuserId = Utils.number_valueOf(userId);\n\t\tthis._isGameIn =  GCache.User.LoginRoomState;\n\t}\n\n\t//更新用户信息\n\tupdateUserInfo(event = null, body = null) {\n\t\tthis.checkIsInGame();\n\t\tlet gender = GCache.User.getUserSex()\n\t\tgender = Utils.number_valueOf(gender);\n\t\tgender = gender > 0 ? gender : 1;\n\t\tif (this._isGameIn) {\n\t\t\tthis.sexBtnNode.active = false;\n\t\t\tthis.maleNode.active = true;\n\t\t\tthis.femaleNode.active = false;\n\t\t\tif (gender==2) {\n\t\t\t\tlet sp = this.femaleNode.getComponent(Sprite).spriteFrame;\n\t\t\t\tthis.maleNode.getComponent(Sprite).spriteFrame = sp;\n\t\t\t} \n\t\t}\n\t\t\n\t\tif (body) {\n\t\t\tthis.userName.string = GCache.User.getUserName();\n\t\t\tthis.changeSex(gender);\n\t\t\tif (Utils.isNotNull(body['nick'])) {\n\t\t\t\tEventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: \"已同步微信昵称和头像\" });\n\t\t\t}\t\n\t\t} else {\n\t\t\tthis.updateUserMoney();\n\t\t\tthis.userName.string = GCache.User.getUserName();\n\t\t\tthis.userID.string = GCache.User.getUserMid(\"\");\n\t\t\tthis.otherUserID.string = this.userID.string;\n\t\t\tthis.changeBtnActive();\n\t\t\tthis.changeSex(gender);\n\t\t}\n\t}\n\t/**\n\t * 更新用户资产\n\t * @param event \n\t * @param body \n\t */\n\tupdateUserMoney(event = null, body = null) {\n\t\tthis.coinLabel.string = Utils.string_matchStr(GCache.User.getUserMoneyByID(0));//货币类型 0:银币，1：金条 2：兑换券\n\t}\n\n\n\t/**\n\t * 修改默认头像,如果有数据则用远程图片,没有则用默认头像\n\t * @param value \n\t */\n\tchangeSex(value: number) {\n\t\tlet spriteLoad = this.headNode.getComponent(SpriteLoad);\n\t\tlet headArray = GCache.User.getUserHeadArray();\n\t\tif (headArray && headArray.b != \"\") {\n\t\t\tlet self = this;\n\t\t\tspriteLoad.setRemoteUrl(headArray.b)\n\t\t} else { \n\t\t\tif (value == 2) {\n\t\t\t\tspriteLoad.setLocalLoad(GameRes.Picture_UserBigHead_girl.bundle, GameRes.Picture_UserBigHead_girl.path);\n\t\t\t} else {\n\t\t\t\tspriteLoad.setLocalLoad(GameRes.Picture_UserBigHead_boy.bundle, GameRes.Picture_UserBigHead_boy.path);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 可见\n\t */\n\tonEnable() {\n\t\tthis.updateWXSettingButtonVisible(true);\n\t\tthis._openViewCount = 0;\n\t}\n\n\t/**\n\t * 不可见\n\t */\n\tonDisable() {\n\t\tthis.updateWXSettingButtonVisible(false);\n\t}\n\n\t/**\n\t * 界面打开的回调\n\t * @param event \n\t * @param viewParam \n\t * @returns \n\t */\n\tonOpenedViewCallback(event = null, viewParam) {\n\t\tif (this.node.active == false) {\n\t\t\treturn;\n\t\t}\n\t\t//防止重叠\n\t\tif (viewParam[\"Prefab\"] == GameRes.Prefab_ToastTip.path) {\n\t\t\treturn;\n\t\t}\n\t\tthis._openViewCount = this._openViewCount + 1;\n\t\tthis.updateWXSettingButtonVisible(false);\n\t}\n\n\t/**\n\t * 界面关闭的回调\n\t * @param event \n\t * @param viewParam \n\t * @returns \n\t */\n\tonClosedViewCallback(event = null, viewParam) {\n\t\tif (this.node.active == false) {\n\t\t\treturn;\n\t\t}\n\t\tif (viewParam[\"Prefab\"] == GameRes.Prefab_ToastTip.path) {\n\t\t\treturn;\n\t\t}\n\t\tthis._openViewCount = this._openViewCount - 1;\n\t\tif (this._openViewCount < 0) {\n\t\t\tthis._openViewCount = 0;\n\t\t}\n\t\tif (this._openViewCount == 0) {\n\t\t\tthis.updateWXSettingButtonVisible(true);\n\t\t} else {\n\t\t\tthis.updateWXSettingButtonVisible(false);\n\t\t}\n\t}\n\n\n\t//更新同步微信用户信息按钮的显示和隐藏状态\n\tupdateWXSettingButtonVisible(visible?: boolean) {\n\t\tif (this._isGameIn) { \n\t\t\tthis.btnGetWXInfo.active = false;\n\t\t\tif (this._isWxLogin == true) {\n\t\t\t\tPlatform.updateWxAuthSettingButtonVisible(false);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (this._isWxLogin == true) {\n\t\t\tPlatform.updateWxAuthSettingButtonVisible(visible);\n\t\t\tif (this.node && this.node.isValid) {\n\t\t\t\tthis.btnGetWXInfo.active = false;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.btnGetWXInfo && this.btnGetWXInfo.isValid) {\n\t\t\t\tthis.btnGetWXInfo.active = visible;\n\t\t\t}\n\t\t}\n\t}\n\n\n\t/**\n\t * 平台返回的登录失败,由微信调\n\t * @param event \n\t * @param errorCode \n\t */\n\trespPlatformFail(event, errorCode: number) {\n\t\tconsole.log(`平台返回的授权失败 errorCode = ${errorCode}`)\n\t\tif (errorCode <= GConstants.LoginStateCode.platform_fail_wx_access_token_error) {\n\t\t\t//全是wx平台的错误\n\t\t\tif (errorCode == GConstants.LoginStateCode.platform_fail_wx_notAuthSetting) {\n\t\t\t\t//未取得授权\n\n\t\t\t} else {\n\t\t\t\t//其他错误\n\t\t\t}\n\t\t\tthis.updateWXSettingButtonVisible(true);\n\t\t}\n\t}\n\n\n\t/**\n\t * 授权按钮创建成功/授权成功\n\t * @param event \n\t * @param button \n\t */\n\trespAuthButtonCreator(event, button) {\n\t\tif (button) {\n\t\t\tthis.updateWXSettingButtonVisible(true);\n\t\t} else {\n\t\t\tif (Platform.WxAuthSettingUserInfo == 1) {//授权成功\n\t\t\t\tconsole.log(\"授权成功 平台用户信息\", Platform.WxUserInfo)\n\t\t\t\tthis.__toChangeInfo(Platform.WxUserInfo[\"nickName\"], Platform.WxUserInfo[\"avatarUrl\"])\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 点击上传更新性别并关闭该预制体\n\t * @param event\n\t */\n\tonClickClose(event: EventTouch) {\n\t\tEventManager.dispatch(AppEvent.SYS_PLAY_EFFECT, AppSound.CommClick);\n\t\tif (this._isGameIn) { \n\t\t\tEventManager.dispatch(AppEvent.VIEW_UI_CLOSE, UIID.PlayerInfoCenter);\n\t\t\treturn;\n\t\t}\n\t\tif (this.cacheSex != null) {\n\t\t\tlet body = {\n\t\t\t\tsex: this.cacheSex,\n\t\t\t}\n\t\t\tEventManager.dispatch(AppEvent.NET_REQ_SET_USERINFO, body);\n\t\t}\n\t\tEventManager.dispatch(AppEvent.SYS_PLAY_EFFECT, AppSound.CommClick);\n\t\tEventManager.dispatch(AppEvent.REPORT_CLIENT_CLICK, { eventID: ReportConfig.userInfo_1 });\n\t\tEventManager.dispatch(AppEvent.VIEW_UI_CLOSE, UIID.PlayerInfoCenter);\n\t}\n\n\t/**\n\t * 修改性别点击监听\n\t * @param event \n\t * @param custom \n\t */\n\tonClickSex(event: EventTouch, custom: string) {\n\t\tif (this._isGameIn) { \n\t\t\treturn;\n\t\t}\n\t\tif (custom == \"man\") {\n\t\t\tthis.cacheSex = 1\n\t\t} else if (custom == \"woman\") {\n\t\t\tthis.cacheSex = 2\n\t\t}\n\t\t//切换性别\n\t\tEventManager.dispatch(AppEvent.REPORT_CLIENT_CLICK, { eventID: ReportConfig.userInfo_2 });\n\t}\n\n\n\t/**\n\t * 修改性别按钮状态:1男2女0保密,如果是0,则为男\n\t */\n\tchangeBtnActive() {\n\t\tlet gender = GCache.User.getUserSex();\n\t\tgender = Utils.number_valueOf(gender,0);\n\t\tthis.userSexNum = gender;\n\t\tif (this.userSexNum == 0) {\n\t\t\tthis.userSexNum = 1;\n\t\t\tthis.cacheSex = 1;\n\t\t}\n\t\tif (this.userSexNum == 1) {\n\t\t\tthis.sexBtnNode.getChildByName(\"Toggle1\").getComponent(Toggle).isChecked = true;\n\t\t} else {\n\t\t\tthis.sexBtnNode.getChildByName(\"Toggle2\").getComponent(Toggle).isChecked = true;\n\t\t}\n\t}\n\n\t/**\n\t * 复制ID\n\t * @param e \n\t */\n\tonClickCopy(e: any) {\n\t\tEventManager.dispatch(AppEvent.SYS_PLAY_EFFECT, AppSound.CommClick);\n\t\tPlatform.copyClipboard(GCache.User.getUserMid());\t\n\t\tEventManager.dispatch(AppEvent.REPORT_CLIENT_CLICK, { eventID: ReportConfig.userInfo_3 });\n\t}\n\n\tstart() {\n\t\tPlatform.updateWxAuthSettingButtonVisible(null);\n\t\tPlatform.WxAuthSettingButtonParam[\"img\"] = GameRes.AppCommon_GetUserInfo_WX.path;\n\t\tthis._isWxLogin = Platform.isWXPlatform();\n\t\tthis.updateWXSettingButtonVisible(true);\n\t\tconsole.log(\"授权按钮的屏幕参数：\", Platform.WxAuthSettingButtonParam);\n\t};\n\n\n\n\t/**\n\t * 点击同步微信昵称,这个方法在实际微信中不会调用,只是在模拟器环境下开发\n\t * @param event \n\t */\n\tonClickSyncWXInfo(event: EventTouch = null) {\n\t\tEventManager.dispatch(AppEvent.SYS_PLAY_EFFECT, AppSound.CommClick);\n\t\tlet tmpName = \"测试1\" + GCache.User.getUserMid();\n\t\tlet avatar = 'https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI8sibBlJEE6mfxaKkdlFtAJ9tQGGDrAOEZDIEThRUqcBIr2gWQtde0wJIEfhSc4swl4PCW72LjqIg/132';\n\t\tthis.__toChangeInfo(tmpName, avatar);\n\t}\n\n\t/**\n\t * 更新用户昵称,头像\n\t * @param name \n\t * @param avatar \n\t * @returns \n\t */\n\tprivate __toChangeInfo(name: string, avatar: string) {\n\t\tif (Utils.string_isEmpty(name)) {\n\t\t\tEventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: \"err:昵称不能为空\" });\n\t\t\treturn;\n\t\t}\n\t\tlet body = {\n\t\t\tnick: String(name),\n\t\t\tavatar: avatar\n\t\t}\n\t\tEventManager.dispatch(AppEvent.NET_REQ_SET_USERINFO, body)\n\t\tEventManager.dispatch(AppEvent.REPORT_CLIENT_CLICK, { eventID: ReportConfig.userInfo_4 });\n\t}\n\n\n\t/**\n\t * 销毁\n\t */\n\tonDestroy() {\n\t\tPlatform.updateWxAuthSettingButtonVisible(null);\n\t};\n\n\t/**\n\t * 点击蒙版外面的关闭界面\n\t */\n\tonMaskClose() {\n\t\tEventManager.dispatch(AppEvent.SYS_PLAY_EFFECT, AppSound.CommClick);\n\t\tthis.node.destroy();\n\t}\n}\n\n"]}