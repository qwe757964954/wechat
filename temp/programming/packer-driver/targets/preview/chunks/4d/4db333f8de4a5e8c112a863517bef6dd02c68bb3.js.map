{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/module/opInfo/src/Carditem.ts"],"names":["instantiate","Layout","Node","Prefab","UITransform","_decorator","EventManager","BaseComponent","OperationMgr","GameEvent","Card","ccclass","property","Carditem","tooltip","type","onInitModuleEvent","updateCardItemProp","opTypes","opCards","node","removeAllChildren","i","item","itemPrefab","opType","cardList","getInstance","getOprationCardList","code","idx","cardInfo","cards","getOprationListNumber","forEach","cardValue","CardPrefab","getComponent","setCardByte","transform","setContentSize","addChild","off","EventType","TOUCH_END","on","opClick","length","opNode","height","setPosition","opCode","index","req","opCard","getPassNumber","seatId","userId","dispatch","SEND_PLAYER_OPERATION","myOpCode"],"mappings":"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","sourcesContent":["\nimport { instantiate, Layout, Node, Prefab, UITransform, _decorator } from 'cc';\nimport { EventManager } from '../../../../../framework/manager/EventManager';\nimport { BaseComponent } from '../../../../../framework/vc/BaseComponent';\nimport { OperationMgr } from '../../../cache/OperationMgr';\nimport { GameEvent } from '../../../common/GameEvent';\nimport { Common } from '../../../common/idl/Common';\nimport { Game } from '../../../common/idl/Game';\nimport { Card } from '../../card/src/Card';\nimport { OpType } from './OpInfo';\nconst { ccclass, property } = _decorator;\n\n/**\n * Name = Carditem\n * URL = db://assets/package/game/module/opInfo/src/Carditem.ts\n * Time = Fri Aug 18 2023 15:19:38 GMT-0700 (北美太平洋夏令时间)\n * Author = qwe757964\n *\n * Life: onLoad-->onInitModuleEvent-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n * \n */\n \n@ccclass('Carditem')\nexport class Carditem extends BaseComponent {\n\t@property({ tooltip: \"手牌预制体\", type: Prefab })\n\tprivate CardPrefab: Prefab | null = null;\n\t@property(Prefab)\n\tprivate itemPrefab: Prefab | null = null;\n\t@property(Layout)\n\tprivate opCards: Layout | null = null;\n\t/** override 初始化模块事件 */\n\tprotected onInitModuleEvent() {\n\n\t};\n\n\tpublic updateCardItemProp(opTypes:OpType[]){\n\t\tthis.opCards.node.removeAllChildren();\n\t\tfor (let i = 0;i<opTypes.length;i++){\n\t\t\tlet item = instantiate(this.itemPrefab);\n\t\t\tlet opType:OpType = opTypes[i];\n\t\t\tlet cardList:Common.ICards[] = OperationMgr.getInstance().getOprationCardList(opType.code);\n\t\t\tfor (let idx = 0; idx < cardList.length; idx++) {\n\t\t\t\tlet cardInfo:Common.ICards = cardList[idx];\n\t\t\t\tlet cards:number[] = OperationMgr.getInstance().getOprationListNumber(opType.code,idx);\n\t\t\t\tcards.forEach(cardValue => {\n\t\t\t\t\tlet node = instantiate(this.CardPrefab);\n\t\t\t\t\tnode.getComponent(Card).setCardByte(cardValue);\n\t\t\t\t\tlet transform = node.getComponent(UITransform);\n\t\t\t\t\ttransform.setContentSize(53, 78);\n\t\t\t\t\titem.addChild(node);\n\t\t\t\t});\n\t\t\t\titem.off(Node.EventType.TOUCH_END);\n\t\t\t\titem.on(Node.EventType.TOUCH_END, () => {\n\t\t\t\t\tthis.opClick(opType.code,idx);\n\t\t\t\t}, this);\n\t\t\t\tthis.opCards.node.addChild(item);\n\t\t\t}\n\t\t}\n\t\tlet opNode = opTypes[0].node;\n\t\tlet transform = this.node.getComponent(UITransform);\n\t\ttransform.height = 100;\n\t\tthis.node.setPosition(-81,0);\n\t\topNode.addChild(this.node);\n\t}\n\n\tpublic opClick(opCode?:number,index?:number){\n\t\tlet req: Game.ISendOperation = {\n            opCard:OperationMgr.getInstance().getPassNumber(),\n\t\t\topCode:opCode,\n\t\t\topCards:OperationMgr.getInstance().getOprationListNumber(opCode,index),\n\t\t\tseatId:OperationMgr.getInstance().seatId,\n\t\t\tuserId:OperationMgr.getInstance().userId\n        }\n\t\tEventManager.dispatch(GameEvent.SEND_PLAYER_OPERATION, req);\n        OperationMgr.getInstance().myOpCode = opCode;\n\t}\n}\n\n"]}