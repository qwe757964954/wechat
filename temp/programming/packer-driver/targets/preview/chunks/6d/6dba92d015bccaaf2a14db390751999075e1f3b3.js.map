{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/proj/gnet/GCmdMapping.ts"],"names":["_GCmdMapping","Logger","Utils","GlobalCmdBindingHead","GlobalHeadCmdBinding","instance","_instance","constructor","mapCmdAction","mapCmdReqHead","mapCmdEvent","mapHeadCmdEvent","_addPushCmdArrayList","refreshGloabelMapping","logModel","headCmd","Object","prototype","hasOwnProperty","call","mapping","respEvent","cmd","action","reqHead","dump","initCommonMapping","pushHeadMapping","ArrayList","getReqHeadByCmd","getActionByCmd","getEventIDByCmd","getEventIDByHeadCmd","GCmdMapping"],"mappings":"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","sourcesContent":["/**\n * Name = GCmdMapping\n * URL = db://assets/proj/gnet/GCmdMapping.ts\n * Time = Fri May 13 2022 14:58:45 GMT+0800 (中国标准时间)\n * Author = xueya\n * 网络命令映射\n */\nimport { Logger } from \"../../framework/log/Logger\";\nimport { ICMD_BINDING_HEAD } from \"../../framework/network/NetInterface\";\nimport { Utils } from \"../../framework/Utils\";\nimport { GlobalCmdBindingHead, GlobalHeadCmdBinding } from \"./GlobalCMD\";\n\nclass _GCmdMapping {\n\n\t//cmd-action映射\n\tmapCmdAction = {};\n\t//cmd-reqHead映射\n\tmapCmdReqHead = {};\n\t//cmd-event映射\n\tmapCmdEvent = {};\n\t//headCmd-event映射\n\tmapHeadCmdEvent = {};\n\n\t//新增加的命令\n\t_addPushCmdArrayList = {};\n\n\tprivate static _instance = null;\n\tpublic static get instance(): _GCmdMapping {\n\t\tif (!this._instance || this._instance == null) {\n\t\t\tthis._instance = new _GCmdMapping();\n\t\t}\n\t\treturn this._instance;\n\t}\n\n\t//实例化\n\tconstructor() {\n\n\t};\n\t//刷新全局mapping\n\trefreshGloabelMapping() {\n\t\tLogger.logModel(\"[GCmdMapping]:refreshMapping 刷新mapping\")\n\t\tfor (let headCmd in GlobalHeadCmdBinding) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(GlobalHeadCmdBinding, headCmd)) {\n\t\t\t\tlet mapping: ICMD_BINDING_HEAD = GlobalHeadCmdBinding[headCmd];\n\t\t\t\t/** 序列化 方便查找 */\n\t\t\t\tthis.mapHeadCmdEvent[headCmd] = mapping.respEvent\n\t\t\t}\n\t\t}\n\n\t\tfor (let cmd in GlobalCmdBindingHead) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(GlobalCmdBindingHead, cmd)) {\n\t\t\t\tlet mapping: ICMD_BINDING_HEAD = GlobalCmdBindingHead[cmd];\n\t\t\t\t/** 序列化 方便查找 */\n\t\t\t\tthis.mapCmdAction[cmd] = mapping.action\n\t\t\t\tthis.mapCmdReqHead[cmd] = mapping.reqHead\n\t\t\t\tthis.mapCmdEvent[cmd] = mapping.respEvent\n\t\t\t}\n\t\t}\n\t\tUtils.dump(this.mapCmdEvent)\n\t}\n\t//初始化通用映射\n\tinitCommonMapping() {\n\t\t//cmd-action映射\n\t\tthis.mapCmdAction = {};\n\t\t//cmd-reqHead映射\n\t\tthis.mapCmdReqHead = {};\n\t\t//cmd-event映射\n\t\tthis.mapCmdEvent = {};\n\t\t//headCmd-event映射\n\t\tthis.mapHeadCmdEvent = {};\n\n\t\tthis.refreshGloabelMapping()\n\t}\n\t//新增命令头映射\n\tpushHeadMapping(ArrayList) {\n\t\tif (!ArrayList) {\n\t\t\treturn\n\t\t}\n\t\tfor (let headCmd in ArrayList) {\n\t\t\tif (Object.prototype.hasOwnProperty.call(ArrayList, headCmd)) {\n\t\t\t\tlet mapping: ICMD_BINDING_HEAD = ArrayList[headCmd];\n\t\t\t\t/** 序列化 方便查找 */\n\t\t\t\tif (mapping.respEvent != null) {\n\t\t\t\t\tthis.mapHeadCmdEvent[headCmd] = mapping.respEvent\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n\t//根据Cmd获取请求头\n\tpublic getReqHeadByCmd(cmd: number) {\n\t\tif (!cmd) {\n\t\t\treturn null\n\t\t}\n\t\treturn this.mapCmdReqHead[cmd]\n\t}\n\n\t//根据Cmd获取action\n\tpublic getActionByCmd(cmd: number) {\n\t\tif (!cmd) {\n\t\t\treturn null\n\t\t}\n\t\treturn this.mapCmdAction[cmd] || null\n\t}\n\t//根据cmd获取Event\n\tpublic getEventIDByCmd(cmd: number) {\n\t\tif (!cmd) {\n\t\t\treturn null\n\t\t}\n\t\treturn this.mapCmdEvent[cmd] || null\n\t}\n\t//根据headCmd获取Event\n\tpublic getEventIDByHeadCmd(headCmd: number) {\n\t\tif (!headCmd) {\n\t\t\treturn null\n\t\t}\n\t\treturn this.mapHeadCmdEvent[headCmd] || null\n\t}\n\n}\n\nexport const GCmdMapping = _GCmdMapping.instance"]}