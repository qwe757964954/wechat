{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/scripts/GameScenePrefabCtr.ts"],"names":["Button","Node","Prefab","SpriteAtlas","_decorator","GCache","GConstants","inf_LayerType","LayerManager","LayerPopUp","EventManager","BaseComponent","PlayerMgr","RoomMgr","FXJController","FXJEvent","FXJRes","FXJUIConfig","FXJUIID","FXJSound","GameEvent","Ai","BugangBottom","BugangTop","Remain","Match","OpInfo","NodeUserCtr","ccclass","property","menu","GameScenePrefabCtr","tooltip","type","constructor","_nodePopUp","console","log","initModules","firstRunLoadSuccess","preLoaderRes","init","getInstance","GameSceneCtr","list","ddzRes","Prefab_Menu","resType","Prefab_NodeUser","Prefab_Desk","Prefab_HandCard","Prefab_Match_Player","Prefab_op","Prefab_Match","Prefab_GameSettle","Prefab_Settle_Image","Picture_Game_Card","getPreLoaderArrayRes","onInitModuleEvent","addModelListener","GAME_OPEN_POPUP","onOpenPopUp","GAME_CLOSE_POPUP","onClosePopUp","VIEW_BROADCAST_GRAB_CARD","grabCardEvent","VIEW_BROADCAST_PLAYER_ENTER","onPlayerInto","ENTER_ROOM_UPDATE_PLAYER","enterRoomUpdatePlayer","VIEW_UPDATE_FAN_GANG_PAI","updateFanGangPai","VIEW_UPDATE_BU_GANG_PAI","updateBuGangPai","UPDATE_REMAIN_CARDS_COUNT","updateRemainCardsCount","VIEW_USER_OPERATION","viewUserOperation","SHOW_HIDEN_MATCH_VIEW","showHidenMatchView","VIEW_BROADCAST_GAME_OVER","onGameOver","VIEW_BROADCAST_GAME_START","onGameStart","VIEW_PLAYER_AI_SHOW","modifyPlayerDeposit","EXITS_SETTLE_VIEW","exitsSettleView","btnBack","node","active","event","respData","mid","getMyPlayerInfo","userId","ai","showAiView","onLoad","updateConfig","onViewLoad","initView","dispatch","SYS_PLAY_MUSIC","BgGame","remain","resp","opInfo","updateOpration","bugangTop","fangangCards","bugangBottom","start","PopUp","nodePopup","addChild","getPreLoaderRes","bundle","path","res","nodeMenu","removeAllChildren","Prefab_Opmgr","updateView","playerLoign","VIEW_UI_3D_ADD","nodeHandCard","Desk","isReconnect","RECEIVE_DEAL_CARD","DRAW_MY_CARD","dingzhang","playerList","forEach","player","uid","palyer","findPlayerWithUserId","data","posID","seatId","nodeUser","showUserView","onClickTest","customEventData","isShow","match","getComponent","UIID","Data","callbacks","has","isLoading","open","ToolBarPrefab","GameChatPrefab","getChildByName","destroy","layerConf","clear","layer","onDestroy","VIEW_UI_3D_REMOVE","onViewDestroy","resetView","CLEAN_HAND_CARD","CLEAN_AI_SHOWING","onCloseBack","SYS_PLAY_EFFECT","CommClick","getRoomStates","GameRoomState","STATUS_EXITSUCCESS","EXITS_GAME_ROOM_VIEW","NET_REQ_LOGOUT_IN_GAME"],"mappings":"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","sourcesContent":["// import { Event } from 'game/mahjong/config/Event';\n\nimport { Button, Node, Prefab, SpriteAtlas, _decorator } from 'cc';\nimport { GCache } from '../../../cache/GCache';\nimport { GConstants } from '../../../config/GameConstant';\nimport { inf_LayerType } from '../../../framework/InterfaceDefines';\nimport { LayerManager } from '../../../framework/layer/LayerManager';\nimport { LayerPopUp } from '../../../framework/layer/LayerPopup';\nimport { EventManager } from '../../../framework/manager/EventManager';\nimport { BaseComponent } from '../../../framework/vc/BaseComponent';\nimport { PlayerMgr } from '../cache/PlayerMgr';\nimport { RoomMgr } from '../cache/RoomMgr';\nimport { FXJController } from '../common/FXJController';\nimport { FXJEvent } from '../common/FXJEvent';\nimport { FXJRes, FXJUIConfig, FXJUIID } from '../common/FXJRes';\nimport { FXJSound } from '../common/FXJSound';\nimport { GameEvent } from '../common/GameEvent';\nimport { Game } from '../common/idl/Game';\nimport { Ai } from '../module/ai/src/Ai';\nimport { BugangBottom } from '../module/bugang/src/BugangBottom';\nimport { BugangTop } from '../module/bugang/src/BugangTop';\nimport { Remain } from '../module/bugang/src/Remain';\nimport { Match } from '../module/match/src/Match';\nimport { OpInfo } from '../module/opInfo/src/OpInfo';\nimport { NodeUserCtr } from './NodeUserCtr';\nconst { ccclass, property, menu } = _decorator;\n\n/**\n * Name = GameScenePrefabCtr\n * URL = db://assets/package/game/scripts/GameScenePrefabCtr.ts\n * Time = Thu Jul 27 2023 18:05:11 GMT+0800 (中国标准时间)\n * Author = harvyson\n * 飞小鸡游戏场景\n * Life: onLoad-->onInitModuleEvent-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n * \n */\n \n@ccclass('GameScenePrefabCtr')\n//方便编辑器识别的菜单项目\n@menu('prefab/game/GameScenePrefabCtr')\nexport class GameScenePrefabCtr extends BaseComponent {\n\t//背景节点\n\t@property({ tooltip: \"背景节点\", type: Node })\n\tprivate nodeBg: Node | null = null;\n\n\t//角色节点——其它\n\t@property({ tooltip: \"角色节点——其它\", type: Node })\n\tprivate nodeRoleOther: Node | null = null;\n\n\t//角色节点——自己\n\t@property({ tooltip: \"角色节点——自己\", type: Node })\n\tprivate nodeRoleSlef: Node | null = null;\n\n\t//用户节点\n\t@property({ tooltip: \"用户节点\", type: NodeUserCtr })\n\tprivate nodeUser: NodeUserCtr | null = null;\n\n\t//手牌节点\n\t@property({ tooltip: \"手牌节点\", type: Node })\n\tprivate nodeHandCard: Node | null = null;\n\n\t//菜单节点\n\t@property({ tooltip: \"菜单节点\", type: Node })\n\tprivate nodeMenu: Node | null = null;\n\n\t//菜单节点\n\t@property({ tooltip: \"操作节点\", type: Node })\n\tprivate opration: Node | null = null;\n\n\t//普通动画操作根节点\n\t@property({ tooltip: \"普通动画操作根节点\", type: Node })\n\tprivate nodeNormalAnim: Node | null = null;\n\n\t//弹框节点\n\t@property({ tooltip: \"弹框节点\", type: Node })\n\tprivate nodePopup: Node | null = null;\n\n\t//退出按钮\n\t@property({ tooltip: \"退出按钮\", type: Button })\n\tprivate btnBack: Button | null = null;\n\n\t//ai弹框\n\t@property({ tooltip: \"ai弹窗\", type: Ai })\n\tprivate ai: Ai | null = null;\n\n\t@property(OpInfo)\n    public opInfo: OpInfo | null = null; \n\t\n\t@property(BugangTop)\n    public bugangTop: BugangTop | null = null;\n\t\n\t@property(Remain)\n    public remain: Remain | null = null;  \n\t\n\t@property(Match)\n    public match: Match | null = null;  \n\t\n\t@property(BugangBottom)\n    public bugangBottom: BugangBottom | null = null;  \n\n\t//真实弹窗节点\n\tprivate _nodePopUp: LayerPopUp = null;\n\t\n\tconstructor() {\n\t\tsuper()\n\t\tconsole.log(\"==============飞小鸡游戏场景初始化========\");\n\t\tthis.initModules();\n\t}\n\t//加载初始化\n\tinitModules() {\n\t\tif (!GCache.firstRunLoadSuccess) {\n\t\t\treturn;\n\t\t}\n\t\tthis.preLoaderRes();\n\t\t\n\t\tFXJController.init();\n\t\tFXJController.getInstance().GameSceneCtr = this;\n\t}\n\t\n\t//预加载\n\tpreLoaderRes() {\n\t\tif (!GCache.firstRunLoadSuccess) {\n\t\t\treturn;\n\t\t}\n\n\n\t\tlet list = [\n\t\t\t// { ddzRes: FXJRes.Prefab_GameHeadInfo, resType: Prefab },\n\t\t\t{ ddzRes: FXJRes.Prefab_Menu, resType: Prefab },\n\t\t\t{ ddzRes: FXJRes.Prefab_NodeUser, resType: Prefab },\n\t\t\t{ ddzRes: FXJRes.Prefab_Desk, resType: Prefab },\n\t\t\t{ ddzRes: FXJRes.Prefab_HandCard, resType: Prefab },\n\t\t\t{ ddzRes: FXJRes.Prefab_Match_Player, resType: Prefab },\n\t\t\t{ ddzRes: FXJRes.Prefab_op, resType: Prefab },\n\t\t\t{ ddzRes: FXJRes.Prefab_Match, resType: Prefab },\n\t\t\t{ ddzRes: FXJRes.Prefab_GameSettle, resType: Prefab },\n\t\t\t{ ddzRes: FXJRes.Prefab_Settle_Image, resType: SpriteAtlas },\n\t\t\t{ ddzRes: FXJRes.Picture_Game_Card, resType: SpriteAtlas },\n\t\t\t\n\t\t\t\n\t\t\t// { ddzRes: FXJRes.Atlas_Game_Clock, resType: SpriteAtlas }\n\t\t];\n\t\t\n\t\tthis.getPreLoaderArrayRes(list, () => {\n\t\t\t// console.log(\"----->\", Utils.timeParse(Utils.time()));\n\t\t\t// let res = assetManager.getBundle(\"game\").get(FXJRes.Prefab_Match.path, Prefab);\n\t\t\t// console.warn(\"preLoaderRes-->\", res);\n\t\t});\n\t}\n\n\t/** override 初始化模块事件 */\n\tprotected onInitModuleEvent() {\n\t\t//打开二级弹窗\n\t\tthis.addModelListener(FXJEvent.GAME_OPEN_POPUP, this.onOpenPopUp)\n\t\t//关闭二级弹窗\n\t\tthis.addModelListener(FXJEvent.GAME_CLOSE_POPUP, this.onClosePopUp)\n\n\t\t// //玩家进入房间\n\t\tthis.addModelListener(GameEvent.VIEW_BROADCAST_GRAB_CARD, this.grabCardEvent);\n\t\t//玩家进入房间\n\t\tthis.addModelListener(GameEvent.VIEW_BROADCAST_PLAYER_ENTER, this.onPlayerInto);\n\t\tthis.addModelListener(GameEvent.ENTER_ROOM_UPDATE_PLAYER, this.enterRoomUpdatePlayer);\n\t\tthis.addModelListener(GameEvent.VIEW_UPDATE_FAN_GANG_PAI, this.updateFanGangPai);\n\t\tthis.addModelListener(GameEvent.VIEW_UPDATE_BU_GANG_PAI, this.updateBuGangPai);\n\t\tthis.addModelListener(GameEvent.UPDATE_REMAIN_CARDS_COUNT, this.updateRemainCardsCount);\n\t\tthis.addModelListener(GameEvent.VIEW_USER_OPERATION, this.viewUserOperation);\n\t\t\n\t\tthis.addModelListener(GameEvent.SHOW_HIDEN_MATCH_VIEW, this.showHidenMatchView);\n\t\t// 游戏结束\n        this.addModelListener(GameEvent.VIEW_BROADCAST_GAME_OVER, this.onGameOver);\n\t\tthis.addModelListener(GameEvent.VIEW_BROADCAST_GAME_START, this.onGameStart);\n\t\tthis.addModelListener(GameEvent.VIEW_PLAYER_AI_SHOW, this.modifyPlayerDeposit);\n\t\tthis.addModelListener(GameEvent.EXITS_SETTLE_VIEW, this.exitsSettleView);\n\t\t\n\t};\n\texitsSettleView(){\n\t\tthis.btnBack.node.active = true;\n\t}\n\tmodifyPlayerDeposit(event, respData){\n\t\tif (respData.mid != null) {\n\t\t\tif (respData.mid === PlayerMgr.getInstance().getMyPlayerInfo().userId) {\n\t\t\t\tthis.ai.showAiView(respData.ai);\n\t\t\t\t// this.ai.node.active = respData.ai;\n\t\t\t}\n\t\t}\n\t}\n\n\tonGameStart(){\n\t\tthis.btnBack.node.active = false;\n\t}\n\n\tonLoad() {\n\t\tLayerManager.updateConfig(FXJUIConfig);\n\t\tFXJController.getInstance().onViewLoad();\n\n\t\tthis.initView()\n\n        EventManager.dispatch(FXJEvent.SYS_PLAY_MUSIC, FXJSound.BgGame);\n\t};\n\n\tupdateRemainCardsCount(event = null){\n\t\tthis.remain.updateRemainCardsCount();\n\t}\n\t\n\tviewUserOperation(event = null,resp:Game.IOperation){\n\t\t//托管操作不弹操作框\n\t\t// if(PlayerMgr.getInstance().getMyPlayerInfo().isAi){\n\t\t// \treturn;\n\t\t// }\n\t\tthis.opInfo.updateOpration(resp);\n\t}\n\n\tgrabCardEvent(event = null,resp:Game.IGrabCard){\n\t\t// Logger.log(resp);\n\t\t// this.tingCard.setCardByte(resp.card)\n\t}\n\n\tupdateFanGangPai(event = null){\n\t\tthis.bugangTop.updateFanGangPai(RoomMgr.getInstance().fangangCards);\n\t\tthis.bugangTop.node.active = true;\n\t}\n\n\tupdateBuGangPai(event = null,resp:Game.IFanGangPai = null){\n\t\tthis.bugangBottom.updateBuGangPai(resp);\n\t\tthis.bugangBottom.node.active = true;\n\t}\n\n\tstart() {\n\t\t\n\t};\n\n\t/** 初始化界面 */\n\tinitView() {\n\t\tconsole.log(\"初始化界面\");\n\n\t\t//弹窗节点\n\t\tthis._nodePopUp = new LayerPopUp(inf_LayerType.PopUp);\n\t\tthis.nodePopup.addChild(this._nodePopUp);\n\n\t\tthis.getPreLoaderRes(FXJRes.Prefab_Menu.bundle, FXJRes.Prefab_Menu.path, Prefab, (res) => {\n\t\t\tthis.nodeMenu.removeAllChildren();\n\t\t\tthis.nodeMenu.addChild(res);\n\t\t})\n\n\t\tthis.getPreLoaderRes(FXJRes.Prefab_Opmgr.bundle, FXJRes.Prefab_Opmgr.path, Prefab, (res) => {\n\t\t\tthis.nodeMenu.addChild(res);\n\t\t})\n\n\t\t// this.opInfo.updateCodeMap();\n\t};\n\n\t/** 更新界面 */\n\tupdateView() {\n\n\t};\n\n    /** 自己登录 */\n\tplayerLoign() {\n        this.getPreLoaderRes(FXJRes.Prefab_Desk.bundle, FXJRes.Prefab_Desk.path, Prefab, (res) => {\n            EventManager.dispatch(FXJEvent.VIEW_UI_3D_ADD, res);\n        })\n\n        this.getPreLoaderRes(FXJRes.Prefab_HandCard.bundle, FXJRes.Prefab_HandCard.path, Prefab, (res) => {\n            this.nodeHandCard.removeAllChildren();\n            this.nodeHandCard.addChild(res);\n\t\t\tif(GCache.Desk.isReconnect){\n\t\t\t\tEventManager.dispatch(GameEvent.RECEIVE_DEAL_CARD);\n\t\t\t\tEventManager.dispatch(GameEvent.DRAW_MY_CARD);\n\t\t\t}\n        })\n\t};\n\n\tdingzhang() {\n\n\t}\n\t//进入房间更新用户信息\n\tenterRoomUpdatePlayer(){\n\t\tPlayerMgr.getInstance().playerList.forEach(player => {\n\t\t\tEventManager.dispatch(GameEvent.VIEW_BROADCAST_PLAYER_ENTER, player.userId);\n\t\t});\n\t\tthis.playerLoign();\n\t}\n\n\t//收到消息:用户进入房间\n\tonPlayerInto(event, uid) {\n\t\tlet palyer = PlayerMgr.getInstance().findPlayerWithUserId(uid);\n\t\tif (!palyer) {\n\t\t\treturn;\n\t\t}\n\t\tconsole.log(\"收到消息:玩家进入房间\", palyer);\n\t\tlet data = {\n\t\t\tuid: palyer.userId,\n\t\t\t// roleID: palyer.gameUserInfo.sex == 2 ? 1 : 0,\n\t\t\tposID: palyer.seatId,\n\t\t}\n\t\tthis.nodeUser.showUserView(data)\n\t}\n\n\tonClickTest(event: Event, customEventData: string) {\n\t\tconsole.log(\"onClickTest\", customEventData);\n\t\t// EventManager.dispatch(FXJEvent.GAME_OPEN_POPUP, FXJUIID.GameSettlePrefab);\n\t\t\n\t}\n\n\tshowHidenMatchView(event = null,isShow:boolean){\n\t\tthis.match.node.active = isShow;\n\t\tif(isShow){\n\t\t\tthis.match.getComponent(Match).onLoad();\n\t\t}\n\t}\n\n\n\t//打开二级弹窗\n\tonOpenPopUp(event, UIID, Data, callbacks = null) {\n\t\tif (UIID && (FXJUIConfig[UIID] || FXJUIConfig[UIID])) {\n\t\t\tif (!LayerManager.has(UIID, this._nodePopUp) && !LayerManager.isLoading(UIID, this._nodePopUp)) {\n\t\t\t\tLayerManager.open(UIID, Data, callbacks, this._nodePopUp);\n\t\t\t}\n\t\t}\n\t}\n\t//关闭二级弹窗\n\tonClosePopUp(event, UIID) {\n\t\tif (UIID && (FXJUIConfig[UIID] || FXJUIConfig[UIID])) {\n\t\t\t//聊天和菜单不需要遮罩\n\t\t\tif (UIID == FXJUIID.ToolBarPrefab || UIID == FXJUIID.GameChatPrefab) {\n\t\t\t\tlet node: Node = this._nodePopUp.getChildByName(UIID);\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.destroy();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet layerConf = FXJUIConfig[UIID] || FXJUIConfig[UIID];\n\t\t\t\tLayerManager.clear(layerConf?.layer, true, this._nodePopUp);\n\t\t\t}\n\t\t}\n\t}\n\t/** 销毁 */\n\tonDestroy() {\n\t\tEventManager.dispatch(FXJEvent.VIEW_UI_3D_REMOVE);\n\t\t\n\t\tFXJController.getInstance().onViewDestroy();\n\t\tFXJController.getInstance().clear();\n\t};\n\n\tonGameOver(){\n\t\tRoomMgr.getInstance().updateRemainCardsCount(0);\n\t\tthis.remain.updateRemainCardsCount();\n\t\tthis.opInfo.resetView();\n\t\tthis.bugangBottom.node.active = false;\n\t\tEventManager.dispatch(GameEvent.CLEAN_HAND_CARD);\n\t\tthis.ai.node.active = false;\n\t\tEventManager.dispatch(GameEvent.CLEAN_AI_SHOWING);\n\t}\n\n\tonCloseBack(){\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\t//如果房间状态处于结束状态，退出游戏\n\t\tif(GCache.Desk.getRoomStates() === GConstants.GameRoomState.STATUS_EXITSUCCESS){\n\t\t\tEventManager.dispatch(GameEvent.EXITS_GAME_ROOM_VIEW);\n\t\t}else{\n\t\t\tEventManager.dispatch(FXJEvent.NET_REQ_LOGOUT_IN_GAME);\n\t\t}\n\t\t\n\t\t\n\t}\n}\n\n"]}