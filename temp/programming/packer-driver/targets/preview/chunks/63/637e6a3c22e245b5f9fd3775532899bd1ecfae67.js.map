{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/module/match/src/Player.ts"],"names":["Label","Node","sp","Sprite","SpriteAtlas","_decorator","resLoader","BaseComponent","PlayerMgr","FXJRes","NodeHead","ccclass","property","Player","Skeleton","seatId","onInitModuleEvent","changeSkin","sex","spineConfig","Spine_XiaoYa","Spine_XiaoBo","load","bundle","path","SkeletonData","err","spineAsset","player","console","log","skeletonData","ani","setAnimation","changeHeadBg","userId","frameName","getInstance","getMyPlayerInfo","Prefab_Match_Image","atlas","spriteFrame","getSpriteFrame","y_head_bg","updatePlayerProperty","playerInfo","JSON","parse","strUserInfo","nick_name","string","nickName","headNode","getComponent","updateUserHead"],"mappings":"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","sourcesContent":["\nimport { Label, Node, sp, Sprite, SpriteAtlas, _decorator } from 'cc';\nimport { resLoader } from '../../../../../framework/loader/ResLoader';\nimport { BaseComponent } from '../../../../../framework/vc/BaseComponent';\nimport { PlayerMgr } from '../../../cache/PlayerMgr';\nimport { FXJRes } from '../../../common/FXJRes';\nimport { Common } from '../../../common/idl/Common';\nimport { NodeHead } from '../../settle/src/NodeHead';\nconst { ccclass, property } = _decorator;\n\n/**\n * Name = Player\n * URL = db://assets/package/game/module/match/src/Player.ts\n * Time = Fri Aug 04 2023 14:49:13 GMT+0800 (中国标准时间)\n * Author = qwe757964\n *\n * Life: onLoad-->onInitModuleEvent-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n * \n */\n \n@ccclass('Player')\nexport class Player extends BaseComponent {\n\t\n\t@property(Label)\n    public nick_name: Label | null = null;\n\n\t@property(Sprite)\n    public y_head_bg: Sprite | null = null;\n\n\t@property(Node)\n    public headNode: Node | null = null;\n\t\n\t@property(sp.Skeleton)\n    public player: sp.Skeleton = null;\n\t\n\tpublic seatId?: number = 0;\n\n\t\n\n\t/** override 初始化模块事件 */\n\tprotected onInitModuleEvent() {\n\n\t};\n\t\n\tchangeSkin(sex:number){\n\t\tlet spineConfig:any = sex ==2 ? FXJRes.Spine_XiaoYa : FXJRes.Spine_XiaoBo;\n\t\tresLoader.load(spineConfig.bundle, spineConfig.path, sp.SkeletonData, (err, spineAsset)=> {\n\t\t\tif(err || this.player === null) {\n\t\t\t\tconsole.log(\"Failed to load asset\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// let comp = this.getComponent('sp.Skeleton') as sp.Skeleton;\n\t\t\tthis.player.skeletonData = spineAsset!;\n\t\t\tlet ani = this.player.setAnimation(0, 'idle1', true);\n\t\t\tconsole.log(\"Load Success\");\n\t\t})\n\t}\n\tchangeHeadBg(userId:number){\n\t\t// let spriteLoad = this.y_head_bg.getComponent(SpriteLoad);\n\t\tlet frameName:string = \"\"\n\t\tif(PlayerMgr.getInstance().getMyPlayerInfo().userId === userId){\n\t\t\tframeName = \"r_head_bg\"; \n\t\t}else{\n\t\t\tframeName = \"y_head_bg\";\n\t\t}\n\t\t\n\t\tresLoader.load(FXJRes.Prefab_Match_Image.bundle, FXJRes.Prefab_Match_Image.path, SpriteAtlas, (err: Error | null, atlas) => {\n            if (err) {\n                return\n            }\n            let spriteFrame = atlas.getSpriteFrame(frameName)\n            if (spriteFrame && this.y_head_bg) {\n                this.y_head_bg.spriteFrame = spriteFrame;\n            }\n        })\n\t}\n\tpublic updatePlayerProperty(player:Common.IPlayerInfo){\n\t\tthis.seatId = player.seatId;\n\t\tlet playerInfo:Common.GameUserInfo = JSON.parse(player.strUserInfo)\n\t\tthis.nick_name.string = playerInfo.nickName;\n\t\tthis.headNode.getComponent(NodeHead).updateUserHead(playerInfo);\n\t\tthis.changeSkin(playerInfo.sex);\n\t\tthis.changeHeadBg(player.userId);\n\t}\n}\n\n"]}