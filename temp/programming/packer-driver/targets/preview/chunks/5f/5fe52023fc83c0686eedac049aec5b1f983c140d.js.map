{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/proj/servers/GoodsDataServers.ts"],"names":["GoodsDataServers","GCache","AppEvent","ClientInfo","GConstants","UIID","EventManager","Utils","BaseControll","GlobalCMD","PayAgent","getInstance","_instance","constructor","name","_lastUpdateTime","eventGoodlisteners","tempEventGoodlisteners","currowReqCreaterOrder","handlerShareExpTime","init","clear","onInitModuleEvent","addModelListener","NET_REQ_GOODS_INFO","reqGoodsInfo","NET_FORWARD_GOODS_INFO","resqGoodsInfo","NET_CMD_REQ_BUY_MALL_PROP","reqBuyMallProp","NET_CMD_RESP_BUY_MALL_PROP","respBuyMallProp","OTHER_PAY_WILL","reqWillPay","OTHER_PAY_RESULT","otherPayResult","OTHER_SHTRE_FRIEND_RESULT","otherShareFriend","event","param","table_isEmpty","table_verify","number_valueOf","GoodsListID","MarketGold","nullToDefault","User","getUserMoneyByID","PhoneCardType","BundleId","sendMsg","cmd","PHP_GOODS_INFO","body","dispatch","NET_SEND_MSG","isSuccess","respData","reqData","dump","ShopInfo","update","sceneData","GoodsData","updateGoods","ACTIVITY_GOODSLIST_UPDATE","itemData","console","log","gid","gnum","scene","ShopBigTabType","PROPS","PHP_BUY_MALL_PROP","print","SYS_CLOSE_NETLOADING","flag","_data","PropsConf","getPropsInfoById","updateUserMoneyByID","PropertyType","SILVER_COIN","GOLD_BAR","NOTIFY_EXCHANGE_RESULT","state","data","paramGX","icon","num","VIEW_UI_OPEN","GongXiHuoDePrefab","SYS_TOAST_TIP","content","respBody","AppPayResult","SUCCESS","goodID","callback","isNull","sceneType","CurrowPaySceneType","otherEx","Desk","gameID","getCurGameID","tableID","getCurTableID","levelID","getCurLevelID","payAgent","shareId","friendShareMsg","ShareInfo","getShareConfigByType","ShareSceneConf","friend","NET_REQ_SHARE_AWARD","ReqUrl","shareType","other"],"mappings":"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","sourcesContent":["/**\n * Name = GoodsDataServers\n * URL = db://assets/proj/servers/GoodsDataServers.ts\n * Time = Wed 2022 09.28 19:03:18 GMT+0800 (中国标准时间)\n * Author = xueya\n * {物品 道具 角色 建造 商城 付费礼包}服务\n */\nimport { GCache } from \"../../cache/GCache\";\nimport { AppEvent } from \"../../config/AppEvent\";\nimport { ClientInfo } from \"../../config/GameConfig\";\nimport { GConstants } from \"../../config/GameConstant\";\nimport { UIID } from \"../../config/UIConfig\";\nimport { EventManager } from \"../../framework/manager/EventManager\";\nimport { Utils } from \"../../framework/Utils\";\nimport { BaseControll } from \"../../framework/vc/BaseController\";\nimport { GlobalCMD } from \"../gnet/GlobalCMD\";\nimport { PayAgent } from \"../PayAgent\";\n\n\nexport class GoodsDataServers extends BaseControll {\n    private static _instance = null;\n    public static getInstance(): GoodsDataServers {\n        if (!this._instance || this._instance == null) {\n            this._instance = new GoodsDataServers(\"GoodsDataServers\");\n        }\n        return this._instance;\n    }\n\n    /** 上次请求更新的时间 */\n    private _lastUpdateTime = {\n        [\"GoodsData\"]: 0,\n        [\"Props\"]: 0,\n        [\"Roles\"]: 0,\n        [\"RoleSkill\"]: 0,\n        [\"BuildData\"]: 0,\n    };\n\n\n    /** 循环的队列 */\n    private eventGoodlisteners = {};\n    /** 暂存的缓存队列 */\n    private tempEventGoodlisteners = {};\n    /** 当前请求的创建订单数据 */\n    private currowReqCreaterOrder = null;\n    /** 分享过期时间判断 */\n    private handlerShareExpTime = null;\n    //实例化\n    constructor(name: string) {\n        super(name)\n    };\n    public static init(): GoodsDataServers {\n        if (this._instance) {\n            this._instance.clear()\n        }\n        this._instance = null\n        GoodsDataServers.getInstance();\n        return\n    }\n\n    /**初始化添加事件绑定 */\n    protected onInitModuleEvent(): void {\n        //请求拉取请求拉取商城列表/详情/数据\n        this.addModelListener(AppEvent.NET_REQ_GOODS_INFO, this.reqGoodsInfo)\n        //商城数据返回\n        this.addModelListener(AppEvent.NET_FORWARD_GOODS_INFO, this.resqGoodsInfo)\n        //商城请求购买道具\n        this.addModelListener(AppEvent.NET_CMD_REQ_BUY_MALL_PROP, this.reqBuyMallProp)\n        //商城请求购买道具返回\n        this.addModelListener(AppEvent.NET_CMD_RESP_BUY_MALL_PROP, this.respBuyMallProp)\n\n        /************************第三方相关************************/\n        //即将发起支付\n        this.addModelListener(AppEvent.OTHER_PAY_WILL, this.reqWillPay)\n        //支付的结果\n        this.addModelListener(AppEvent.OTHER_PAY_RESULT, this.otherPayResult)\n        //分享指定好友的结果\n        this.addModelListener(AppEvent.OTHER_SHTRE_FRIEND_RESULT, this.otherShareFriend)\n\n    }\n    // /** 请求拉取商城列表/详情 */\n    reqGoodsInfo(event, param) {\n        if (Utils.table_isEmpty(param)) {\n            return;\n        }\n        param = Utils.table_verify(param);\n        param[\"scene\"] = Utils.number_valueOf(param[\"scene\"], GConstants.GoodsListID.MarketGold); //默认获取银币 详见 GoodsListID配置\n        param[\"money\"] = Utils.nullToDefault(param[\"money\"], GCache.User.getUserMoneyByID());\n        param[\"operation\"] = ClientInfo.PhoneCardType;  //手机卡类型 1移动 2 联通 3 电信\n        param[\"bundleId\"] = ClientInfo.BundleId;        //包名\n\n        let sendMsg = {\n            cmd: GlobalCMD.PHP_GOODS_INFO,\n            body: param,\n        }\n        EventManager.dispatch(AppEvent.NET_SEND_MSG, sendMsg)\n    }\n    //返回商品数据\n    resqGoodsInfo(event, isSuccess, respData, reqData) {\n        this.dump(respData, \"商品商城数据返回---\" + isSuccess)\n        if (!isSuccess) {\n            return;\n        }\n        if (Utils.table_isEmpty(respData)) {\n            return;\n        }\n        GCache.ShopInfo.update(respData)\n        let sceneData = GCache.GoodsData.updateGoods(respData);\n        //通知商品列表有更新\n        if (sceneData) {\n            EventManager.dispatch(AppEvent.ACTIVITY_GOODSLIST_UPDATE, sceneData, reqData);\n            GCache.ShopInfo.update(sceneData)\n        }\n    }\n    /** 请求商城兑换 */\n    reqBuyMallProp(event = null, itemData) {\n        console.log('请求商城兑换', itemData)\n        let param = {\n            gid: itemData.gid, //兑换的商品\n            gnum: itemData.gnum, //数量\n            scene: GConstants.ShopBigTabType.PROPS\n        }\n        let sendMsg = {\n            cmd: GlobalCMD.PHP_BUY_MALL_PROP,\n            body: param,\n        }\n        EventManager.dispatch(AppEvent.NET_SEND_MSG, sendMsg);\n    }\n    /** 请求商城兑换返回 */\n    respBuyMallProp(event, isSuccess, respData, reqData) {\n        this.print(\"请求商城兑换(兑换道具)返回\", isSuccess, respData, reqData)\n        //关闭网络loading\n        EventManager.dispatch(AppEvent.SYS_CLOSE_NETLOADING);\n        if (isSuccess && respData['flag'] >= 0) {\n            let flag = Utils.number_valueOf(respData[\"flag\"]);\n            let _data = GCache.PropsConf.getPropsInfoById(respData['propsId'])\n            //购买成功 1：金条diamond 银币:money 2：兑换券\n            if (flag == 1) {\n                //更新资产数据 银币\n                if (respData[\"money\"] != null) {\n                    GCache.User.updateUserMoneyByID(GConstants.PropertyType.SILVER_COIN, respData[\"money\"])\n                }\n                //金条\n                if (respData[\"diamond\"] != null) {\n                    GCache.User.updateUserMoneyByID(GConstants.PropertyType.GOLD_BAR, respData[\"diamond\"])\n                }\n                //通知成功兑换结果\n                EventManager.dispatch(AppEvent.NOTIFY_EXCHANGE_RESULT, { state: isSuccess, data: respData })\n                //打开恭喜获得\n                let paramGX = {\n                    name: respData.name,\n                    icon: _data['url'],\n                    num: reqData['gnum'],\n                }\n                EventManager.dispatch(AppEvent.VIEW_UI_OPEN, UIID.GongXiHuoDePrefab, [paramGX])\n            } else if (flag == -2) {//道具已满，私信发放\n                //更新资产数据\n                if (respData[\"money\"] != null) {\n                    GCache.User.updateUserMoneyByID(GConstants.PropertyType.SILVER_COIN, respData[\"money\"])\n                }\n                if (respData[\"diamond\"] != null) {\n                    GCache.User.updateUserMoneyByID(GConstants.PropertyType.GOLD_BAR, respData[\"diamond\"])\n                }\n                //通知道具已满时候兑换结果\n                EventManager.dispatch(AppEvent.NOTIFY_EXCHANGE_RESULT, { state: false, data: respData })\n            }\n        } else {\n            EventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: respData['msg'] })\n            //通知失败的兑换结果\n            EventManager.dispatch(AppEvent.NOTIFY_EXCHANGE_RESULT, { state: false, data: respData })\n        }\n    }\n    /** 平台支付结果 */\n    otherPayResult(event, respBody) {\n        this.print(\"平台支付结果==>\", respBody);\n        if (respBody && respBody[\"respCode\"] == GConstants.AppPayResult.SUCCESS) {\n\n        }\n    }\n    public clear(): void {\n        super.clear();\n        this.tempEventGoodlisteners = {};\n        this.eventGoodlisteners = {};\n    }\n    /**\n     * 即将请求支付\n     * @param event \n     * @param goodID 商品分类ID 详见GoodsListID\n     * @param gid 具体商品ID\n     */\n    reqWillPay(event, goodID, gid, callback = null) {\n        if (Utils.isNull(goodID) || Utils.isNull(gid)) {\n            return;\n        }\n        let param = {\n            scene: goodID,\n            gid: gid,\n            callback: callback,\n            sceneType: GCache.CurrowPaySceneType,\n            otherEx: {}\n        }\n        if (GCache.Desk) {\n            param.otherEx = {\n                gameID: GCache.Desk.getCurGameID(),\n                tableID: GCache.Desk.getCurTableID(),\n                levelID: GCache.Desk.getCurLevelID(),\n            }\n        }\n\n        this.dump(param, \"即将请求支付\")\n        let payAgent = new PayAgent(param);\n    }\n    /**\n     * 邀请好友成功之后获取奖励\n     * @param  \n     * @param  商品分类ID 详见GoodsListID\n     * @param  具体商品ID\n     */\n    otherShareFriend() {\n        // 获取邀请好友奖励配置\n        let shareId = 0\n        let friendShareMsg = GCache.ShareInfo.getShareConfigByType(GConstants.ShareSceneConf.friend) || []\n        if (Utils.table_isEmpty(friendShareMsg)) {\n            shareId = 666//拉取不到配置时候默认给的奖励\n        } else {\n            shareId = friendShareMsg[0]['share_id']\n        }\n        EventManager.dispatch(AppEvent.NET_REQ_SHARE_AWARD, shareId, GConstants.ReqUrl.shareType.other, false)\n    }\n}\n\n"]}