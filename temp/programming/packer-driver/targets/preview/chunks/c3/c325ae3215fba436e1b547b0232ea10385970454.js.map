{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/module/opmgr/src/OprationItem.ts"],"names":["Sprite","SpriteAtlas","_decorator","resLoader","Utils","BaseComponent","PlayerMgr","OPCode","FXJRes","ccclass","property","OprationItem","atlasCodeMap","Map","onInitModuleEvent","onLoad","updateAtlasCodeMap","set","OPE_PENG","OPE_QIANG_PENG","OPE_HU","OPE_RIGHT_CHI","OPE_MIDDLE_CHI","OPE_LEFT_CHI","OPE_ZI_MO","OPE_AN_GANG","OPE_GANG","OPE_BU_GANG","getShowBtn","code","opCode","opstr","updateItemProps","userId","userInfo","getInstance","findPlayerWithUserId","gameUserInfo","sexStr","sex","opStr","node","active","opration","frameOp","string_format","Prefab_Match_Image","plistKey","frameSex","load","Prefab_Opmgr_Image","bundle","path","err","atlas","opFrame","getSpriteFrame","spriteFrame","sexFrame","player"],"mappings":"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","sourcesContent":["\nimport { Sprite, SpriteAtlas, _decorator } from 'cc';\nimport { resLoader } from '../../../../../framework/loader/ResLoader';\nimport { Utils } from '../../../../../framework/Utils';\nimport { BaseComponent } from '../../../../../framework/vc/BaseComponent';\nimport { PlayerMgr } from '../../../cache/PlayerMgr';\nimport { OPCode } from '../../../common/FXJConfig';\nimport { FXJRes } from '../../../common/FXJRes';\nimport { Common } from '../../../common/idl/Common';\nconst { ccclass, property } = _decorator;\n\n/**\n * Name = OprationItem\n * URL = db://assets/package/game/module/opmgr/src/OprationItem.ts\n * Time = Tue Aug 08 2023 10:37:09 GMT+0800 (中国标准时间)\n * Author = qwe757964\n *\n * Life: onLoad-->onInitModuleEvent-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n * \n */\n \n@ccclass('OprationItem')\nexport class OprationItem extends BaseComponent {\n\t@property(Sprite)\n    public opration: Sprite | null = null;\n\t@property(Sprite)\n    public player: Sprite | null = null;\n\t//code 对应的图集\n    atlasCodeMap = new Map<number, string>();\n\t/** override 初始化模块事件 */\n\tprotected onInitModuleEvent() {\n\n\t};\n\t\n\tonLoad () {\n\t\t// this.atlasCodeMap.set(OPCode.OPE_PASS, this.guoBtn);\n        \n\t};\n\n\tpublic updateAtlasCodeMap(){\n\t\tthis.atlasCodeMap.set(OPCode.OPE_PENG, \"peng\");\n        this.atlasCodeMap.set(OPCode.OPE_QIANG_PENG, \"peng\");\n        this.atlasCodeMap.set(OPCode.OPE_HU, \"hu\");\n\t\tthis.atlasCodeMap.set(OPCode.OPE_RIGHT_CHI, \"chi\");\n\t\tthis.atlasCodeMap.set(OPCode.OPE_MIDDLE_CHI, \"chi\");\n\t\tthis.atlasCodeMap.set(OPCode.OPE_LEFT_CHI, \"chi\");\n        this.atlasCodeMap.set(OPCode.OPE_ZI_MO, \"zimo\");\n        this.atlasCodeMap.set(OPCode.OPE_AN_GANG, \"gang\");\n        this.atlasCodeMap.set(OPCode.OPE_GANG, \"gang\");\n        this.atlasCodeMap.set(OPCode.OPE_BU_GANG, \"gang\");\n\t}\n\n\t getShowBtn (code: number): string | null {\n        for (let [opCode, opstr] of this.atlasCodeMap) {\n            if (code == opCode) {\n                return opstr;\n            }\n        }\n        return null;\n\n    }\n\n\tpublic updateItemProps(userId?: number,opCode?: number){\n\t\tlet userInfo :Common.GameUserInfo = PlayerMgr.getInstance().findPlayerWithUserId(userId).gameUserInfo;\n\t\tlet sexStr = \"\";\n\t\tif (userInfo.sex == 2) {\n\t\t\tsexStr = \"xiaoya\"\n\t\t} else {\n\t\t\tsexStr = \"xiaobo\"\n\t\t}\n\t\tlet opStr = this.getShowBtn(opCode);\n\t\tif(!opStr){\n\t\t\tthis.node.active = false;\n\t\t\treturn;\n\t\t}\n\t\tthis.node.active = true;\n\t\tthis.opration.node.active = false;\n\t\tlet frameOp = Utils.string_format(FXJRes.Prefab_Match_Image.plistKey, opStr)\n\t\tlet frameSex =   Utils.string_format(FXJRes.Prefab_Match_Image.plistKey, sexStr)\n        resLoader.load(FXJRes.Prefab_Opmgr_Image.bundle, FXJRes.Prefab_Opmgr_Image.path, SpriteAtlas, (err: Error | null, atlas) => {\n            if (err) {\n                return\n            }\n            let opFrame = atlas.getSpriteFrame(frameOp)\n            if (opFrame) {\n                this.opration.spriteFrame = opFrame;\n\t\t\t\tthis.opration.node.active = true;\n            }\n\t\t\tlet sexFrame = atlas.getSpriteFrame(frameSex)\n            if (sexFrame) {\n                this.player.spriteFrame = sexFrame;\n            }\n        })\n\t}\n\n}\n\n"]}