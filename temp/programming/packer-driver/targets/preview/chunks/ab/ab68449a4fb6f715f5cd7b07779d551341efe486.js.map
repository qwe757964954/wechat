{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/framework/gui/scrollview/SuperLayout.ts"],"names":["ccenum","Component","EventHandler","instantiate","Node","PageViewIndicator","Size","UITransform","Vec2","Vec3","_decorator","SuperScrollView","ccclass","property","menu","requireComponent","EPSILON","Type","VerticalAxisDirection","HorizontalAxisDirection","ScrollDirection","IndexVerticalAxisDirection","IndexHorizontalAxisDirection","SuperLayout","tooltip","type","visible","layoutType","VERTICAL","autoCenter","HORIZONTAL","isPageView","slide","range","stretchLock","_currPageIndex","_lastPageIndex","isRestart","scrollDirection","NONE","prevPos","_maxPrefabTotal","currentCreateItemTotal","_itemTotal","currPageIndex","lastPageIndex","vertical","horizontal","transform","node","_uiProps","uiTransformComp","accommodWidth","view","width","paddingLeft","paddingRight","accommodHeight","height","paddingTop","paddingBottom","header","children","length","footer","headerIndex","footerIndex","viewStartPoint","pos","horizontalAxisDirection","LEFT_TO_RIGHT","x","verticalAxisDirection","TOP_TO_BOTTOM","y","viewHeaderBoundary","viewFooterBoundary","headerBoundary","position","getItemYMax","getItemYMin","getItemXMin","getItemXMax","footerBoundary","centerHeaderBoundary","key","offset","centerNode","centerFooterBoundary","isOfLeftBoundary","HEADER","headerLoop","fixedItemWidth","itemTotal","isOfTopBoundary","fixedItemHeight","isOfRightBoundary","FOOTER","footerLoop","isOfButtomBoundary","Math","abs","contentSize","size","maxPrefabTotal","centerPosition","_centerPosition","worldPos","parent","convertToWorldSpaceAR","convertToNodeSpaceAR","indexVerticalAxisDirection","TOP","indexHorizontalAxisDirection","LEFT","onLoad","setAnchorPoint","setContentSize","setPosition","ZERO","scrollView","on","EventType","SIZE_CHANGED","onViewSizeChange","Object","defineProperty","get","onEnable","addEventListener","onDisable","removeEventListener","total","count","refreshLastItem","canTouchMove","createItems","refreshItems","updateItems","release","indicator","setPageView","scrollToCenter","resetIndexStartToEnd","updateItemSize","groupItemTotal","onChangeChildSize","soonFinish","scrollToHeader","timeInSecond","headerOrFooter","BOTTOM","RIGHT","scrollToIndex","scrollToFooter","isNearFooter","index","nearFooter","flag","result","getFooterOffset","footerOffset","indexOffset","getHeaderOffset","headerOffset","offsetToHeader","i","pushToHeader","offsetToFooter","pushToFooter","child","notifyRefreshItem","resetIndexEndToStart","boundary","reverse","isNaN","stopAutoScroll","savePageIndex","find","item","itemPos","getPosition","clone","getComponent","localPos","multiple","getCenterAnchor","multiply","add","scrollToAny","resetChilds","setAndSaveSizeAndScale","getItemSize","getScale","center","anchor","centerAnchor","origin","anchorY","anchorX","pullRefresh","findedPos","map","newLocalPos","subtract","centerTime","spacing","spacingX","spacingY","getScaleHeight","getScaleWidth","getStartX","getEndX","getStartY","getEndY","isAccommodateByTop","relative","max","isAccommodateByBottom","min","isAccommodateByLeft","isAccommodateByRight","getRelativeByLeft","getRelativeByRight","getRelativeByTop","getRelativeByBottom","setItemPosition","isHeader","getVerticalRelativePosition","getHorizontalRelativePosition","isAccommodate","startIndex","startAutoScroll","removeItems","needAddPrefab","cloneNode","addChild","TRANSFORM_CHANGED","onChangeChildScale","console","log","self","__size","warn","resetStrectchItems","TransformBit","SCALE","affectedByScale","__scale","setScale","findIndex","unschedule","stretchToFooter","scheduleOnce","stretchToHeader","off","removeChild","destroy","onPositionChanged","start","onTouchBegin","getUsedScaleValue","value","trans","scale","prevLocation","location","isOfBoundary","force","pushToFooterHandler","pushToHeaderHandler","loop","setSiblingIndex","accommodate","target","emitEvents","refreshItemEvents"],"mappings":"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","sourcesContent":["import { ccenum, Component, EventHandler, instantiate, Node, PageViewIndicator, Size, UITransform, Vec2, Vec3, _decorator } from 'cc';\nimport { SuperScrollView } from './SuperScrollView';\nconst { ccclass, property, menu, requireComponent } = _decorator;\n\nconst EPSILON = 1e-5\n\n/**\n * Name = SuperLayout\n * URL = db://assets/framework/gui/scrollview/SuperLayout.ts\n * Time = Mon Feb 27 2023 09:54:35 GMT+0800 (中国标准时间)\n * Author = xueya\n *\n * Life: onLoad-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n */\n\nenum Type {\n    HORIZONTAL = 0,\n    VERTICAL = 1,\n}\nccenum(Type)\nenum VerticalAxisDirection {\n    TOP_TO_BOTTOM = 0,\n    BOTTOM_TO_TOP = 1\n}\nccenum(VerticalAxisDirection)\nenum HorizontalAxisDirection {\n    LEFT_TO_RIGHT = 0,\n    RIGHT_TO_LEFT = 1\n}\nccenum(HorizontalAxisDirection)\nenum ScrollDirection {\n    NONE = 0,\n    HEADER = 1,\n    FOOTER = 2,\n}\n\nenum IndexVerticalAxisDirection {\n    TOP = 0,\n    BOTTOM = 1,\n}\nccenum(IndexVerticalAxisDirection)\nenum IndexHorizontalAxisDirection {\n    LEFT = 0,\n    RIGHT = 1\n}\nccenum(IndexHorizontalAxisDirection)\n\n@ccclass('SuperLayout')\n@requireComponent(UITransform)\n//方便编辑器识别的菜单项目\n@menu('gui/scrollview/SuperLayout')\nexport class SuperLayout extends Component {\n    static VerticalAxisDirection = VerticalAxisDirection\n    static HorizontalAxisDirection = HorizontalAxisDirection\n\n    @property({ tooltip: \"绑定了SuperScrollView的ScrollowView\", type: SuperScrollView })\n    scrollView!: SuperScrollView;\n\n    @property({ tooltip: \"view的UITransform组件\", type: UITransform })\n    view!: UITransform\n    //用于克隆的节点\n    @property({ tooltip: \"用于克隆的节点\", type: Node })\n    cloneNode: Node | null = null;\n\n    @property({ tooltip: \"layout类型\", type: Type })\n    layoutType: Type = Type.VERTICAL;\n\n    @property({\n        type: IndexVerticalAxisDirection,\n        visible: function () { return (this as any).layoutType == Type.VERTICAL && !(this as any).autoCenter }\n    }) indexVerticalAxisDirection = IndexVerticalAxisDirection.TOP;\n\n    @property({\n        type: IndexHorizontalAxisDirection,\n        visible: function () { return (this as any).layoutType == Type.HORIZONTAL && !(this as any).autoCenter }\n    }) indexHorizontalAxisDirection = IndexHorizontalAxisDirection.LEFT;\n\n    @property({ type: VerticalAxisDirection }) verticalAxisDirection = VerticalAxisDirection.TOP_TO_BOTTOM\n\n    @property({ type: HorizontalAxisDirection }) horizontalAxisDirection = HorizontalAxisDirection.LEFT_TO_RIGHT\n\n    @property({ tooltip: \"最小值=1，大于1就是Grid模式\" }) groupItemTotal: number = 1;\n    @property({ tooltip: \"决定最多创建Prefab的数量\" }) multiple: number = 2;\n    @property({ tooltip: \"顶部填充\" }) paddingTop: number = 0;\n    @property({ tooltip: \"底部填充\" }) paddingBottom: number = 0;\n    @property({ tooltip: \"左侧填充\" }) paddingLeft: number = 0;\n    @property({ tooltip: \"右侧填充\" }) paddingRight: number = 0;\n    @property({ tooltip: \"横轴间距\" }) spacingX: number = 0;\n    @property({ tooltip: \"纵轴间距\" }) spacingY: number = 0;\n    @property({ tooltip: \"计算缩放后的尺寸\" }) affectedByScale: boolean = false;\n\n    @property({ tooltip: \"开启翻页模式\" }) isPageView: boolean = false;\n\n    @property({\n        tooltip: \"每个页面翻页时所需时间。单位：秒\",\n        visible: function () { return (this as any).isPageView }\n    }) pageTurningSpeed = 0.3;\n\n    @property({\n        type: PageViewIndicator,\n        visible: function () { return (this as any).isPageView }\n    }) indicator!: PageViewIndicator;\n\n    @property({\n        slide: true,\n        range: [0, 1, 0.01],\n        tooltip: \"滚动临界值，默认单位百分比，当拖拽超出该数值时，松开会自动滚动下一页，小于时则还原\",\n        visible: function () { return (this as any).isPageView }\n    }) scrollThreshold = 0.5;\n\n    @property({\n        tooltip: \"快速滑动翻页临界值。当用户快速滑动时，会根据滑动开始和结束的距离与时间计算出一个速度值,该值与此临界值相比较，如果大于临界值，则进行自动翻页\",\n        visible: function () { return (this as any).isPageView }\n    }) autoPageTurningThreshold = 100;\n\n    @property({\n        type: EventHandler,\n        visible: function () { return (this as any).isPageView }\n    }) pageEvents: EventHandler[] = [];\n\n    @property({\n        tooltip: \"开启自动居中\",\n        visible: function () { return !(this as any).isPageView }\n    }) autoCenter: boolean = false\n    @property({\n        tooltip: \"自动居中的滚动时间\",\n        visible: function () { return (this as any).autoCenter }\n    }) centerTime: number = 1;\n    @property({\n        type: Node,\n        tooltip: \"自动居中的参考节点，如果为空、则默认选择View中心\",\n        visible: function () { return (this as any).autoCenter }\n    }) centerNode!: Node;\n    @property({\n        // type: Vec2,\n        tooltip: \"自动居中时、Item的居中锚点\",\n        visible: function () { return (this as any).autoCenter }\n    }) centerAnchor: Vec2 = new Vec2(.5, .5);\n\n    @property({ tooltip: \"上/左 无限循环\" }) headerLoop: boolean = false;\n    @property({ tooltip: \"下/右 无限循环\" }) footerLoop: boolean = false;\n    @property(EventHandler) refreshItemEvents: EventHandler[] = [];\n\n\n    private stretchLock: {\n        index?: number,\n        timeInSecond?: number,\n        boundary?: Vec3,\n        reverse?: boolean,\n    } = {}\n    private _currPageIndex: number = 0\n    get currPageIndex() {\n        return this._currPageIndex\n    }\n    private _lastPageIndex: number = 0\n    get lastPageIndex() {\n        return this._lastPageIndex\n    }\n    private isRestart: boolean = false\n    /** 当前滚动方向 */\n    private scrollDirection: ScrollDirection = ScrollDirection.NONE\n    /** 是否垂直滚动 */\n    get vertical(): boolean { return this.layoutType == Type.VERTICAL }\n    /** 是否水平滚动 */\n    get horizontal(): boolean { return this.layoutType == Type.HORIZONTAL }\n    get transform(): UITransform | null { return this.node._uiProps.uiTransformComp }\n    /** View 可容纳的宽度 */\n    get accommodWidth() {\n        return this.view.width - this.paddingLeft - this.paddingRight\n    }\n    /** View 可容纳的高度 */\n    get accommodHeight() {\n        return this.view.height - this.paddingTop - this.paddingBottom\n    }\n    /** 头部的节点 */\n    get header(): UITransform | null {\n        if (this.node.children.length == 0) return null\n        return this.node.children[0]._uiProps.uiTransformComp\n    }\n    /** 底部的节点 */\n    get footer(): UITransform | null {\n        if (this.node.children.length == 0) return null\n        return this.node.children[this.node.children.length - 1]._uiProps.uiTransformComp\n    }\n    /** 头部索引 */\n    get headerIndex(): number {\n        if (!this.header) return -1\n        let node: any = this.header.node\n        return node[\"__index\"]\n    }\n    /** 底部索引 */\n    get footerIndex(): number {\n        if (!this.footer) return -1\n        let node: any = this.footer.node\n        return node[\"__index\"]\n    }\n    /** Item起始位置 */\n    get viewStartPoint(): Vec3 {\n        let pos = new Vec3()\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            pos.x = this.view.width * -0.5 + this.paddingLeft\n        } else {\n            pos.x = this.view.width * 0.5 - this.paddingRight\n        }\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            pos.y = this.view.height * 0.5 - this.paddingTop\n        } else {\n            pos.y = this.view.height * -0.5 + this.paddingBottom\n        }\n        return pos\n    }\n    /** View 头部边界 */\n    get viewHeaderBoundary(): number {\n        return this.vertical ? this.view.height * 0.5 : this.view.width * -0.5\n    }\n    /** View 底部边界 */\n    get viewFooterBoundary(): number {\n        return this.vertical ? this.view.height * -0.5 : this.view.width * 0.5\n    }\n    /** 头部节点边界 */\n    get headerBoundary(): number {\n        if (!this.header) return 0\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                return this.node.position.y + this.getItemYMax(this.header) + this.paddingTop\n            } else {\n                return this.node.position.y + this.getItemYMin(this.header) - this.paddingBottom\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                return this.node.position.x + this.getItemXMin(this.header) - this.paddingLeft\n            } else {\n                return this.node.position.x + this.getItemXMax(this.header) + this.paddingRight\n            }\n        }\n    }\n    /** 底部节点边界 */\n    get footerBoundary(): number {\n        if (!this.footer) return 0\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                return this.node.position.y + this.getItemYMin(this.footer) - this.paddingBottom\n            } else {\n                return this.node.position.y + this.getItemYMax(this.footer) + this.paddingTop\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                return this.node.position.x + this.getItemXMax(this.footer) + this.paddingRight\n            } else {\n                return this.node.position.x + this.getItemXMin(this.footer) - this.paddingLeft\n            }\n        }\n    }\n    /** 自动居中节点头部边界 */\n    get centerHeaderBoundary() {\n        let key = this.vertical ? \"y\" : \"x\"\n        var offset\n        if (this.centerNode) {\n            offset = this.viewHeaderBoundary - (this.centerNode.position as any)[key]\n        } else {\n            offset = this.viewHeaderBoundary - (this.view.node.position as any)[key]\n        }\n        if (this.vertical && this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM || this.horizontal && this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            return this.headerBoundary + offset\n        } else {\n            return this.footerBoundary + offset\n        }\n    }\n    /** 自动居中节点底部边界 */\n    get centerFooterBoundary() {\n        let key = this.vertical ? \"y\" : \"x\"\n        var offset\n        if (this.centerNode) {\n            offset = this.viewFooterBoundary - (this.centerNode.position as any)[key]\n        } else {\n            offset = this.viewFooterBoundary - (this.view.node.position as any)[key]\n        }\n        if (this.vertical && this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM || this.horizontal && this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            return this.footerBoundary + offset\n        } else {\n            return this.headerBoundary + offset\n        }\n    }\n    /** 是否超出左侧边界 */\n    get isOfLeftBoundary(): number {\n        if (this.vertical) return 0\n        if (this.autoCenter) {\n            if (this.scrollDirection == ScrollDirection.HEADER) {\n                return this.centerHeaderBoundary\n            }\n            return 0\n        }\n        if (this.headerLoop) {\n            if (this.header) return 0\n            return this.viewHeaderBoundary + this.node.position.x\n        }\n\n        if (!this.header || this.fixedItemWidth <= this.view.width) {\n            return this.viewHeaderBoundary + this.node.position.x\n        }\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            if (this.headerIndex == 0) {\n                return this.headerBoundary\n            }\n        } else {\n            if (this.footerIndex == this.itemTotal - 1) {\n                return this.footerBoundary\n            }\n        }\n        return 0\n    }\n    /** 是否超出顶部边界 */\n    get isOfTopBoundary(): number {\n        if (!this.vertical) return 0\n        if (this.autoCenter) {\n            if (this.scrollDirection == ScrollDirection.HEADER) {\n                return this.centerHeaderBoundary\n            }\n            return 0\n        }\n        if (this.headerLoop) {\n            if (this.header) return 0\n            return this.viewHeaderBoundary + this.node.position.y\n        }\n        if (!this.header || this.fixedItemHeight <= this.view.height) {\n            return this.viewHeaderBoundary + this.node.position.y\n        }\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            if (this.headerIndex == 0) {\n                return this.headerBoundary\n            }\n        } else {\n            if (this.footerIndex == this.itemTotal - 1) {\n                return this.footerBoundary\n            }\n        }\n        return 0\n    }\n    /** 是否超出右侧边界 */\n    get isOfRightBoundary(): number {\n        if (this.vertical) return 0\n        if (this.autoCenter) {\n            if (this.scrollDirection == ScrollDirection.FOOTER) {\n                return this.centerFooterBoundary\n            }\n            return 0\n        }\n        if (this.footerLoop) {\n            if (this.footer) return 0\n            return this.viewFooterBoundary + this.node.position.x\n        }\n        if (!this.footer || this.fixedItemWidth <= this.view.width) {\n            return this.viewFooterBoundary + this.node.position.x\n        }\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            if (this.footerIndex == this.itemTotal - 1) {\n                return this.footerBoundary\n            }\n        } else {\n            if (this.headerIndex == 0) {\n                return this.headerBoundary\n            }\n        }\n        return 0\n    }\n    /** 是否超出底部边界 */\n    get isOfButtomBoundary(): number {\n        if (!this.vertical) return 0\n        if (this.autoCenter) {\n            if (this.scrollDirection == ScrollDirection.FOOTER) {\n                return this.centerFooterBoundary\n            }\n            return 0\n        }\n        if (this.footerLoop) {\n            if (this.footer) return 0\n            return this.viewFooterBoundary + this.node.position.y\n        }\n        if (!this.footer || this.fixedItemHeight <= this.view.height) {\n            return this.viewFooterBoundary + this.node.position.y\n        }\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            if (this.footerIndex == this.itemTotal - 1) {\n                return this.footerBoundary\n            }\n        } else {\n            if (this.headerIndex == 0) {\n                return this.headerBoundary\n            }\n        }\n        return 0\n    }\n    /** 从头部到底部的所有Item高度总和 */\n    get fixedItemHeight(): number {\n        if (!this.header) return 0\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            return Math.abs(this.getItemYMax(this.header)) + Math.abs(this.getItemYMin(this.footer))\n        } else {\n            return Math.abs(this.getItemYMin(this.header)) + Math.abs(this.getItemYMax(this.footer))\n        }\n    }\n    /** 从头部到底部的所有Item宽度总和 */\n    get fixedItemWidth(): number {\n        if (!this.header) return 0\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            return Math.abs(this.getItemXMin(this.header)) + Math.abs(this.getItemXMax(this.footer))\n        } else {\n            return Math.abs(this.getItemXMax(this.header)) + Math.abs(this.getItemXMin(this.footer))\n        }\n    }\n    /** 返回 header到 footer 之间的整体尺寸 如果Item数量不足以撑开View 则返回View尺寸 最小值是View尺寸 */\n    get contentSize(): Size {\n        if (this.node.children.length == 0) return this.view.contentSize\n        let size = new Size(this.view.contentSize.width, this.view.contentSize.height)\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                size.height = this.headerBoundary + -this.footerBoundary\n            } else {\n                size.height = this.footerBoundary + -this.headerBoundary\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                size.width = this.footerBoundary + -this.headerBoundary\n            } else {\n                size.width = this.headerBoundary + -this.footerBoundary\n            }\n        }\n        if (size.width < this.view.contentSize.width) {\n            size.width = this.view.contentSize.width\n        }\n        if (size.height < this.view.contentSize.height) {\n            size.height = this.view.contentSize.height\n        }\n        return size\n    }\n    private prevPos: Vec3 = new Vec3(0, 0, 0)\n    private _maxPrefabTotal: number = 0\n    /** 已被创建的Item数量 */\n    get maxPrefabTotal(): number { return this._maxPrefabTotal }\n    private currentCreateItemTotal: number = 0\n    private _itemTotal: number = 0\n    /** 数据长度 */\n    get itemTotal(): number { return this._itemTotal }\n    private _centerPosition!: Vec3\n    /** 自动居中的参考位置 */\n    get centerPosition(): Vec3 {\n        if (!this._centerPosition) {\n            this._centerPosition = new Vec3()\n            if (this.autoCenter) {\n                if (this.centerNode) {\n                    let worldPos = this.centerNode.parent?._uiProps.uiTransformComp?.convertToWorldSpaceAR(this.centerNode.position)!\n                    this._centerPosition = this.view.convertToNodeSpaceAR(worldPos)\n                }\n            } else {\n                if (this.vertical) {\n                    if (this.indexVerticalAxisDirection == IndexVerticalAxisDirection.TOP) {\n                        this._centerPosition.y = this.viewHeaderBoundary\n                    } else {\n                        this._centerPosition.y = this.viewFooterBoundary\n                    }\n                } else {\n                    if (this.indexHorizontalAxisDirection == IndexHorizontalAxisDirection.LEFT) {\n                        this._centerPosition.x = this.viewHeaderBoundary\n                    } else {\n                        this._centerPosition.x = this.viewFooterBoundary\n                    }\n                }\n            }\n        }\n        return this._centerPosition\n    }\n    onLoad() {\n        this.transform?.setAnchorPoint(new Vec2(.5, .5))\n        this.transform?.setContentSize(this.view.contentSize)\n        this.node.setPosition(Vec3.ZERO)\n        if (this.isPageView) this.autoCenter = false\n        this.scrollView.view?.node.on(Node.EventType.SIZE_CHANGED, this.onViewSizeChange, this)\n        Object.defineProperty(this.transform, \"contentSize\", { get: () => this.contentSize })\n        Object.defineProperty(this.transform, \"width\", { get: () => this.contentSize.width })\n        Object.defineProperty(this.transform, \"height\", { get: () => this.contentSize.height })\n    }\n    onEnable() {\n        this.addEventListener()\n    }\n    onDisable() {\n        this.removeEventListener()\n    }\n    /**\n     * 更新item数量\n     * @param count \n     * @param onRefreshLastItem 如果你确定只需要刷新最后一个item 那么这个设置成true 就不会刷新所有数据\n     */\n    total(count: number, refreshLastItem: boolean = false): this {\n        this.scrollView.canTouchMove = false\n        this.currentCreateItemTotal = count\n        this.createItems(count, refreshLastItem)\n        let offset = count - this.itemTotal\n        this._itemTotal = count\n        this.refreshItems(offset, refreshLastItem)\n        if (!refreshLastItem) this.updateItems()\n        this.scrollView.release()\n        if (this.indicator) {\n            this.indicator.setPageView((this.scrollView as any));\n        }\n        if (this.autoCenter) {\n            this.scrollToCenter()\n        }\n        this.scrollView.canTouchMove = true\n        return this\n    }\n    /**\n     * 刷新所有item\n     */\n    updateItems(): this {\n        this.resetIndexStartToEnd(this.headerIndex)\n        return this\n    }\n    /** 告知组件你的节点尺寸 */\n    updateItemSize(node: Node, size: Size) {\n        if (this.groupItemTotal > 1) return\n        if (!node || !size) return\n        (node as any)[\"__runtime_size\"] = size\n        this.onChangeChildSize(node._uiProps.uiTransformComp!)\n    }\n    /** 自动居中到最近Item */\n    scrollToCenter() {\n        this.soonFinish()\n    }\n    /** 滚动到头部 */\n    scrollToHeader(timeInSecond?: number) {\n        var headerOrFooter = 0\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                headerOrFooter = this.viewHeaderBoundary\n                if (this.indexVerticalAxisDirection == IndexVerticalAxisDirection.BOTTOM) {\n                    headerOrFooter -= this.header?.height! + this.paddingTop + this.paddingBottom\n                }\n            } else {\n                headerOrFooter = this.viewFooterBoundary\n                if (this.indexVerticalAxisDirection == IndexVerticalAxisDirection.TOP) {\n                    headerOrFooter += this.header?.height! + this.paddingTop + this.paddingBottom\n                }\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                headerOrFooter = this.viewHeaderBoundary\n                if (this.indexHorizontalAxisDirection == IndexHorizontalAxisDirection.RIGHT) {\n                    headerOrFooter += this.header?.width! + this.paddingLeft + this.paddingRight\n                }\n            } else {\n                headerOrFooter = this.viewFooterBoundary\n                if (this.indexHorizontalAxisDirection == IndexHorizontalAxisDirection.LEFT) {\n                    headerOrFooter -= this.header?.width! + this.paddingLeft + this.paddingRight\n                }\n            }\n        }\n        this.scrollToIndex(0, timeInSecond, new Vec3(headerOrFooter, headerOrFooter))\n\n    }\n    /** 滚动到尾部 */\n    scrollToFooter(timeInSecond?: number) {\n        var headerOrFooter = 0\n        if (this.vertical) {\n            if (this.fixedItemHeight < this.view.height) return\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                headerOrFooter = this.viewFooterBoundary\n                if (this.indexVerticalAxisDirection == IndexVerticalAxisDirection.BOTTOM) {\n                    headerOrFooter += this.footer?.height! + this.paddingTop + this.paddingBottom\n                }\n            } else {\n                headerOrFooter = this.viewHeaderBoundary\n                if (this.indexVerticalAxisDirection == IndexVerticalAxisDirection.TOP) {\n                    headerOrFooter -= this.footer?.height! + this.paddingTop + this.paddingBottom\n                }\n            }\n        } else {\n            if (this.fixedItemWidth < this.view.width) return\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                headerOrFooter = this.viewFooterBoundary\n                if (this.indexHorizontalAxisDirection == IndexHorizontalAxisDirection.RIGHT) {\n                    headerOrFooter -= this.footer?.width! + this.paddingLeft + this.paddingRight\n                }\n            } else {\n                headerOrFooter = this.viewHeaderBoundary\n                if (this.indexHorizontalAxisDirection == IndexHorizontalAxisDirection.LEFT) {\n                    headerOrFooter += this.footer?.width! + this.paddingLeft + this.paddingRight\n                }\n            }\n        }\n        this.scrollToIndex(this.itemTotal - 1, timeInSecond, new Vec3(headerOrFooter, headerOrFooter), true)\n    }\n    private isNearFooter(index: number) {\n        let nearFooter = false\n        let flag = index > this.footerIndex && index < this.headerIndex\n        if (flag) {\n            let result = Math.abs(index - this.headerIndex) < Math.abs(index - this.footerIndex)\n            if (this.vertical) {\n                if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                    nearFooter = !result\n                } else {\n                    nearFooter = result\n                }\n            } else {\n                if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                    nearFooter = !result\n                } else {\n                    nearFooter = result\n                }\n            }\n        } else if (index > this.footerIndex) {\n            if (this.vertical) {\n                nearFooter = this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM ? true : false\n            } else {\n                nearFooter = this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT ? true : false\n            }\n        } else if (index < this.headerIndex) {\n            if (this.vertical) {\n                nearFooter = this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM ? false : true\n            } else {\n                nearFooter = this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT ? false : true\n            }\n        }\n        return nearFooter\n    }\n    private getFooterOffset(index: number) {\n        let footerOffset = this.footerIndex % this.groupItemTotal\n        let indexOffset = index % this.groupItemTotal\n        return indexOffset - footerOffset + this.groupItemTotal\n    }\n    private getHeaderOffset(index: number) {\n        let headerOffset = this.headerIndex % this.groupItemTotal\n        let indexOffset = index % this.groupItemTotal\n        return headerOffset - indexOffset + this.groupItemTotal\n    }\n    private offsetToHeader(index: number) {\n        var offset = 0\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                offset = this.getHeaderOffset(index)\n            } else {\n                offset = this.getFooterOffset(index)\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                offset = this.getHeaderOffset(index)\n            } else {\n                offset = this.getFooterOffset(index)\n            }\n        }\n        offset -= this.groupItemTotal\n        for (let i = 0; i < offset; i++) {\n            this.pushToHeader(true)\n        }\n    }\n    private offsetToFooter(index: number) {\n        var offset = 0\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                offset = this.getFooterOffset(index)\n            } else {\n                offset = this.getHeaderOffset(index)\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                offset = this.getFooterOffset(index)\n            } else {\n                offset = this.getHeaderOffset(index)\n            }\n        }\n        offset -= this.groupItemTotal\n        for (let i = 0; i < offset; i++) {\n            this.pushToFooter(true)\n        }\n    }\n    private resetIndexStartToEnd(index: number) {\n        for (let i = 0; i < this.node.children.length; i++) {\n            const child: any = this.node.children[i];\n            child[\"__index\"] = index\n            index++\n            if (this.headerLoop || this.footerLoop) {\n                if (index < 0 || index >= this.itemTotal) {\n                    index = 0\n                }\n            }\n            this.notifyRefreshItem(child)\n        }\n    }\n    private resetIndexEndToStart(index: number) {\n        for (let i = this.node.children.length - 1; i >= 0; i--) {\n            const child: any = this.node.children[i];\n            child[\"__index\"] = index\n            index--\n            if (this.headerLoop || this.footerLoop) {\n                if (index < 0) {\n                    index = this.itemTotal - 1\n                }\n            }\n            this.notifyRefreshItem(child)\n        }\n    }\n    /**\n     * 跳转到指定索引位置\n     * @param index 索引\n     * @param timeInSecond 时间\n     * @param boundary \n     * @param reverse \n     * @returns \n     */\n    scrollToIndex(index: number, timeInSecond?: number, boundary?: Vec3, reverse: boolean = false) {\n        if (isNaN(index) || index < 0 || index > this.itemTotal - 1) return\n        this.scrollView.stopAutoScroll()\n        if (this.isPageView) {\n            this.scrollView.savePageIndex(index)\n        }\n        var child = this.node.children.find((item: any) => item[\"__index\"] == index)\n        var nearFooter = this.isNearFooter(index)\n        this.stretchLock.index = index\n        this.stretchLock.timeInSecond = timeInSecond\n        this.stretchLock.boundary = boundary\n        this.stretchLock.reverse = reverse\n\n        if (!child) {\n            if (index == 0) {\n                this.pushToHeader()\n            }\n            if (index == this.itemTotal - 1) {\n                this.pushToFooter()\n            }\n            var flag = this.vertical && this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM || !this.vertical && this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT\n            if (nearFooter) {\n                this.offsetToFooter(index)\n                flag ? this.resetIndexEndToStart(index) : this.resetIndexStartToEnd(index)\n            } else {\n                this.offsetToHeader(index)\n                flag ? this.resetIndexStartToEnd(index) : this.resetIndexEndToStart(index)\n            }\n            child = this.node.children.find((item: any) => item[\"__index\"] == index)\n        }\n        if (!child) return\n        let itemPos = child.getPosition().clone()\n        if (!this.autoCenter) {\n            if (this.vertical) {\n                if (this.indexVerticalAxisDirection == IndexVerticalAxisDirection.TOP) {\n                    if (!reverse) {\n                        itemPos.y = this.getItemYMax(child.getComponent(UITransform)!) + this.paddingTop\n                    } else {\n                        itemPos.y = this.getItemYMin(child.getComponent(UITransform)!) - this.paddingBottom\n                    }\n                } else {\n                    if (!reverse) {\n                        itemPos.y = this.getItemYMin(child.getComponent(UITransform)!) - this.paddingBottom\n                    } else {\n                        itemPos.y = this.getItemYMax(child.getComponent(UITransform)!) + this.paddingTop\n                    }\n                }\n            } else {\n                if (this.indexHorizontalAxisDirection == IndexHorizontalAxisDirection.LEFT) {\n                    if (!reverse) {\n                        itemPos.x = this.getItemXMin(child.getComponent(UITransform)!) - this.paddingLeft\n                    } else {\n                        itemPos.x = this.getItemXMax(child.getComponent(UITransform)!) + this.paddingRight\n                    }\n                } else {\n                    if (!reverse) {\n                        itemPos.x = this.getItemXMax(child.getComponent(UITransform)!) + this.paddingRight\n                    } else {\n                        itemPos.x = this.getItemXMin(child.getComponent(UITransform)!) - this.paddingLeft\n                    }\n                }\n            }\n        }\n        let worldPos = this.transform?.convertToWorldSpaceAR(itemPos)!\n        let localPos = this.view.convertToNodeSpaceAR(worldPos)\n        var multiple\n        if (!this.autoCenter && boundary) {\n            multiple = boundary\n        } else {\n            multiple = this.getCenterAnchor(child.getComponent(UITransform)!, this.centerPosition)\n        }\n        localPos.multiply(new Vec3(-1, -1, 1)).add(multiple)\n        this.scrollView.scrollToAny(localPos, timeInSecond, true)\n    }\n    protected async onViewSizeChange() {\n        this.isRestart = true\n        this.createItems(this.currentCreateItemTotal)\n        this.resetChilds(true)\n        this.scrollToHeader()\n        for (let i = 0; i < this.node.children.length; i++) {\n            const child: any = this.node.children[i];\n            const transform = child.getComponent(UITransform)!\n            this.setAndSaveSizeAndScale(transform)\n        }\n        this.isRestart = false\n    }\n    protected setAndSaveSizeAndScale(item: UITransform) {\n        item.setContentSize(this.getItemSize(item));\n        (item.node as any)[\"__size\"] = item.contentSize.clone();\n        (item.node as any)[\"__scale\"] = item.node.getScale().clone();\n    }\n    /** 根据centerAnchor计算自动居中的真实位置 */\n    protected getCenterAnchor(item: UITransform, center: Vec3) {\n        var pos = center.clone()\n        if (this.vertical) {\n            let anchor = item.height! * this.centerAnchor.y\n            let origin = item.height! * item.anchorY!\n            pos.y -= anchor - origin\n        } else {\n            let anchor = item.width! * this.centerAnchor.x\n            let origin = item.width! * item.anchorX!\n            pos.x += anchor - origin\n        }\n        return pos\n    }\n    /** 滚动即将结束时 跑自动居中的逻辑 */\n    protected soonFinish() {\n        if (!this.autoCenter) return\n        if (this.scrollView.pullRefresh) return\n        this.scrollView.stopAutoScroll()\n        var findedPos = new Vec3(999999, 999999)\n        for (let i = 0; i < this.node.children.length; i++) {\n            const child = this.node.children[i];\n            let worldPos = this.transform?.convertToWorldSpaceAR(child.position)!\n            let localPos = this.view.convertToNodeSpaceAR(worldPos)\n            let map = { width: false, height: false }\n            var multiple = this.getCenterAnchor(child.getComponent(UITransform)!, this.centerPosition)\n            let newLocalPos = localPos.subtract(multiple)\n            map.width = Math.abs(newLocalPos.x) < Math.abs(findedPos.x)\n            map.height = Math.abs(newLocalPos.y) < Math.abs(findedPos.y)\n            if (this.vertical && map.height) {\n                findedPos = newLocalPos\n            } else if (!this.vertical && map.width) {\n                findedPos = newLocalPos\n            }\n        }\n        findedPos.multiply(new Vec3(-1, -1, 1))\n        this.scrollView.scrollToAny(findedPos, this.centerTime)\n    }\n    /** 根据groupItemTotal和View可容纳的尺寸 来平均分配Item该有的尺寸 */\n    protected getItemSize(item: UITransform): Size {\n        let size = new Size()\n        if (this.vertical) {\n            let spacing = this.spacingX * (this.groupItemTotal - 1)\n            size.width = (this.accommodWidth - spacing) / this.groupItemTotal\n            size.height = item.height\n        } else {\n            let spacing = this.spacingY * (this.groupItemTotal - 1)\n            size.height = (this.accommodHeight - spacing) / this.groupItemTotal\n            size.width = item.width\n        }\n        return size\n    }\n    /** 获取Item的YMax */\n    protected getItemYMax(item: UITransform | null): number {\n        if (!item) return 0\n        let height = this.getScaleHeight(item) * (1 - item.anchorY)\n        return item.node.position.y + height\n    }\n    /** 获取Item的YMin */\n    protected getItemYMin(item: UITransform | null): number {\n        if (!item) return 0\n        let height = this.getScaleHeight(item) * item.anchorY\n        return item.node.position.y - height\n    }\n    /** 获取Item的XMax */\n    protected getItemXMax(item: UITransform | null): number {\n        if (!item) return 0\n        let width = this.getScaleWidth(item) * (1 - item.anchorX)\n        return item.node.position.x + width\n    }\n    /** 获取Item的XMin */\n    protected getItemXMin(item: UITransform | null): number {\n        if (!item) return 0\n        let width = this.getScaleWidth(item) * item.anchorX\n        return item.node.position.x - width\n    }\n    /** 获取一组Item中起始位置X */\n    protected getStartX(item: UITransform | null): number {\n        if (!item) return 0\n        var x = 0\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            let width = this.getScaleWidth(item) * item.anchorX\n            x = this.viewStartPoint.x + width\n        } else {\n            let width = this.getScaleWidth(item) * (1 - item.anchorX)\n            x = this.viewStartPoint.x - width\n        }\n        return x\n    }\n    /** 获取一组Item中结束位置X */\n    protected getEndX(item: UITransform | null): number {\n        if (!item) return 0\n        var x = 0\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            let width = this.getScaleWidth(item) * (1 - item.anchorX)\n            x = -this.viewStartPoint.x - width - this.paddingRight + this.paddingLeft\n        } else {\n            let width = this.getScaleWidth(item) * item.anchorX\n            x = -this.viewStartPoint.x + width + this.paddingLeft - this.paddingRight\n        }\n        return x\n    }\n    /** 获取一组Item中起始位置Y */\n    protected getStartY(item: UITransform | null): number {\n        if (!item) return 0\n        var y = 0\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            let height = this.getScaleHeight(item) * (1 - item.anchorY)\n            y = this.viewStartPoint.y - height\n        } else {\n            let height = this.getScaleHeight(item) * item.anchorY\n            y = this.viewStartPoint.y + height\n        }\n        return y\n    }\n    /** 获取一组Item中结束位置Y */\n    protected getEndY(item: UITransform | null): number {\n        if (!item) return 0\n        var y = 0\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            let height = this.getScaleHeight(item) * item.anchorY\n            y = -this.viewStartPoint.y + height + this.paddingBottom - this.paddingTop\n        } else {\n            let height = this.getScaleHeight(item) * (1 - item.anchorY)\n            y = -this.viewStartPoint.y - height - this.paddingTop + this.paddingBottom\n        }\n        return y\n    }\n    /** relative的顶部是否有也容纳空间 */\n    protected isAccommodateByTop(relative: UITransform) {\n        var max = this.getItemYMax(relative)\n        return max + this.paddingTop < this.accommodHeight * 0.5\n    }\n    /** relative的底部是否有也容纳空间 */\n    protected isAccommodateByBottom(relative: UITransform) {\n        var min = this.getItemYMin(relative)\n        return min - this.paddingBottom > this.accommodHeight * -0.5\n    }\n    /** relative的左侧是否有也容纳空间 */\n    protected isAccommodateByLeft(relative: UITransform) {\n        var min = this.getItemXMin(relative)\n        return min - this.paddingLeft > this.accommodWidth * -0.5\n    }\n    /** relative的右侧是否有也容纳空间 */\n    protected isAccommodateByRight(relative: UITransform) {\n        var max = this.getItemXMax(relative)\n        return max + this.paddingRight < this.accommodWidth * 0.5\n    }\n    /** relative的左侧位置 */\n    protected getRelativeByLeft(item: UITransform, relative: UITransform): number {\n        var min = this.getItemXMin(relative)\n        return min - this.spacingX - this.getScaleWidth(item) * (1 - item.anchorX)\n    }\n    /** relative的右侧位置 */\n    protected getRelativeByRight(item: UITransform, relative: UITransform): number {\n        var max = this.getItemXMax(relative)\n        return max + this.spacingX + this.getScaleWidth(item) * item.anchorX\n    }\n    /** relative的顶部位置 */\n    protected getRelativeByTop(item: UITransform, relative: UITransform): number {\n        var max = this.getItemYMax(relative)\n        return max + this.spacingY + this.getScaleHeight(item) * item.anchorY\n    }\n    /** relative的底部位置 */\n    protected getRelativeByBottom(item: UITransform, relative: UITransform): number {\n        var min = this.getItemYMin(relative)\n        return min - this.spacingY - this.getScaleHeight(item) * (1 - item.anchorY)\n    }\n    /** 设置Item的坐标位置 */\n    protected setItemPosition(item: UITransform, relative: UITransform, reverse: boolean = false, isHeader: boolean = false) {\n        var pos = new Vec3()\n        if (isHeader) {\n            pos.x = this.getStartX(item)\n            pos.y = this.getStartY(item)\n        } else {\n            if (this.vertical) {\n                pos = this.getVerticalRelativePosition(item, relative, reverse)\n            } else {\n                pos = this.getHorizontalRelativePosition(item, relative, reverse)\n            }\n        }\n        item.node.setPosition(pos)\n    }\n\n    /** 计算垂直模式的Item应该的位置 */\n    protected getVerticalRelativePosition(item: UITransform, relative: UITransform, reverse: boolean) {\n        var pos = new Vec3()\n        var isAccommodate = false\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            isAccommodate = !reverse ? this.isAccommodateByRight(relative) : this.isAccommodateByLeft(relative)\n        } else {\n            isAccommodate = !reverse ? this.isAccommodateByLeft(relative) : this.isAccommodateByRight(relative)\n        }\n        // 横轴\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            if (!reverse) {\n                pos.x = isAccommodate ? this.getRelativeByRight(item, relative) : this.getStartX(item)\n            } else {\n                pos.x = isAccommodate ? this.getRelativeByLeft(item, relative) : this.getEndX(item)\n            }\n        } else {\n            if (!reverse) {\n                pos.x = isAccommodate ? this.getRelativeByLeft(item, relative) : this.getStartX(item)\n            } else {\n                pos.x = isAccommodate ? this.getRelativeByRight(item, relative) : this.getEndX(item)\n            }\n        }\n        // 纵轴\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            if (!reverse) {\n                pos.y = isAccommodate ? relative.node.position.y : this.getRelativeByBottom(item, relative)\n            } else {\n                pos.y = isAccommodate ? relative.node.position.y : this.getRelativeByTop(item, relative)\n            }\n        } else {\n            if (!reverse) {\n                pos.y = isAccommodate ? relative.node.position.y : this.getRelativeByTop(item, relative)\n            } else {\n                pos.y = isAccommodate ? relative.node.position.y : this.getRelativeByBottom(item, relative)\n            }\n        }\n        return pos\n    }\n    /** 计算水平模式的Item应该的位置 */\n    protected getHorizontalRelativePosition(item: UITransform, relative: UITransform, reverse: boolean) {\n        var pos = new Vec3()\n        var isAccommodate = false\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            isAccommodate = !reverse ? this.isAccommodateByBottom(relative) : this.isAccommodateByTop(relative)\n        } else {\n            isAccommodate = !reverse ? this.isAccommodateByTop(relative) : this.isAccommodateByBottom(relative)\n        }\n        // 纵轴\n        if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n            if (!reverse) {\n                pos.y = isAccommodate ? this.getRelativeByBottom(item, relative) : this.getStartY(item)\n            } else {\n                pos.y = isAccommodate ? this.getRelativeByTop(item, relative) : this.getEndY(item)\n            }\n        } else {\n            if (!reverse) {\n                pos.y = isAccommodate ? this.getRelativeByTop(item, relative) : this.getStartY(item)\n            } else {\n                pos.y = isAccommodate ? this.getRelativeByBottom(item, relative) : this.getEndY(item)\n            }\n        }\n        // 横轴\n        if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n            if (!reverse) {\n                pos.x = isAccommodate ? relative.node.position.x : this.getRelativeByRight(item, relative)\n            } else {\n                pos.x = isAccommodate ? relative.node.position.x : this.getRelativeByLeft(item, relative)\n            }\n        } else {\n            if (!reverse) {\n                pos.x = isAccommodate ? relative.node.position.x : this.getRelativeByLeft(item, relative)\n            } else {\n                pos.x = isAccommodate ? relative.node.position.x : this.getRelativeByRight(item, relative)\n            }\n        }\n        return pos\n    }\n    /** 当数据长度发生变化时 计算item应该怎么排列 */\n    protected refreshItems(offset: number, refreshLastItem: boolean = false) {\n        if (offset < 0) {\n            for (let i = 0; i < -offset; i++) {\n                if (this.headerLoop) {\n                    this.pushToHeader()\n                } else if (this.footerLoop) {\n                    this.pushToHeader()\n                } else {\n                    this.pushToHeader(true)\n                    this.pushToFooter()\n                }\n            }\n            let startIndex = this.headerIndex > 0 ? this.headerIndex : 0\n            if (startIndex + this.node.children.length > this.itemTotal) {\n                startIndex += offset\n            }\n            if (startIndex < 0) startIndex = 0\n            for (let i = 0; i < this.node.children.length; i++) {\n                const child: any = this.node.children[i];\n                if (this.headerLoop || this.footerLoop) {\n                    if (startIndex > this.itemTotal - 1) {\n                        startIndex = 0\n                    }\n                }\n                child[\"__index\"] = startIndex\n                startIndex++\n                if (refreshLastItem) {\n                    this.notifyRefreshItem(child)\n                }\n            }\n            this.scrollView.stopAutoScroll()\n            this.scrollView.startAutoScroll()\n        } else {\n            for (let i = 0; i < this.node.children.length; i++) {\n                if (this.vertical) {\n                    if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                        this.pushToFooter()\n                    } else {\n                        this.pushToHeader()\n                    }\n                } else {\n                    if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                        this.pushToFooter()\n                    } else {\n                        this.pushToHeader()\n                    }\n                }\n            }\n        }\n    }\n    protected createItems(count: number, refreshLastItem: boolean = false) {\n        // 有多余的item 需要删除 不处理\n        if (this.node.children.length > count) {\n            this.removeItems(count)\n            return\n        }\n        if (!this.needAddPrefab()) {\n            // 已经固定item总数 不处理\n            if (this._maxPrefabTotal > 0 && this._maxPrefabTotal == this.node.children.length) {\n                return\n            }\n        }\n        let total = count - this.node.children.length //计算当前应该创建的总数\n        for (let i = 0; i < total; i++) {\n            let child: any = instantiate(this.cloneNode)\n            const transform = child.getComponent(UITransform)\n            this.setAndSaveSizeAndScale(transform)\n            child[\"__index\"] = this.node.children.length\n            this.node.addChild(child)\n            var reverse = false\n            var index = this.node.children.length - 2\n            var relative\n            if (child[\"__index\"] == 0) {\n                relative = this.footer!\n            } else {\n                relative = this.node.children[index]._uiProps.uiTransformComp!\n            }\n            child.on(Node.EventType.SIZE_CHANGED, () => { this.onChangeChildSize(transform) }, this, true)\n            child.on(Node.EventType.TRANSFORM_CHANGED, (type: any) => { this.onChangeChildScale(type, transform) }, this, true)\n            this.notifyRefreshItem(child)\n            this.setItemPosition(child.getComponent(UITransform), relative, reverse, child[\"__index\"] == 0)\n            /**\n             * 根据排列方向 来判断对比宽度还是高度\n             * 这里使用参数this.multiple来判断是否需要继续创建 默认为2倍 比如view可视尺寸为800 2倍就是1600\n             * 根据之前所创建的所有item的尺寸计算是否满足这个尺寸 如果满足则不再继续创建 \n             * 由于是分帧加载 所以下一次创建会等这一次的返回结果 返回false 则终止分帧任务\n             */\n            if (!this.needAddPrefab()) {\n                this._maxPrefabTotal = this.node.children.length\n                console.log(\"已固定item数量\", this._maxPrefabTotal)\n                break\n            }\n        }\n    }\n    protected needAddPrefab() {\n        const self = this.vertical ? this.contentSize.height : this.contentSize.width\n        if (self > 0) {\n            // 当尺寸改变时 重新计算prefab的数量\n            const view = this.vertical ? this.view.height : this.view.width\n            if (self < view * this.multiple) {\n                return true\n            }\n        }\n        return false\n    }\n    protected async onChangeChildSize(item: UITransform) {\n        const node: any = item.node\n        if (this.groupItemTotal > 1) {\n            const __size = node[\"__size\"]\n            item.setContentSize(__size)\n            console.warn(\"表格布局不支持动态修改 Size,如果你非要修改，那你把我注释掉看效果\")\n            return\n        }\n        if (this.stretchLock.index == node[\"__index\"]) {\n            this.scrollToIndex(this.stretchLock.index!, this.stretchLock.timeInSecond, this.stretchLock.boundary, this.stretchLock.reverse)\n        }\n        this.resetStrectchItems()\n    }\n    protected async onChangeChildScale(type: any, item: UITransform) {\n        if (type !== Node.TransformBit.SCALE) {\n            return\n        }\n        if (!this.affectedByScale) return\n        const node: any = item.node\n        if (this.groupItemTotal > 1) {\n            const __scale = node[\"__scale\"]\n            item.node.setScale(__scale)\n            console.warn(\"表格布局不支持动态修改 Scale,如果你非要修改，那你把我注释掉看效果\")\n            return\n        }\n        if (this.stretchLock.index == node[\"__index\"]) {\n            this.scrollToIndex(this.stretchLock.index!, this.stretchLock.timeInSecond, this.stretchLock.boundary, this.stretchLock.reverse)\n        }\n        this.resetStrectchItems()\n    }\n    protected resetStrectchItems() {\n        if (!isNaN(this.stretchLock.index!)) {\n            const index = this.node.children.findIndex((item: any) => item[\"__index\"] == this.stretchLock.index)\n            if (index != -1) {\n                for (let i = index; i >= 0; i--) {\n                    const item = this.node.children[i];\n                    if (i == index) continue\n                    if (i < index) {\n                        this.setItemPosition(item._uiProps.uiTransformComp!, this.node.children[i + 1]._uiProps.uiTransformComp!, true)\n                    }\n                }\n                for (let i = index; i < this.node.children.length; i++) {\n                    const item = this.node.children[i];\n                    if (i == index) continue\n                    this.setItemPosition(item._uiProps.uiTransformComp!, this.node.children[i - 1]._uiProps.uiTransformComp!)\n                }\n                return\n            }\n        }\n        if (this.scrollDirection == ScrollDirection.HEADER) {\n            this.unschedule(this.stretchToFooter)\n            this.scheduleOnce(this.stretchToFooter)\n        } else {\n            this.unschedule(this.stretchToHeader)\n            this.scheduleOnce(this.stretchToHeader)\n        }\n    }\n    private stretchToHeader() {\n        for (let i = this.node.children.length - 1; i >= 0; i--) {\n            const item = this.node.children[i];\n            if (i == this.node.children.length - 1) continue\n            this.setItemPosition(item._uiProps.uiTransformComp!, this.node.children[i + 1]._uiProps.uiTransformComp!, true)\n        }\n    }\n    private stretchToFooter() {\n        for (let i = 0; i < this.node.children.length; i++) {\n            const item = this.node.children[i];\n            if (i == 0) continue\n            this.setItemPosition(item._uiProps.uiTransformComp!, this.node.children[i - 1]._uiProps.uiTransformComp!)\n        }\n    }\n\n    /** 删除多余的item */\n    protected removeItems(count: number) {\n        // 有多余的item 需要删除\n        let length = this.node.children.length - count\n        // 删除掉多余的item\n        for (let i = 0; i < length; i++) {\n            var child = this.node.children[this.node.children.length - 1]\n            child.off(Node.EventType.SIZE_CHANGED)\n            child.off(Node.EventType.TRANSFORM_CHANGED)\n            this.node.removeChild(child)\n            child.destroy()\n        }\n    }\n    protected addEventListener() {\n        this.node.on(Node.EventType.TRANSFORM_CHANGED, this.onPositionChanged, this)\n    }\n    protected removeEventListener() {\n        this.node.off(Node.EventType.TRANSFORM_CHANGED, this.onPositionChanged, this)\n    }\n    /** 重新计算当前所有Item的位置 */\n    protected resetChilds(start: boolean = false) {\n        if (this.vertical && this.fixedItemHeight <= this.view.height || !this.vertical && this.fixedItemWidth <= this.view.width) {\n            let x = this.getStartX(this.header)\n            let y = this.getStartY(this.header)\n            this.header?.node.setPosition(new Vec3(x, y))\n        }\n        if (start) {\n            if (this.vertical) {\n                let x = this.getStartX(this.header)\n                this.header?.node.setPosition(new Vec3(x, this.header.node.position.y))\n            } else {\n                let y = this.getStartY(this.header)\n                this.header?.node.setPosition(new Vec3(this.header.node.position.x, y))\n            }\n        }\n        this.stretchToFooter()\n        if (!start) {\n            this.scrollView.startAutoScroll()\n        }\n    }\n    protected onTouchBegin() {\n        this.stretchLock = {}\n    }\n    protected getUsedScaleValue(value: number) {\n        return this.affectedByScale ? Math.abs(value) : 1;\n    }\n    protected getScaleWidth(trans: UITransform | null): number {\n        if (!trans) return 0\n        const size = (trans.node as any)[\"__runtime_size\"]\n        const width = size ? size.width : trans.width\n        return width * this.getUsedScaleValue(trans.node.scale.x)\n    }\n    protected getScaleHeight(trans: UITransform | null): number {\n        if (!trans) return 0\n        const size = (trans.node as any)[\"__runtime_size\"]\n        const height = size ? size.height : trans.height\n        return height * this.getUsedScaleValue(trans.node.scale.y)\n    }\n    protected onPositionChanged() {\n        if (this.isRestart) return\n        if (this.vertical) {\n            if (this.scrollView.prevLocation.y < this.scrollView.location.y) {\n                this.scrollDirection = ScrollDirection.FOOTER\n            } else if (this.scrollView.prevLocation.y > this.scrollView.location.y) {\n                this.scrollDirection = ScrollDirection.HEADER\n            } else {\n                this.scrollDirection = ScrollDirection.NONE\n            }\n        } else {\n            if (this.scrollView.prevLocation.x > this.scrollView.location.x) {\n                this.scrollDirection = ScrollDirection.FOOTER\n            } else if (this.scrollView.prevLocation.x < this.scrollView.location.x) {\n                this.scrollDirection = ScrollDirection.HEADER\n            } else {\n                this.scrollDirection = ScrollDirection.NONE\n            }\n        }\n\n        if (this.vertical) {\n            for (let i = 0; i < this.node.children.length; i++) {\n                let isOfBoundary = Math.abs(this.prevPos.y - this.node.position.y) > EPSILON\n                if (!isOfBoundary) continue\n                if (this.prevPos.y < this.node.position.y) {\n                    this.pushToFooter()\n                } else if (this.prevPos.y > this.node.position.y) {\n                    this.pushToHeader()\n                }\n            }\n        } else {\n            for (let i = 0; i < this.node.children.length; i++) {\n                let isOfBoundary = Math.abs(this.prevPos.x - this.node.position.x) > EPSILON\n                if (!isOfBoundary) continue\n                if (this.prevPos.x > this.node.position.x) {\n                    this.pushToFooter()\n                } else if (this.prevPos.x < this.node.position.x) {\n                    this.pushToHeader()\n                }\n            }\n        }\n\n        this.prevPos = this.node.position.clone()\n    }\n    /** 向尾部填充 force如果为true 则强制填充 */\n    protected pushToFooter(force: boolean = false) {\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                if (force || this.headerBoundary - this.paddingTop > this.viewHeaderBoundary + this.header?.height!) {\n                    this.pushToFooterHandler()\n                }\n            } else {\n                if (force || this.footerBoundary - this.paddingTop > this.viewHeaderBoundary + this.header?.height!) {\n                    this.pushToHeaderHandler()\n                }\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                if (force || this.headerBoundary + this.paddingLeft < this.viewHeaderBoundary - this.header?.width!) {\n                    this.pushToFooterHandler()\n                }\n            } else {\n                if (force || this.footerBoundary + this.paddingLeft < this.viewHeaderBoundary - this.header?.width!) {\n                    this.pushToHeaderHandler()\n                }\n            }\n        }\n    }\n    /** 向头部填充 force如果为true 则强制填充 */\n    protected pushToHeader(force: boolean = false) {\n        if (this.vertical) {\n            if (this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM) {\n                if (force || this.footerBoundary + this.paddingBottom < this.viewFooterBoundary - this.footer?.height!) {\n                    this.pushToHeaderHandler()\n                }\n            } else {\n                if (force || this.headerBoundary + this.paddingBottom < this.viewFooterBoundary - this.footer?.height!) {\n                    this.pushToFooterHandler()\n                }\n            }\n        } else {\n            if (this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT) {\n                if (force || this.footerBoundary - this.paddingRight > this.viewFooterBoundary + this.footer?.width!) {\n                    this.pushToHeaderHandler()\n                }\n            } else {\n                if (force || this.headerBoundary - this.paddingRight > this.viewFooterBoundary + this.footer?.width!) {\n                    this.pushToFooterHandler()\n                }\n            }\n        }\n    }\n    protected pushToFooterHandler() {\n        var node: any = this.header?.node\n        let loop\n        if (this.vertical) {\n            loop = this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM ? this.footerLoop : this.headerLoop\n        } else {\n            loop = this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT ? this.footerLoop : this.headerLoop\n        }\n        if (loop) {\n            if (this.footerIndex >= this.itemTotal - 1) {\n                node[\"__index\"] = 0\n            } else {\n                node[\"__index\"] = this.footerIndex + 1\n            }\n        } else {\n            if (!this.footer || this.footerIndex >= this.itemTotal - 1) return\n            node[\"__index\"] = this.footerIndex + 1\n        }\n        if (node[\"__index\"] > 0 && node[\"__index\"] < this.currentCreateItemTotal) {\n            this.notifyRefreshItem(node)\n        }\n        this.setItemPosition(this.header!, this.footer!)\n        this.header?.node.setSiblingIndex(this.node.children.length)\n    }\n    protected pushToHeaderHandler() {\n        var node: any = this.footer?.node\n        let loop\n        if (this.vertical) {\n            loop = this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM ? this.headerLoop : this.footerLoop\n        } else {\n            loop = this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT ? this.headerLoop : this.footerLoop\n        }\n        // 对其头部\n        if (!loop && this.headerIndex == 0) {\n            // 判断是否是起始位置\n            var accommodate\n            if (this.vertical) {\n                accommodate = this.horizontalAxisDirection == HorizontalAxisDirection.LEFT_TO_RIGHT ? this.isAccommodateByLeft(this.header!) : this.isAccommodateByRight(this.header!)\n            } else {\n                accommodate = this.verticalAxisDirection == VerticalAxisDirection.TOP_TO_BOTTOM ? this.isAccommodateByTop(this.header!) : this.isAccommodateByBottom(this.header!)\n            }\n            if (accommodate) {\n                this.resetChilds(true)\n            }\n        }\n        if (loop) {\n            if (this.headerIndex == 0) {\n                node[\"__index\"] = this.itemTotal - 1\n            } else {\n                node[\"__index\"] = this.headerIndex - 1\n            }\n        } else {\n            if (!this.header || this.headerIndex == 0) return\n            node[\"__index\"] = this.headerIndex - 1\n        }\n        if (node[\"__index\"] > 0 && node[\"__index\"] < this.currentCreateItemTotal) {\n            this.notifyRefreshItem(node)\n        }\n        this.setItemPosition(this.footer!, this.header!, true)\n        this.footer?.node.setSiblingIndex(0)\n\n    }\n    /** 通知给定的node刷新数据 */\n    protected notifyRefreshItem(target: Node) {\n        EventHandler.emitEvents(this.refreshItemEvents, target, (target as any)['__index'])\n    }\n}\n\n"]}