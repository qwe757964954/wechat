{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/scripts/GameMenuPrefabCtr.ts"],"names":["Node","_decorator","GCache","AppEvent","GameTxt","EventManager","BaseComponent","RoomMgr","FXJEvent","FXJUIID","FXJSound","GameEvent","ccclass","property","menu","GameMenuPrefabCtr","tooltip","type","_redDotView","onInitModuleEvent","addModelListener","VIEW_DESK_BTN_MENU_UPDATE","showOrHideBtnMore","VIEW_BROADCAST_PLAYER_ENTER","onPlayerInto","NOTIFY_UPDATE_RED_DOT","refreshRedDot","onLoad","btnToolBar","active","btnBack","btnChat","timeLayout","initData","start","event","state","uid","User","getUserMid","onClickBack","dispatch","SYS_PLAY_EFFECT","CommClick","getInstance","remainCardsCount","SYS_TOAST_TIP","content","login_out_room_fail","NET_REQ_LOGOUT_IN_GAME","onClickToolBar","GAME_OPEN_POPUP","ToolBarPrefab","onClickChat","GameChatPrefab","keyType","imgRedDot","getChildByName","RedDot","hasRedDot","onDestroy"],"mappings":"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","sourcesContent":["\nimport { Node, _decorator } from 'cc';\nimport { GCache } from '../../../cache/GCache';\nimport { AppEvent } from '../../../config/AppEvent';\nimport { GameTxt } from '../../../config/GameTxt';\nimport { EventManager } from '../../../framework/manager/EventManager';\nimport { BaseComponent } from '../../../framework/vc/BaseComponent';\nimport { RoomMgr } from '../cache/RoomMgr';\nimport { FXJEvent } from '../common/FXJEvent';\nimport { FXJUIID } from '../common/FXJRes';\nimport { FXJSound } from '../common/FXJSound';\nimport { GameEvent } from '../common/GameEvent';\nconst { ccclass, property, menu } = _decorator;\n/**\n * Name = GameMenuPrefabCtr\n * URL = db://assets/package/game/scripts/GameMenuPrefabCtr.ts\n * Time = Thu Jul 27 2023 16:05:53 GMT+0800 (中国标准时间)\n * Author = harvyson\n * 游戏菜单\n * Life: onLoad-->onInitModuleEvent-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n * \n */\n\n@ccclass('GameMenuPrefabCtr')\n//方便编辑器识别的菜单项目\n@menu('prefab/game/GameMenuPrefabCtr')\nexport class GameMenuPrefabCtr extends BaseComponent {\n\n\t/** 更多按钮节点 */\n\t@property({ tooltip: \"更多按钮节点\", type: Node })\n\tprivate btnToolBar: Node | null = null;\n\n\t/** 返回按钮节点 */\n\t@property({ tooltip: \"返回按钮节点\", type: Node })\n\tprivate btnBack: Node | null = null;\n\n\t/** 聊天按钮节点 */\n\t@property({ tooltip: \"聊天按钮节点\", type: Node })\n\tprivate btnChat: Node | null = null;\n\n\t/** 时间节点 */\n\t@property({ tooltip: \"时间节点\", type: Node })\n\tprivate timeLayout: Node | null = null;\n\n\n\n\t/** 红点UI队列 */\n\t_redDotView: { [key: string]: Node } = {};\n\n\t/**模块事件定义 */\n\tprotected onInitModuleEvent() {\n\t\t//显示或隐藏更多\n\t\tthis.addModelListener(FXJEvent.VIEW_DESK_BTN_MENU_UPDATE, this.showOrHideBtnMore);\n\t\t// //玩家进入房间 显示更新时间\n\t\tthis.addModelListener(GameEvent.VIEW_BROADCAST_PLAYER_ENTER, this.onPlayerInto);\n\n\t\t//红点更新\n\t\tthis.addModelListener(FXJEvent.NOTIFY_UPDATE_RED_DOT, this.refreshRedDot);\n\t}\n\n\tonLoad() {\n\t\tthis.btnToolBar.active = false;\n\t\tthis.btnBack.active = false;\n\t\tthis.btnChat.active = false;\n\t\tthis.timeLayout.active = false;\n\t\tthis.initData();\n\t\tthis.refreshRedDot();\n\t};\n\n\tstart() {\n\n\t};\n\n\n\t//初始化数据\n\tinitData() {\n\t\tthis._redDotView = {\n\t\t\t// /** 每日任务 */\n\t\t\t// [GConstants.RedDotConf.Task_Day]: this.btnTask,\n\t\t\t// /** 每周任务 */\n\t\t\t// [GConstants.RedDotConf.Task_Week]: this.btnTask,\n\t\t}\n\n\n\t}\n\t/** 显示或隐藏更多 */\n\tshowOrHideBtnMore(event = null, state) {\n\t\tthis.btnToolBar.active = state;\n\t}\n\t/** 收到消息:用户进入房间 */\n\tonPlayerInto(event, uid) {\n\t\tif (uid == GCache.User.getUserMid()) {\n\t\t\tthis.btnBack.active = false;\n\t\t\tthis.btnToolBar.active = true;\n\t\t\tthis.btnChat.active = true;\n\t\t}\n\t}\n\n\n\n\t//点击退出\n\tonClickBack(event: Event) {\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tif(RoomMgr.getInstance().remainCardsCount > 0){\n\t\t\tEventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: GameTxt.login_out_room_fail })\n\t\t\treturn;\n\t\t}\n\t\tEventManager.dispatch(FXJEvent.NET_REQ_LOGOUT_IN_GAME);\n\t\t// EventManager.dispatch(FXJEvent.REPORT_CLIENT_CLICK, { eventID: ReportConfig.game_1 });\n\t}\n\n\t//点击更多\n\tonClickToolBar(event: Event) {\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tthis.showOrHideBtnMore(null, false);\n\t\tEventManager.dispatch(FXJEvent.GAME_OPEN_POPUP, FXJUIID.ToolBarPrefab, null, {})\n\t\t// EventManager.dispatch(FXJEvent.REPORT_CLIENT_CLICK, { eventID: ReportConfig.game_2 });\n\t}\n\n\t//点击聊天\n\tonClickChat(event) {\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tEventManager.dispatch(FXJEvent.GAME_OPEN_POPUP, FXJUIID.GameChatPrefab, null, {});\n\t\t// EventManager.dispatch(FXJEvent.REPORT_CLIENT_CLICK, { eventID: ReportConfig.game_6 });\n\t}\n\n\n\n\n\n\n\t/** 红点更新 */\n\trefreshRedDot(event = null, keyType = null) {\n\t\tif (keyType == null) {\n\t\t\tfor (let keyType in this._redDotView) {\n\t\t\t\tlet imgRedDot = this._redDotView[keyType].getChildByName(\"img_dot\");\n\t\t\t\tif (imgRedDot) {\n\t\t\t\t\timgRedDot.active = GCache.RedDot.hasRedDot(keyType, keyType);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._redDotView[keyType] == null) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet imgRedDot = this._redDotView[keyType].getChildByName(\"img_dot\");\n\t\t\tif (imgRedDot) {\n\t\t\t\timgRedDot.active = GCache.RedDot.hasRedDot(keyType, keyType);\n\t\t\t}\n\t\t}\n\t}\n\n\t//销毁\n\tonDestroy() {\n\n\t};\n\n}"]}