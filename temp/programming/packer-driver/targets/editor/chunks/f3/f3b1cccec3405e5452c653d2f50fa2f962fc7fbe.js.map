{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/module/settle/src/FanItem.ts"],"names":["Color","Label","Sprite","SpriteAtlas","_decorator","Utils","resLoader","SettleMgr","FXJRes","ListItem","ccclass","property","WinItemColor","FailItemColor","FanItem","upDownMap","Map","onInitModuleEvent","getUpDownMap","seatid","id","coord","updateItemProps","index","data","set","totalStr","totalFanStr","multiple_num","string","idStr","up_down","fanList","fanInfo","fanStr","i","length","num","parseInt","fan","fanName","detail","setListBgColor","myInfo","getInstance","getMyTotalInfo","prefixStr","bWin","listStr","totalFan","bgStr","frameBg","string_format","Prefab_Settle_Image","plistKey","load","bundle","path","err","atlas","bgAtlas","getSpriteFrame","bg","spriteFrame","colorItem","colorStr","Win","Fail","normalColor","color"],"mappings":"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","sourcesContent":["\nimport { Color, Label, Sprite, SpriteAtlas, _decorator } from 'cc';\nimport { Utils } from '../../../../../framework/Utils';\nimport { resLoader } from '../../../../../framework/loader/ResLoader';\nimport { SettleMgr } from '../../../cache/SettleMgr';\nimport { FXJRes } from '../../../common/FXJRes';\nimport { Game } from '../../../common/idl/Game';\nimport ListItem from './list/ListItem';\nconst { ccclass, property } = _decorator;\n\n/**\n * Name = ListItem\n * URL = db://assets/package/game/module/settle/src/ListItem.ts\n * Time = Tue Aug 08 2023 18:10:14 GMT+0800 (中国标准时间)\n * Author = qwe757964\n *\n * Life: onLoad-->onInitModuleEvent-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n * \n */\nexport enum WinItemColor {\n\tWin = \"#D34000\",\n\tFail = \"#B67D41\"\n}\n\nexport enum FailItemColor {\n\tWin = \"#457BDE\",\n\tFail = \"#7D8ACE\"\n}\n\n\n@ccclass('ListItem')\nexport class FanItem extends ListItem {\n\t@property(Sprite)\n    public bg: Sprite | null = null;\n\n\t@property(Label)\n    public up_down: Label | null = null;\n\t\n\t@property(Label)\n    public detail: Label | null = null;\n\t\n\t@property(Label)\n    public multiple_num: Label | null = null;\n\t\n\t//code 对应的图集\n    upDownMap = new Map<number, string>();\n\t/** override 初始化模块事件 */\n\tprotected onInitModuleEvent() {\n\n\t};\n\n\tgetUpDownMap(seatid: number) : string {\n\t\tfor (let [id, coord] of this.upDownMap) {\n            if (seatid == id) {\n                return coord;\n            }\n        }\n        return null;\n\t}\n\n\t/** 更新界面 */\n\tupdateItemProps (index:number,data: Game.ISettleFanExtendInfo) {\n\t\tthis.upDownMap.set(3, \"上\");\n\t\tthis.upDownMap.set(1, \"下\");\n\t\tthis.upDownMap.set(2, \"对\");\n\t\tthis.upDownMap.set(0, \"本\");\n\t\t\n\t\tlet totalStr:string = data.totalFanStr ? data.totalFanStr:\"0\";\n\t\tthis.multiple_num.string = totalStr + \"倍\";\n\t\tlet idStr:string = this.getUpDownMap(index);\n\t\tthis.up_down.string = idStr + \"家\";\n\t\tlet fanList:Game.IFanInfo[] = data.fanInfo;\n\t\tlet fanStr = \"\";\n\t\tfor (let i = 0; i < fanList.length; i++) {\n\t\t\tconst num: number = parseInt(fanList[i].fan);\n\t\t\tlet fanName:string = fanList[i].fanName;\n\t\t\tif(num){\n\t\t\t\tfanName = fanName + \"X\" + fanList[i].fan\n\t\t\t}\n\t\t\tif(i !== fanList.length - 1){\n\t\t\t\tfanName = fanName + \"、\"\n\t\t\t}\n\t\t\tfanStr = fanStr + fanName;\n\t\t}\n\t\tthis.detail.string = fanStr;\n\t\t\n\t\tthis.setListBgColor(data);\n\t};\n\n\tsetListBgColor(data: Game.ISettleFanExtendInfo){\n\t\tlet myInfo:Game.ITotalInfo = SettleMgr.getInstance().getMyTotalInfo();\n\t\tlet prefixStr:string = myInfo.bWin !== -1 ? \"win_\":\"fail_\";\n\t\tlet listStr:string = data.totalFan > 0 ? \"list2\":\"list1\";\n\t\tlet bgStr:string = `${prefixStr}${listStr}`;\n\t\tlet frameBg = Utils.string_format(FXJRes.Prefab_Settle_Image.plistKey, bgStr)\n\t\tresLoader.load(FXJRes.Prefab_Settle_Image.bundle, FXJRes.Prefab_Settle_Image.path, SpriteAtlas, (err: Error | null, atlas) => {\n\t\t\tif (err) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tlet bgAtlas = atlas.getSpriteFrame(frameBg);\n\t\t\tif (bgAtlas) {\n\t\t\t\tthis.bg.spriteFrame = bgAtlas;\n\t\t\t}\n\t\t});\n\t\tlet colorItem:any = myInfo.bWin !== -1 ? WinItemColor:FailItemColor;\n\t\tlet colorStr:string = data.totalFan > 0 ? colorItem.Win:colorItem.Fail;\n\t\tlet normalColor = new Color(colorStr);\n\t\tthis.up_down.color = normalColor;\n\t\tthis.detail.color = normalColor;\n\t\tthis.multiple_num.color = normalColor;\n\t}\n\n}\n\n"]}