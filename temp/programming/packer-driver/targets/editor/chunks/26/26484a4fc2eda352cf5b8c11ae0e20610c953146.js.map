{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/activity/scripts/mailPrefabCtr.ts"],"names":["Label","Layout","Node","Sprite","SpriteAtlas","_decorator","instantiate","GCache","AppEvent","GConstants","GameTxt","Utils","Encrypt","resLoader","EventManager","BaseComponent","ccclass","property","menu","mailPrefabCtr","tooltip","type","mailData","curentIndex","currentData","currentItem","onInitModuleEvent","addModelListener","NOTIFY_EMAIL_CHANGE","updateView","NET_RESP_EMAIL_REWARD","respGetAward","NOTIFY_UPDATE_RED_DOT","redDotUpdate","onLoad","initData","initView","start","dispatch","NET_CMD_REQ_WATCH","MailInfo","sortMsgData","MailData","table_isEmpty","mailLayout","active","noMailNode","mailNum","string","setMailBtn","length","showView","mailLayer","removeAllChildren","maxlenth","MessageMaxNum","i","mailStatus","status","data","node","mailItem","addChild","img_new","getChildByName","img_gift","initRightView","MsgStatus","MSG_STATUS_FRESH","MSG_STATUS_READ","updateMailDataInCache","updateCurrentData","titleNode","getComponent","title","timeNode","time","timeArray","timeToDataArray","awardArr","JsonDecode","awards","giftSprite","spriteFrame","mailAtlas","spriteFrames","updateLayout","dataList","itemLayer","noMailLayout","hasMailLayout","mailTitle","show_layout","hasMailContent","body","v","itemNode","numLabel","getComponentInChildren","img_item","String","num","MSG_STATUS_HANDLED","grayscale","propType","number_valueOf","conf","PropsConf","getPropsInfoById","url","setSpriteFrame","noMailContent","senderLabel","timeLabel","event","pData","addSchedulerOnce","console","log","onMailClick","child","children","target","index","Number","len","path","string_isHttp","self","loadRemote","ext","err","imageAsset","isValid","image_ImageAssetToSpriteFrame","btnLayer","onReceiveClick","SYS_TOAST_TIP","content","item_has_receive","id","NET_REQ_EMAIL_REWARD","isSuccess","respData","reqData","onCloseClick","destroy","onDestroy","keyType","RedDotConf","Email"],"mappings":"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","sourcesContent":["\nimport { EventTouch, Label, Layout, Node, Sprite, SpriteAtlas, _decorator, instantiate } from 'cc';\nimport { GCache } from '../../../cache/GCache';\nimport { AppEvent } from '../../../config/AppEvent';\nimport { GConstants } from '../../../config/GameConstant';\nimport { GameTxt } from '../../../config/GameTxt';\nimport { Utils } from '../../../framework/Utils';\nimport { Encrypt } from '../../../framework/crypto/Encrypto';\nimport { resLoader } from '../../../framework/loader/ResLoader';\nimport { EventManager } from '../../../framework/manager/EventManager';\nimport { BaseComponent } from '../../../framework/vc/BaseComponent';\n\nconst { ccclass, property, menu } = _decorator;\n\n/**\n * Name = mailPrefabCtr\n * URL = db://assets/package/hall/scripts/mailPrefabCtr.ts\n * Time = Wed Sep 14 2022 09:54:06 GMT+0800 (中国标准时间)\n * Author = Tomoe\n *\n * Life: onLoad-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n */\n\n@ccclass('mailPrefabCtr')\n//方便编辑器识别的菜单项目\n@menu('prefab/activity/mailPrefabCtr')\nexport class mailPrefabCtr extends BaseComponent {\n\n\t//左边邮件Item\n\t@property({ tooltip: \"左边邮件Item\", type: Node })\n\tprivate mailItem: Node | null = null;\n\n\t//左边邮件Layer\n\t@property({ tooltip: \"左边邮件Layer\", type: Node })\n\tprivate mailLayer: Node | null = null;\n\n\t//无邮件显示节点\n\t@property({ tooltip: \"无邮件显示节点\", type: Node })\n\tprivate noMailNode: Node | null = null;\n\n\t//邮件显示\n\t@property({ tooltip: \"邮件显示\", type: Node })\n\tprivate mailLayout: Node | null = null;\n\n\t//邮件标题\n\t@property({ tooltip: \"邮件标题\", type: Label })\n\tprivate mailTitle: Label | null = null;\n\n\t//邮件内容文本-无道具\n\t@property({ tooltip: \"邮件内容文本-无道具\", type: Label })\n\tprivate noMailContent: Label | null = null;\n\t//邮件内容文本-有道具\n\t@property({ tooltip: \"邮件内容文本-有道具\", type: Label })\n\tprivate hasMailContent: Label | null = null;\n\n\t//邮件内容-无道具\n\t@property({ tooltip: \"邮件内容-无道具\", type: Node })\n\tprivate noMailLayout: Node | null = null;\n\t//邮件内容-有道具\n\t@property({ tooltip: \"邮件内容-有道具\", type: Node })\n\tprivate hasMailLayout: Node | null = null;\n\n\t//道具列表\n\t@property({ tooltip: \"道具列表\", type: Node })\n\tprivate itemLayer: Node | null = null;\n\t//道具Item\n\t@property({ tooltip: \"道具Item\", type: Node })\n\tprivate itemNode: Node | null = null;\n\n\n\t//邮件数量显示\n\t@property({ tooltip: \"用户头像框\", type: Label })\n\tprivate mailNum: Label | null = null;\n\n\t//邮件按钮\n\t@property({ tooltip: \"邮件按钮\", type: Node })\n\tprivate btnLayer: Node | null = null;\n\n\t//邮件图集\n\t@property({ tooltip: \"邮件图集\", type: SpriteAtlas })\n\tprivate mailAtlas: SpriteAtlas | null = null;\n\n\t//邮件数据缓存\n\tmailData = [];\n\t\n\t/**当前展示内容*/\n\t//下标\n\tcurentIndex = null\n\t//数据\n\tcurrentData = null\n\tcurrentItem = null;\n\t\n\t/**初始化添加事件绑定 */\n\tprotected onInitModuleEvent(): void {\n\t\t//刷新邮件界面\n\t\tthis.addModelListener(AppEvent.NOTIFY_EMAIL_CHANGE, this.updateView);\n\t\t//请求领奖成功\n\t\tthis.addModelListener(AppEvent.NET_RESP_EMAIL_REWARD, this.respGetAward);\n\t\t//邮件红点更新\n\t\tthis.addModelListener(AppEvent.NOTIFY_UPDATE_RED_DOT, this.redDotUpdate);\n\t}\n\n\tonLoad() {\n\t\tthis.initData();\n\t\tthis.initView();\n\t};\n\n\tstart() {\n\t\t//请求拉取信箱数据\n\t\tEventManager.dispatch(AppEvent.NET_CMD_REQ_WATCH);\n\t};\n\n\tinitData() {\n\t\tthis.mailData = GCache.MailInfo.sortMsgData(GCache.MailInfo.MailData);\n\t}\n\n\tinitView() {\n\t\tif (Utils.table_isEmpty(this.mailData)) {\n\t\t\tthis.mailLayout.active = false;\n\t\t\tthis.noMailNode.active = true;\n\t\t\tthis.mailNum.string = `0/100`;\n\t\t\tthis.setMailBtn()\n\t\t} else {\n\t\t\tthis.mailNum.string = `${this.mailData.length}/100`;\n\t\t}\n\t\tthis.showView();\n\t}\n\n\tshowView() {\n\t\tthis.mailLayer.removeAllChildren();\n\t\tif (Utils.table_isEmpty(this.mailData)) {\n\t\t\treturn;\n\t\t}\n\t\tthis.noMailNode.active = false;\n\t\tlet maxlenth;\n\t\tif (this.mailData.length > GConstants.MessageMaxNum) {\n\t\t\tmaxlenth = GConstants.MessageMaxNum;\n\t\t} else {\n\t\t\tmaxlenth = this.mailData.length;\n\t\t}\n\n\t\tfor (let i = 0; i < maxlenth; i++) {\n\t\t\tlet mailStatus = this.mailData[i].status;\n\t\t\tlet data = this.mailData[i]\n\t\t\tlet node = instantiate(this.mailItem);\n\t\t\tthis.mailLayer.addChild(node);\n\t\t\tnode[\"mailData\"] = this.mailData[i];\n\t\t\tnode[\"index\"] = i;\n\t\t\tlet img_new = node.getChildByName(\"img_new\");\n\t\t\tlet img_gift = node.getChildByName(\"img_gift\");\n\t\t\tif (this.curentIndex == null && i == 0) {\n\t\t\t\tlet currentData = this.mailData[0];\n\t\t\t\tthis.initRightView(currentData);\n\t\t\t\tnode.getChildByName(\"img_selected\").active = true;\n\t\t\t\tif (currentData.status == GConstants.MsgStatus.MSG_STATUS_FRESH) {\n\t\t\t\t\tcurrentData.status = GConstants.MsgStatus.MSG_STATUS_READ\n\t\t\t\t\tGCache.MailInfo.updateMailDataInCache(currentData)\n\t\t\t\t} \n\t\t\t\t// 记录一下当前展示内容的下标\n\t\t\t\tthis.curentIndex = i;\n\t\t\t\tthis.updateCurrentData()\n\t\t\t}else if (this.curentIndex != null && this.curentIndex == i) {\n\t\t\t\tlet currentData = this.mailData[i];\n\t\t\t\t//界面打开状态\n\t\t\t\tthis.initRightView(currentData);\n\t\t\t\tnode.getChildByName(\"img_selected\").active = true;\n\t\t\t\tthis.updateCurrentData();\n\t\t\t}\n\t\t\t//设置标题\n\t\t\tlet titleNode = node.getChildByName(\"label_title\");\n\t\t\ttitleNode.getComponent(Label).string = data.title;\n\n\t\t\t//设置日期\n\t\t\tlet timeNode = node.getChildByName(\"label_time\");\n\t\t\tlet time = \"\";\n\t\t\tif (data.time != null) {\n\t\t\t\tlet timeArray = Utils.timeToDataArray(data.time);\n\t\t\t\ttime = `${timeArray[\"year\"]}-${timeArray[\"month\"]}-${timeArray[\"day\"]}`\n\t\t\t}\n\t\t\ttimeNode.getComponent(Label).string = time;\n\t\t\t\n\t\t\t//显示 new 标识图片,是否打开,是否领取标识\n\t\t\tlet awardArr = Encrypt.JsonDecode(data.awards);\n\t\t\tlet giftSprite = img_gift.getComponent(Sprite);\n\t\t\tif (mailStatus == GConstants.MsgStatus.MSG_STATUS_FRESH) {\n\t\t\t\timg_new.active = true;\n\t\t\t\tif (Utils.table_isEmpty(awardArr)) {\n\t\t\t\t\tgiftSprite.spriteFrame = this.mailAtlas.spriteFrames[\"mail/unRead\"]\n\t\t\t\t}\n\t\t\t} else if (mailStatus == GConstants.MsgStatus.MSG_STATUS_READ) {\n\t\t\t\tif (Utils.table_isEmpty(awardArr)) {\n\t\t\t\t\tgiftSprite.spriteFrame = this.mailAtlas.spriteFrames[\"mail/Read\"]\n\t\t\t\t}\n\t\t\t\timg_new.active = false;\n\t\t\t} else {\n\t\t\t\tgiftSprite.spriteFrame = this.mailAtlas.spriteFrames[\"mail/gift_open\"]\n\t\t\t\timg_new.active = false;\n\t\t\t}\n\t\t\tnode.active = true;\n\t\t\t\n\t\t}\n\t\tthis.mailLayer.getComponent(Layout).updateLayout();\n\t\t//更新右边邮件总数\n\t\tthis.mailNum.string = `${maxlenth}/100`;\n\t}\n\n\n\n\t/**\n\t * 渲染邮件内容区域\n\t * @param dataList \n\t */\n\tinitRightView(dataList) {\n\t\tthis.itemLayer.removeAllChildren();\n\t\tthis.noMailLayout.active = false;\n\t\tthis.hasMailLayout.active = false;\n\t\t//设置邮件标题\n\t\tthis.mailTitle.string = dataList.title;\n\t\tlet show_layout;\n\t\tlet awardArr = Encrypt.JsonDecode(dataList.awards);\n\t\t//先判断是否带附件\n\t\tif (!Utils.table_isEmpty(awardArr)) {\n\t\t\tthis.hasMailContent.string = dataList.body;\n\t\t\tthis.hasMailLayout.active = true;\n\t\t\tshow_layout = this.hasMailLayout;\n\t\t\tfor (let i = 0; i < awardArr.length; i++) {\n\t\t\t\tlet v = awardArr[i];\n\t\t\t\tlet node = instantiate(this.itemNode);\n\t\t\t\tthis.itemLayer.addChild(node);\n\t\t\t\tlet numLabel = node.getComponentInChildren(Label);\n\t\t\t\tlet img_item = node.getChildByName(\"img_item\");\n\t\t\t\tnumLabel.string = String(v.num);\n\t\t\t\tif (dataList.status == GConstants.MsgStatus.MSG_STATUS_HANDLED) {\n\t\t\t\t\t//已领取\n\t\t\t\t\tnode.getComponent(Sprite).grayscale = true;  //领取状态 道具置灰\n\t\t\t\t\timg_item.getComponent(Sprite).grayscale = true;\n\t\t\t\t}\n\t\t\t\tlet propType = Utils.number_valueOf(v['type'],0);\n\t\t\t\tlet conf = GCache.PropsConf.getPropsInfoById(propType);\n\t\t\t\tlet url = conf['url'];\n\t\t\t\tthis.setSpriteFrame(img_item, url);\n\t\t\t}\n\t\t\tif (dataList.status == GConstants.MsgStatus.MSG_STATUS_HANDLED) {\n\t\t\t\tthis.setMailBtn();\n\t\t\t} else {\n\t\t\t\tthis.setMailBtn(0);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.noMailContent.string = dataList.body;\n\t\t\tthis.noMailLayout.active = true;\n\t\t\tshow_layout = this.noMailLayout;\n\t\t\tthis.setMailBtn();\n\t\t}\n\t\tlet senderLabel = show_layout.getChildByName(\"label_sender\");\n\t\tlet timeLabel = show_layout.getChildByName(\"label_time\");\n\t\tsenderLabel.active = false;\n\t\ttimeLabel.active = false;\n\t\tthis.mailLayout.active = true;\n\t}\n\n\n\n\t/**\n\t * 更新界面\n\t * @param event \n\t * @param pData \n\t */\n\tupdateView(event = null, pData = null) {\n\t\tthis.initData();\n\t\tthis.addSchedulerOnce(1, () => { \n\t\t\tconsole.log(\"mail request\")\n\t\t\tthis.initView();\n\t\t})\n\t}\n\n\t//点击邮件\n\tonMailClick(event) {\n\t\tfor (let child of this.mailLayer.children) {\n\t\t\tchild.getChildByName(\"img_selected\").active = false;\n\t\t}\n\t\tlet node = event.target;\n\t\tnode.getChildByName(\"img_selected\").active = true;\n\n\t\tlet img_new = node.getChildByName(\"img_new\");\n\t\timg_new.active = false;\n\n\t\tlet img_gift = node.getChildByName(\"img_gift\");\n\t\tlet currentData = node[\"mailData\"];\n\t\t//文字点击即算opened ,奖励要领取才算\n\t\tconsole.log(\"点击邮件:\", currentData)\n\t\tif (currentData.status == GConstants.MsgStatus.MSG_STATUS_FRESH) {\n\t\t\tcurrentData.status = GConstants.MsgStatus.MSG_STATUS_READ\n\t\t\tGCache.MailInfo.updateMailDataInCache(currentData)\n\t\t\tlet awardArr = Encrypt.JsonDecode(currentData.awards);\n\t\t\tif (Utils.table_isEmpty(awardArr)) {\n\t\t\t\timg_gift.getComponent(Sprite).spriteFrame = this.mailAtlas.spriteFrames[\"mail/Read\"];\n\t\t\t}\n\t\t}\n\t\t// 记录一下当前展示内容的下标\n\t\tthis.curentIndex = node[\"index\"]\n\t\tthis.updateCurrentData()\n\t\tthis.initRightView(currentData);\n\t}\n\n\n\t/**\n\t * 刷新当前选中邮件数据\n\t */\n\tupdateCurrentData() {\n\t\tlet index = Number(this.curentIndex);\n\t\tlet len = this.mailLayer.children.length;\n\t\tfor (let i = 0; i < len; i++) {\n\t\t\tlet node = this.mailLayer.children[index];\n\t\t\tif (index == i) {\n\t\t\t\tthis.currentItem = node;\n\t\t\t}\n\t\t}\n\t\tthis.currentData = this.mailData[this.curentIndex];\n\t}\n\n\n\t/**\n\t * 设置远端图片\n\t * @param node 节点\n\t * @param path 图片地址\n\t */\n\tsetSpriteFrame(node, path) {\n\t\tif (Utils.string_isHttp(path)) {\n\t\t\tlet self = this;\n\t\t\tresLoader.loadRemote(path, { ext: '.jpg' }, (err, imageAsset) => {\n\t\t\t\tif (!imageAsset) { //资源可能还在加载中\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tif (!self.node || self.node.isValid == false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet spriteFrame = Utils.image_ImageAssetToSpriteFrame(imageAsset)\n\t\t\t\tif (spriteFrame) {\n\t\t\t\t\tnode.getComponent(Sprite).spriteFrame = spriteFrame;\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n\t/**\n\t * 设置按钮状态\n\t * index：0（领取）1（删除） null(不显示)\n\t * */\n\tsetMailBtn(index = null) {\n\t\tif (index == null) {\n\t\t\tthis.btnLayer.active = false;\n\t\t\treturn;\n\t\t}\n\t\tthis.btnLayer.active = true;\n\t\tfor (let i = 0; i < this.btnLayer.children.length; i++) {\n\t\t\tlet child = this.btnLayer.children[i]\n\t\t\tif (i == index) {\n\t\t\t\tchild.active = true;\n\t\t\t} else {\n\t\t\t\tchild.active = false;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 领取道具\n\t * @param event \n\t */\n\tonReceiveClick(event: Event) {\n\t\tconsole.log(\"领取道具\", this.currentData)\n\t\tlet awardArr = Encrypt.JsonDecode(this.currentData.awards);\n\t\tif (this.currentData && !Utils.table_isEmpty(awardArr)) {\n\t\t\tif (this.currentData.status == GConstants.MsgStatus.MSG_STATUS_HANDLED) {\n\t\t\t\t//如果已经领取\n\t\t\t\tEventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: GameTxt.item_has_receive });\n\t\t\t\tthis.currentItem.getComponent(Sprite).grayscale = true;  //领取状态 道具置灰\n\t\t\t\tlet img_item = this.currentItem.getChildByName(\"img_item\");\n\t\t\t\timg_item.getComponent(Sprite).grayscale = true;\n\t\t\t\tthis.setMailBtn();\n\t\t\t} else {\n\t\t\t\tconsole.log(\"发起领取邮件奖励请求\", this.currentData, this.currentData.id);\n\t\t\t\tEventManager.dispatch(AppEvent.NET_REQ_EMAIL_REWARD, this.currentData.id);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 领奖返回\n\t * @param event\n\t * @param isSuccess 是否成功 \n\t * @param respData 响应数据\n\t * @param reqData 请求数据\n\t * @returns \n\t */\n\trespGetAward(event, isSuccess, respData, reqData) {\n\t\tif (isSuccess != true) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.currentItem && this.currentItem.getChildByName(\"img_gift\")) {\n\t\t\tthis.currentItem.getChildByName(\"img_gift\").getComponent(Sprite).spriteFrame = this.mailAtlas.spriteFrames[\"mail/gift_open\"];\n\t\t}\n\t\tthis.initRightView(this.currentData);\n\t}\n\n\t/**\n\t * 关闭\n\t * @param event \n\t */\n\tonCloseClick(event: EventTouch) {\n\t\tthis.node.destroy();\n\t}\n\n\t//销毁\n\tonDestroy() {\n\n\t};\n\t\n\t/**\n\t * 红点更新\n\t * @param event \n\t * @param keyType 红点类型\n\t */\n\tredDotUpdate(event, keyType) {\n\t\tif (keyType == GConstants.RedDotConf.Email) {\n\t\t\tthis.updateView(null,null);\n\t\t}\n\t}\n\n}\n\n"]}