{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/proj/GlobalController.ts"],"names":["_GlobalController","director","GCache","AppEvent","APPState","GConstants","GameRes","GameTxt","UIConfigData","UIID","Encrypt","LayerManager","resLoader","Logger","AudioManager","EventManager","PkgLoaderManager","ResLoaderManager","SpineAniManager","Network","NetworkState","Utils","BaseControll","Platform","ActivityController","GameController","GCmdMapping","GlobalCMD","GlobalCMDHead","GlobalHeadCmdBinding","GPBWriteAndRead","GSocket","HallController","LoginController","OrderRecode","ReportController","GoodsDataServers","MessageServers","PopupServers","RecommendPopServers","ReportServers","SelectGameServers","ShareServers","TaskServers","UserServers","instance","_instance","constructor","name","countChangeScene","_cycleLifeQuene","_handlerNetOutTime","init","onInitModuleEvent","addModelListener","SYS_APP_LIFE","appLifeChange","SYS_SHOW_OR_HIDE","processApplicationActions","SYS_NET_CHANGE_STATE","networkChange","NET_START_CONNECT","startGSConnect","NET_HEART_BEAT_ONLOADING","heartbeatOnLoading","NET_SEND_MSG","sendSocketMsg","VIEW_SCENE_TO_CHANGE","changeScene","SYS_UPDATE_PROTOBUF","updatePBConf","SYS_UPDATE_CMDMAPPING","updateCmdMapping","SYS_PACKAGE_LOAD_TASK_CANCLE","receiveCanclePkgLoadTask","SYS_UPDATE_HEART_TIME","updateHeartTime","NET_RECEIVE_MSG_PHPNEW","receiveNetPhpMsg","NET_RECEIVE_PHP_PUSH_MSG","receivePhpPushMsg","NET_RECEIVE_PHP_PUSH_PAY_MONEY","receivePhpPushPayMoney","event","param","print","AppRunLife","MainScence","firstRunLoading","open","RunScence","addScheduler","handler","onSchedulerUpdate","Login_Will_Open","Login_Closed","startRun","push","state","SHOW","firstRunLoadSuccess","getInstance","resumeAll","getEnterOptionsSync","HIDE","pauseAll","OFFLINE","dispatch","SYS_TOAST_TIP","content","netWorkDisconnected","urlOption","ONLINE","netWorkErrorTips","SYS_CLOSE_NETLOADING","isConnected","SYS_SHOW_NETLOADING","startConnect","cmd","sendMsg","body","timeout","next","load","Prefab_Login","bundle","path","preloadScene","error","sceneAsset","clear","loadScene","scene","GlobalController","success","call","fail","type","arrayList","Read","updateCmdArrayFunc","Write","cmdBindingList","table_isEmpty","initCommonMapping","table_verify","pushHeadMapping","time","setHeartTime","checkReceiveQueve","respData","reqData","reqSSID","ssid","errorInfo","generateErrorInfo","eventBindindCmd","PHP_CMD_CONSTANT","p_ISSuccess","p_RespData","p_ReqParam","errorTips","PHP_KEEPALIVE","stopKeepAliveTimeOuter","logModel","number_formatToHex","getActionByCmd","eventID","getEventIDByCmd","logNet","packetInfo","errorArray","errorType","extraInfo","status","isNull","isArray","isObject","networkReqError","msg","toString","majorType","substring","minorType","string_isEmpty","info","result","mtype","str","dump","field","number_valueOf","value","User","updateUserMoneyByID","NET_CMD_REQ_WATCH","txt_desc","alignLeftTop","notshowClose","buttonsMap","VIEW_UI_OPEN","PopWindow","notice_msg","notice_type","detailData","JsonDecode","data","detailPaySuccess","detailBuyGiftSuccess","awardData","prop","clone","GoodsType","SILVER_COIN","propInfo","PropsConf","getPropsInfoById","oneData","icon","num","DIAMOND","Desk","mySelfPlayer","moneyID","MoneyTypeID","money","getUserMoneyByID","updateInfo","payMoney","award_gold","award_diamond","award_props","privilege","bouns","key","Object","prototype","hasOwnProperty","isNaN","Number","desc","String","replace","string_moneyToShortNumber","newAdd","propID","console","log","length","GongXiHuoDePrefab","NET_REQ_PROPS_INFO","isNotNull","conf","tmp","obj","gname","taskID","PkgLoaderTaskList","Game","initCommonCmd","initUIConfig"],"mappings":"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","sourcesContent":["/**\n * Name = GlobalController\n * URL = db://assets/proj/GlobalController.ts\n * Time = Mon Apr 18 2022 11:04:41 GMT+0800 (中国标准时间)\n * Author = xueya\n *\n */\n\nimport { director, Scene, SceneAsset } from \"cc\";\nimport { GCache } from \"../cache/GCache\";\nimport { AppEvent } from \"../config/AppEvent\";\nimport { APPState } from \"../config/GameConfig\";\nimport { GConstants } from \"../config/GameConstant\";\nimport { GameRes } from \"../config/GameRes\";\nimport { GameTxt } from \"../config/GameTxt\";\nimport { UIConfigData, UIID } from \"../config/UIConfig\";\nimport { Encrypt } from \"../framework/crypto/Encrypto\";\nimport { inf_GetPropItem } from \"../framework/InterfaceDefines\";\nimport { LayerManager } from \"../framework/layer/LayerManager\";\nimport { resLoader } from \"../framework/loader/ResLoader\";\nimport { Logger } from \"../framework/log/Logger\";\nimport { AudioManager } from \"../framework/manager/AudioManager\";\nimport { EventManager } from \"../framework/manager/EventManager\";\nimport { PkgLoaderManager } from \"../framework/manager/PkgLoaderManager\";\nimport { ResLoaderManager } from \"../framework/manager/ResLoaderManager\";\nimport { SpineAniManager } from \"../framework/manager/SpineAniManager\";\nimport { INetMessage, INetPHPMessage } from \"../framework/network/NetInterface\";\nimport { Network, NetworkState } from \"../framework/network/NetState\";\nimport { Utils } from \"../framework/Utils\";\nimport { BaseControll } from \"../framework/vc/BaseController\";\nimport { Platform } from \"../platform/Platform\";\nimport { ActivityController } from \"./ActivityController\";\nimport { GameController } from \"./GameController\";\nimport { GCmdMapping } from \"./gnet/GCmdMapping\";\nimport { GlobalCMD, GlobalCMDHead, GlobalHeadCmdBinding } from \"./gnet/GlobalCMD\";\nimport { GPBWriteAndRead } from \"./gnet/GPBWriteAndRead\";\nimport { GSocket } from \"./gnet/GSocket\";\nimport { HallController } from \"./HallController\";\nimport { LoginController } from \"./LoginController\";\nimport { OrderRecode } from \"./PayAgent\";\nimport { ReportController } from \"./ReportController\";\nimport { GoodsDataServers } from \"./servers/GoodsDataServers\";\nimport { MessageServers } from \"./servers/MessageServers\";\nimport { PopupServers } from \"./servers/PopupServers\";\nimport { RecommendPopServers } from \"./servers/RecommendPopServers\";\nimport { ReportServers } from \"./servers/ReportServers\";\nimport { SelectGameServers } from \"./servers/SelectGameServers\";\nimport { ShareServers } from \"./servers/ShareServers\";\nimport { TaskServers } from \"./servers/TaskServer\";\nimport { UserServers } from \"./servers/UserServer\";\n\nclass _GlobalController extends BaseControll {\n    //切换场景次数\n    private countChangeScene: number = 0;\n    /** 生命周期队列 */\n    private _cycleLifeQuene: Array<any> = [];\n\n    private static _instance = null;\n    public static get instance(): _GlobalController {\n        if (!this._instance || this._instance == null) {\n            this._instance = new _GlobalController(\"GlobalController\");\n        }\n        return this._instance;\n    }\n    //重连超时句柄\n    _handlerNetOutTime = null;\n    //实例化\n    constructor(name: string) {\n        super(name)\n        PkgLoaderManager.init();\n    };\n    public init() {\n        /** 初始化数据上报控制器 */\n        ReportController.init();\n        /** 初始化音效控制器 */\n        AudioManager.init();\n        /** 初始化资源管理控制器 */\n        ResLoaderManager.init();\n        /** 初始化Spine管理控制器 */\n        SpineAniManager.init();\n\n        /** 初始化登录控制器 */\n        LoginController.init();\n        /** 初始化大厅控制器 */\n        HallController.init();\n        /** 初始化游戏场景控制器 */\n        GameController.init();\n        /** 初始化活动控制器 */\n        ActivityController.init();\n\n        /** 初始化弹窗控制器 */\n        PopupServers.init();\n        /**初始化分享 */\n        ShareServers.init();\n        /**初始化活动/任务中心 */\n        TaskServers.init()\n        /** 初始化物品控制器 */\n        GoodsDataServers.init();\n\n        /** 初始化信箱控制器 */\n        MessageServers.init();\n        /** 初始化用户控制器 */\n        UserServers.init()\n        /** 初始化游戏选场控制器 */\n        SelectGameServers.init()\n        /** 初始化数据上报控制器 */\n        ReportServers.init()\n        /** 初始化推荐弹窗控制器 */\n        RecommendPopServers.init()\n    }\n    /**初始化添加事件绑定 */\n    protected onInitModuleEvent(): void {\n        //程序生命周期\n        this.addModelListener(AppEvent.SYS_APP_LIFE, this.appLifeChange)\n        //前后台事件\n        this.addModelListener(AppEvent.SYS_SHOW_OR_HIDE, this.processApplicationActions)\n        //网络状态切换\n        this.addModelListener(AppEvent.SYS_NET_CHANGE_STATE, this.networkChange)\n        //开启聊天服\n        this.addModelListener(AppEvent.NET_START_CONNECT, this.startGSConnect)\n        //开启心跳\n        this.addModelListener(AppEvent.NET_HEART_BEAT_ONLOADING, this.heartbeatOnLoading)\n\n        //发送数据\n        this.addModelListener(AppEvent.NET_SEND_MSG, this.sendSocketMsg)\n\n        //切换场景\n        this.addModelListener(AppEvent.VIEW_SCENE_TO_CHANGE, this.changeScene)\n\n        //更新协议解析\n        this.addModelListener(AppEvent.SYS_UPDATE_PROTOBUF, this.updatePBConf)\n        //更新命令绑定映射\n        this.addModelListener(AppEvent.SYS_UPDATE_CMDMAPPING, this.updateCmdMapping)\n        //分包加载任务被中断\n        this.addModelListener(AppEvent.SYS_PACKAGE_LOAD_TASK_CANCLE, this.receiveCanclePkgLoadTask)\n        //更新心跳间隔\n        this.addModelListener(AppEvent.SYS_UPDATE_HEART_TIME, this.updateHeartTime)\n\n        //新大厅事件\n        this.addModelListener(AppEvent.NET_RECEIVE_MSG_PHPNEW, this.receiveNetPhpMsg)\n\n        //推送消息\n        this.addModelListener(AppEvent.NET_RECEIVE_PHP_PUSH_MSG, this.receivePhpPushMsg)\n\n        //广播支付银币\n        this.addModelListener(AppEvent.NET_RECEIVE_PHP_PUSH_PAY_MONEY, this.receivePhpPushPayMoney)\n\n    }\n    /** 程序的生命周期 */\n    appLifeChange(event: string, param) {\n        this.print(`*******【Sys cycle change to ${param}】*********`);\n        if (param == GConstants.AppRunLife.MainScence) {\n            GCache.firstRunLoading = true;\n            Logger.open();\n            GCache.init();\n            this._cycleLifeQuene = [];\n        } else if (param == GConstants.AppRunLife.RunScence) {\n            //全局控制器初始化附加载\n            this.init();\n            this.addScheduler(0.01, Utils.handler(this, this.onSchedulerUpdate))\n        } else if (param == GConstants.AppRunLife.Login_Will_Open) {\n            // GCache.User.initSubClass();\n            // GCache.reloadSubClass();\n        } else if (param == GConstants.AppRunLife.Login_Closed) {\n            OrderRecode.instance.startRun();\n        }\n        this._cycleLifeQuene.push(param);\n\n        this.print(\"当前生命周期队列\", this._cycleLifeQuene);\n    }\n    /**前后台事件 */\n    processApplicationActions(event: string, state: APPState) {\n        this.print(`[系统前后台事件]:${state == APPState.SHOW && \"前台\" || \"后台\"}`);\n        if (!GCache.firstRunLoadSuccess) {\n            return;\n        }\n        if (state == APPState.SHOW) {\n            AudioManager.getInstance().resumeAll();\n            Platform.getEnterOptionsSync();\n        } else if (state == APPState.HIDE) {\n            AudioManager.getInstance().pauseAll();\n        }\n    }\n    /** 网络状态改变 */\n    networkChange(event: string) {\n        if (Network.instance.state == NetworkState.OFFLINE) {\n            EventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: GameTxt.netWorkDisconnected })\n        }\n    }\n    /**开启网络连接 */\n    startGSConnect(event: string, urlOption: any) {\n        this.print(\"开启网络连接===>url= \" + urlOption, \"网络状态:\" + Network.instance.state)\n        if (Network.instance.state != NetworkState.ONLINE) {\n            EventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: GameTxt.netWorkErrorTips })\n            EventManager.dispatch(AppEvent.SYS_CLOSE_NETLOADING);\n            return;\n        }\n        this.print(\"输出网络连接状态:\", GSocket.instance.isConnected())\n        if (GSocket.instance.isConnected() == false) {\n            EventManager.dispatch(AppEvent.SYS_SHOW_NETLOADING);\n        }\n        GSocket.instance.startConnect(urlOption)\n    }\n    /** 心跳 */\n    heartbeatOnLoading(event: string, state: boolean = false) {\n        GSocket.instance.heartbeatOnLoading(state)\n    }\n    /** 发送socket消息 */\n    sendSocketMsg(event: string, param: INetMessage) {\n        if (param && param.cmd) {\n            GSocket.instance.sendMsg(param.cmd, param.body, param.timeout)\n        }\n    }\n\n    /**切换场景 */\n    changeScene(event: string, param: any) {\n        this.print(`即将切换场景：>>>${param?.next}`)\n        if (this.countChangeScene < 1) {\n            //首次切换 预加载资源\n            resLoader.load(GameRes.Prefab_Login.bundle, GameRes.Prefab_Login.path)\n        }\n        if (param && param.next) {\n            director.preloadScene(param.next, (error: null | Error, sceneAsset?: SceneAsset) => {\n                if (!error) {\n                    LayerManager.clear()\n                    director.loadScene(param.next, (error: null | Error, scene?: Scene) => {\n                        if (scene) {\n                            GlobalController.countChangeScene = GlobalController.countChangeScene + 1\n                            if (param.success) {\n                                param.success.call(param.next)\n                            }\n                        }\n                    })\n                } else {\n                    Logger.error(error)\n                    if (param.fail) {\n                        param.fail.call(param.next)\n                    }\n                }\n            });\n        } else {\n            Logger.error(\"场景切换失败，param.next 不存在\")\n            if (param.fail) {\n                param.fail.call(param.next)\n            }\n        }\n    }\n\n    /** 协议解析更新  0读 1写*/\n    updatePBConf(event, type, arrayList) {\n        if (type == 0) {\n            GPBWriteAndRead.Read.updateCmdArrayFunc(arrayList)\n        } else if (type == 1) {\n            GPBWriteAndRead.Write.updateCmdArrayFunc(arrayList)\n        }\n    }\n    /** 更新命令绑定映射 */\n    updateCmdMapping(event, cmdBindingList) {\n        if (Utils.table_isEmpty(cmdBindingList)) {\n            GCmdMapping.initCommonMapping();\n            return;\n        }\n        cmdBindingList = Utils.table_verify(cmdBindingList)\n        GCmdMapping.pushHeadMapping(cmdBindingList)\n\n    }\n    /** 更新心跳间隔 */\n    updateHeartTime(event, time: number) {\n        GSocket.instance.setHeartTime(time)\n    }\n    /** 定时器的回调 */\n    onSchedulerUpdate() {\n        GSocket.instance.checkReceiveQueve()\n    }\n    /** 收到php端的消息 */\n    receiveNetPhpMsg(event: string, respData: INetPHPMessage, reqData) {\n        if (!respData.cmd || !respData.body) {\n            return\n        }\n        let reqSSID = null\n        //php请求参数\n        if (reqData) {\n            reqSSID = reqData.ssid\n        }\n        let errorInfo = this.generateErrorInfo(respData.body, reqSSID)\n        let eventBindindCmd = GlobalCMDHead.PHP_CMD_CONSTANT + respData.cmd\n\n        let p_ISSuccess = false\n        let p_RespData = errorInfo\n        let p_ReqParam = reqData\n        if (!errorInfo.errorTips && respData.body) {\n            p_ISSuccess = true\n            p_RespData = respData.body[\"info\"]\n        }\n        if (eventBindindCmd == GlobalCMD.PHP_KEEPALIVE) {\n            GSocket.instance.stopKeepAliveTimeOuter()\n        }\n        Logger.logModel(`[NetReceive] ：收到来自大厅的消息cmd = {[10进制] ${eventBindindCmd} [16进制] ${Utils.number_formatToHex(eventBindindCmd)}} action = ${GCmdMapping.getActionByCmd(eventBindindCmd)}`)\n        let eventID = GCmdMapping.getEventIDByCmd(eventBindindCmd)\n        if (eventID) {\n            EventManager.dispatch(eventID, p_ISSuccess, p_RespData, p_ReqParam)\n        } else {\n            Logger.logNet(`undifine ==>收到cmd = ${eventBindindCmd} 的消息 但是没有找到对应的事件绑定`)\n        }\n\n    }\n    /**\n     * 获取通用错误信息\n     * @param packetInfo 下发的数据包\n     * @param ssid 请求的ssid\n     */\n    generateErrorInfo(packetInfo, ssid) {\n        let errorArray = {\n            errorType: \"\",\n            errorTips: null,\n            extraInfo: {},\n        }\n\n        if (!packetInfo) {\n            return errorArray\n        }\n        let errorType = packetInfo.type\n        let errorTips = null;\n        let status = packetInfo.status;\n\n        if (Utils.isNull(errorType)) {\n            errorType = \"\"\n        }\n        if (Utils.isNull(status)) {\n            status = 1\n        }\n        if (Utils.isArray(packetInfo) == false && Utils.isObject(packetInfo) == false) {\n            errorTips = GameTxt.networkReqError\n        } else {\n            if (status == 1) {\n                errorTips = packetInfo.msg\n            }\n            if (errorTips == \"\") {\n                errorType = errorType.toString()\n                let majorType = errorType.substring(0, 0)\n                let minorType = errorType.substring(2, 2)\n\n                errorType = `phpError${majorType}_${minorType}`\n                errorTips = GameTxt[errorType] || GameTxt.networkReqError\n            }\n            if (errorType == 2 && Utils.string_isEmpty(ssid) == false) {//会话超时\n                //登录成功后会话超时 需要重新登录\n                this.print(\"会话超时 需要重新登录 还没做\")\n            }\n        }\n\n        errorArray = {\n            errorType: errorType,\n            errorTips: errorTips,\n            extraInfo: packetInfo.info || {},\n        }\n        return errorArray\n    }\n    /** receive：PHP推送消息 */\n    receivePhpPushMsg(event: string, respData) {\n        if (!respData.result) {\n            return\n        }\n        respData.result = Utils.table_verify(respData.result)\n        let mtype = respData.result[\"mtype\"];\n        this.print(\"PHP推送: 收到一条消息 mtype = \" + mtype)\n        let str = \"PHP推送:\"\n        let body = null;\n        switch (mtype) {\n            //1 和 17 是私信\n            case 1:  //此时是私信,兼容老四川\n\n                break;\n            case 2:  //此时是房间任务消息\n                body = respData.result[\"info\"];\n                this.dump(body, str + \"房间任务消息\")\n                break;\n            case 6:\n            case 10:\n            case 11:\n            case 12:\n                break;\n            case 13:\n                let field = Utils.number_valueOf(respData.result[\"info\"][\"field\"], null); //0:银币, 1:金条 2:兑换券\n                let value = Utils.number_valueOf(respData.result[\"info\"][\"value\"], null);\n                if (!Utils.isNull(field) && !Utils.isNull(value)) {\n                    if (field == 0 || field == 1 || field == 2) {\n                        GCache.User.updateUserMoneyByID(field, value);\n\n                    }\n                }\n                this.dump(body, str + \"刷新用户信息\");\n                break;\n            case 15:\n                break;\n            case 16:\n                body = respData.result[\"info\"];\n                this.dump(body, str + \"完成牌局任务\");\n                break;\n            case 17:\n                body = respData.result[\"info\"];\n                this.dump(body, str + \"收到私信\");\n                EventManager.dispatch(AppEvent.NET_CMD_REQ_WATCH);\n                break;\n            case 19:\n                this.dump(body, str + \"代理商注册成功\");\n                break;\n            case 20:\n                body = respData.result[\"info\"];\n                body[\"ip\"] = body[\"ip\"]\n                body[\"port\"] = body[\"port\"]\n                this.dump(body, str + \"立即切换大厅IP与端口\");\n                break;\n            case 21:\n                break;\n            case 27:\n                body = respData.result[\"info\"];\n                this.dump(body, str + \"推送银元场当前牌局数\");\n                break;\n            case 28:\n                this.dump(body, str + \"新物品箱 线下物品兑换推送\");\n                break;\n            case 29:\n                this.dump(body, str + \"物品箱 刷新物品箱数据 入口显示小红点消息体 \");\n                break;\n            case 30:\n                this.dump(body, str + \"物品箱 领奖记录入口显示小红点\");\n                break;\n            case 31:\n                body = respData.result[\"info\"];\n                body[\"agentphone\"] = body[\"agentphone\"]\n                this.dump(body, str + \"代理商电话\");\n                break;\n            case 32:\n                this.dump(body, str + \"推送银元场当前牌局数\");\n                break;\n            case 34:\n                this.dump(body, str + \"接收子游戏 | 子模块的推送信息\");\n                break;\n            case 36:\n                body = respData.result[\"info\"];\n                body[\"propsId\"] = body[\"propsId\"]\n                this.dump(body, str + \"装扮道具Id\");\n                break;\n            case 999:\n                body = respData.result[\"info\"];\n                this.dump(body, str + \"刷新服务器地址\");\n                break;\n            case 998:\n                body = respData.result[\"info\"];\n                let param = {\n                    txt_desc: body,         //正文内容\n                    alignLeftTop: true,\n                    notshowClose: true,\n                    buttonsMap: [{}],\n                }\n                EventManager.dispatch(AppEvent.VIEW_UI_OPEN, UIID.PopWindow, param)\n                this.dump(body, str + \"推送弹窗\");\n                break;\n            case 996:\n                body = respData.result[\"giftTip\"];\n                this.dump(body, str + \"礼包推送文案(用于已拥有的头像框，先弹购买成功，再弹折现成其他道具)\");\n                break;\n            case 997:\n                body = {\n                    notice_msg: respData.result[\"notice_msg\"],\n                    notice_type: respData.result[\"notice_type\"],\n                };\n                this.dump(body, str + \"强制实名弹窗\");\n                break;\n            case 1001:\n                this.dump(body, str + \"存钱罐集满了\");\n                break;\n            default:\n                this.print(str + \"未识别的推送数据 \");\n                break;\n        }\n    }\n    /** 广播支付银币 */\n    receivePhpPushPayMoney(event: string, respData) {\n        respData = Utils.table_verify(respData);\n        this.print(\"PHP推送: 广播支付银币\", respData)\n\n        let detailData = Encrypt.JsonDecode(respData.data);\n        this.print(\"PHP推送: 数据解析\", detailData)\n        switch (respData.type) {\n            case 0:   //老的支付广播接口\n\n                break;\n            case 1:   //购买金条\n\n                break;\n            case 3:   //购买VIP\n\n                break;\n            case 4:   //新的支付广播接口(特价礼包)\n                this.detailPaySuccess(detailData);\n                break;\n            case 6:   //首充购买推送\n\n                break;\n\n            case 7:   //保险箱购买\n\n                break;\n\n            case 8://充值礼包推送(首充)\n                this.detailBuyGiftSuccess(detailData);\n                break;\n            case 9://激活破产回馈\n                break;\n\n            case 10://存钱罐\n\n\n                break;\n\n\n            default:\n                break;\n        }\n    }\n    /** 处理支付成功 */\n    detailPaySuccess(detailData) {\n        this.print(\"处理支付成功====>\", detailData);\n        if (Utils.table_isEmpty(detailData)) {\n            return;\n        }\n        //获得的物品信息\n        let awardData: Array<inf_GetPropItem> = [];\n\n        if (Utils.number_valueOf(detailData[\"gold\"]) > 0) {\n            let prop = Utils.clone(GConstants.GoodsType.SILVER_COIN);\n            let propInfo = GCache.PropsConf.getPropsInfoById(prop[\"id\"]);\n            if (propInfo && propInfo[\"item_name\"]) {\n                let oneData: inf_GetPropItem = {\n                    icon: propInfo[\"url\"],\n                    name: propInfo[\"item_name\"],\n                    num: Utils.number_valueOf(detailData[\"gold\"]),\n                }\n                awardData.push(oneData)\n            }\n        }\n        if (Utils.number_valueOf(detailData[\"diamond\"]) > 0) {\n            let prop = Utils.clone(GConstants.GoodsType.DIAMOND);\n            let propInfo = GCache.PropsConf.getPropsInfoById(prop[\"id\"]);\n            if (propInfo && propInfo[\"item_name\"]) {\n                let oneData: inf_GetPropItem = {\n                    icon: propInfo[\"url\"],\n                    name: propInfo[\"item_name\"],\n                    num: Utils.number_valueOf(detailData[\"diamond\"]),\n                }\n                awardData.push(oneData)\n            }\n        }\n\n        if (GCache.Desk && GCache.Desk.mySelfPlayer) {\n            let moneyID = GCache.Desk.MoneyTypeID;\n            let money = GCache.User.getUserMoneyByID(moneyID);\n            GCache.Desk.mySelfPlayer.updateInfo({ \"money\": money });\n        }\n\n        let payMoney = Utils.number_valueOf(detailData[\"gold\"]); //获得银币\n\n        let award_gold = 0; //加赠得到的银币信息\n        let award_diamond = 0; //获得的兑换券新\n        let award_props = {}; //加赠信息\n\n        //合并加赠信息\n        let privilege = Utils.table_verify(detailData.privilege);\n        if (privilege[\"status\"] != null) {\n            award_gold = award_gold + Utils.number_valueOf(privilege[\"gold\"]);\n            award_diamond = award_diamond + Utils.number_valueOf(privilege[\"diamond\"]);\n            if (Utils.table_isEmpty(privilege[\"props\"]) == false) {\n                award_props = privilege[\"props\"];\n            }\n        }\n        let bouns = Utils.table_verify(detailData[\"bouns\"]);\n        award_gold = award_gold + Utils.number_valueOf(bouns[\"gold\"], 0);\n        award_diamond = award_diamond + Utils.number_valueOf(bouns[\"diamond\"], 0);\n        if (Utils.table_isEmpty(bouns[\"props\"]) == false) {\n            for (let key in bouns[\"props\"]) {\n                if (Object.prototype.hasOwnProperty.call(bouns[\"props\"], key)) {\n                    if (isNaN(Number(key)) == false) {\n                        award_props[Number(key)] = bouns[\"props\"][key];\n                    } else {\n                        award_props[key] = bouns[\"props\"][key];\n                    }\n\n                }\n            }\n        }\n        let desc = String(\"成功购买*银币\").replace(\"*\", Utils.string_moneyToShortNumber(payMoney));\n        //加赠银币\n        if (award_gold > 0) {\n            desc = desc + String(\",加赠*银币\").replace(\"*\", String(award_gold));\n\n            let prop = Utils.clone(GConstants.GoodsType.SILVER_COIN);\n            let propInfo = GCache.PropsConf.getPropsInfoById(prop[\"id\"]);\n            if (propInfo && propInfo[\"item_name\"]) {\n                let oneData: inf_GetPropItem = {\n                    icon: propInfo[\"url\"],\n                    name: propInfo[\"item_name\"],\n                    num: award_gold,\n                    newAdd: true,\n                }\n                awardData.push(oneData)\n            }\n        }\n        //加赠兑换券\n        if (award_diamond > 0) {\n            desc = desc + String(\",加赠*兑换券\").replace(\"*\", String(award_diamond));\n            let prop = Utils.clone(GConstants.GoodsType.DIAMOND);\n            let propInfo = GCache.PropsConf.getPropsInfoById(prop[\"id\"]);\n            if (propInfo && propInfo[\"item_name\"]) {\n                let oneData: inf_GetPropItem = {\n                    icon: propInfo[\"url\"],\n                    name: propInfo[\"item_name\"],\n                    num: award_diamond,\n                    newAdd: true,\n                }\n                awardData.push(oneData)\n            }\n        }\n        //加赠道具\n        for (let propID in award_props) {\n            if (Object.prototype.hasOwnProperty.call(award_props, propID)) {\n                let num = award_props[propID];\n                let propInfo = GCache.PropsConf.getPropsInfoById(propID);\n                if (propInfo && propInfo[\"item_name\"]) {\n                    desc = desc + \",加赠\" + propInfo[\"item_name\"] + \"x\" + num;\n                    let oneData: inf_GetPropItem = {\n                        icon: propInfo[\"url\"],\n                        name: propInfo[\"item_name\"],\n                        num: num,\n                        newAdd: true\n                    }\n                    awardData.push(oneData);\n                }\n            }\n        }\n        console.log(\"支付成功，描述文本:\" + desc);\n        console.log(\"支付成功，获得的物品:\" + awardData)\n        if (awardData.length > 0) {\n            console.log(\"显示恭喜获得===>\", awardData);\n            //通知:恭喜获得\n            EventManager.dispatch(AppEvent.VIEW_UI_OPEN, UIID.GongXiHuoDePrefab, awardData)\n        }\n        //请求更新道具 待定\n        EventManager.dispatch(AppEvent.NET_REQ_PROPS_INFO);\n        //更新本地资产\n        if (Utils.isNotNull(detailData[\"cur_money\"])) {\n            let value = 0;\n            value = Utils.number_valueOf(detailData[\"cur_money\"]);\n            GCache.User.updateUserMoneyByID(0, value);\n        }\n    }\n    //处理礼包支付成功 type = 8\n    detailBuyGiftSuccess(detailData) { \n        this.print(\"detailBuyGiftSuccess 处理支付成功====>\", detailData);\n        if (Utils.table_isEmpty(detailData)) {\n            return;\n        }\n        //获得的物品信息\n        let awardData = [];\n        if (Utils.isNotNull(detailData[\"buy\"])) {\n            for (let key in detailData[\"buy\"]) {\n                if (Object.prototype.hasOwnProperty.call(detailData[\"buy\"], key)) {\n                    let num = Utils.number_valueOf(detailData[\"buy\"][key]);\n                  \n                    if (num > 0) { \n                        let conf = GCache.PropsConf.getPropsInfoById(key);\n                        let icon = detailData[\"gicons\"][key];\n                        if (Utils.string_isEmpty(icon)) { \n                            icon = conf[\"url\"];\n                        }\n                        let tmp:inf_GetPropItem = {\n                            num: num,\n                            icon: icon,\n                            name: conf['item_name'],\n                            newAdd: false,\n                        }\n                        awardData.push(tmp);\n                    }\n                    \n                }\n            }\n        }\n        \n        if (Utils.isNotNull(detailData[\"extra\"])) {\n            for (let key in detailData[\"extra\"]) {\n                if (Object.prototype.hasOwnProperty.call(detailData[\"extra\"], key)) {\n                    let obj = detailData[\"extra\"][key];\n                    let gname = obj['gname'];\n                    let num = Utils.number_valueOf(obj['gnum']);\n                    let icon = obj['gicon'];\n                    if (num > 0) {\n                        let tmp:inf_GetPropItem = {\n                            name:gname,\n                            num: num,\n                            icon: icon,\n                            newAdd: true,\n                        }\n                        awardData.push(tmp);\n                    }                   \n                    \n                }\n            }\n        }\n        //恭喜获得\n        if (awardData.length > 0) {\n            console.log(\"显示恭喜获得===>\", awardData);\n            //通知:恭喜获得\n            EventManager.dispatch(AppEvent.VIEW_UI_OPEN, UIID.GongXiHuoDePrefab, awardData)\n        }\n        EventManager.dispatch(AppEvent.NET_REQ_PROPS_INFO);\n        //更新本地资产\n        if (Utils.isNotNull(detailData[\"total_property\"])) {\n            for (let key in detailData[\"total_property\"]) {\n                if (Object.prototype.hasOwnProperty.call(detailData[\"total_property\"], key)) {\n                    let value = Utils.number_valueOf(detailData[\"total_property\"][key]);\n                    GCache.User.updateUserMoneyByID(Number(key), value);\n                }\n            }\n        }\n    }\n    // function GlobalSocketMessageHandler:_paySucc(detailInfo,func)\n    // \tlocal payMoney = tonumber(detailInfo.gold) or 0; --支付银币\n    // \tlocal cur_money = tonumber(detailInfo.cur_money) or kUserInfoData:getMoney();\n    // \tlocal cur_diamond = tonumber(detailInfo.diamond) or kUserInfoData:getDiamond();\n    // \tkUserInfoData:setMoney(cur_money);\n    // \tkUserInfoData:setDiamond(cur_diamond);\n\n    // \tlocal award_gold = 0; -- 获得的银币信息\n    // \tlocal award_diamond = 0; -- 获得的兑换券新\n    // \tlocal award_props = {}; -- 加赠信息\n\n    // \t-- 合并加赠信息\n    // \tlocal privilege = table.verify(detailInfo.privilege);\n    // \tif privilege.status then\n    // \t\taward_gold = award_gold + number.valueOf(privilege.gold, 0);\n    // \t\taward_diamond = award_diamond + number.valueOf(privilege.diamond, 0);\n    // \t\taward_props = CombineTables(award_props, table.verify(privilege.props) );\n    // \tend\n\n    // \tlocal bouns = table.verify(detailInfo.bouns);\n    // \taward_gold = award_gold + number.valueOf(bouns.gold, 0);\n    // \taward_diamond = award_diamond + number.valueOf(bouns.diamond, 0);\n    // \taward_props = CombineTables(award_props, table.verify(bouns.props) );\n\n    // \tlocal desc = string.format(\"成功购买%s银币\", ToolKit.skipMoneyEx2(payMoney) );\n    // \tif award_gold > 0 then\n    // \t\tdesc = desc .. string.format(\",加赠%s银币\", award_gold);\n    // \tend\n\n    // \tif award_diamond > 0 then\n    // \t\tdesc = desc .. string.format(\",加赠%s兑换券\", award_diamond);\n    // \tend\n\n    // \tfor propClassifyId, num in pairs(award_props) do\n    // \t\tlocal propInfo = RechargeDataInterface.getInstance():getGoodInfoByTypeId(propClassifyId);\n    // \t\tif propInfo and propInfo.item_name then\n    // \t\t\tdesc = desc .. \",加赠\".. propInfo.item_name ..\"x\" ..num;\n    // \t\tend\n    // \tend\n\n    // \tlocal data = {};\n    // \tdata.title = detailInfo.pay_succ_tips;         --标题提示信息\n    // \tdata.rightTitle = \"内容说明\";\n    // \tdata.topTips = desc;                             --提示信息\n    // \tdata.rightContent = detailInfo.pay_succ_explain;\n    // \tdata.adUrl = detailInfo.pay_succ_pic;\n    // \tdata.jumpcode = detailInfo.pay_succ_jumpcode;\n    // \tdata.btnText = detailInfo.btn_text;\n    // \tif MessageBox.isShowDirect() then\n    // \t\tRechargeSucPop.show(data);\n    // \tend\n    // \tif func then\n    // \t\tfunc()\n    // \tend\n    // end\n    /** 取消了分包加载任务 */\n    receiveCanclePkgLoadTask(event, taskID) {\n        if (taskID == GConstants.PkgLoaderTaskList.Game) {\n            this.print(\"游戏分包任务加载取消了 重置cmd绑定命令和pb协议解析\");\n            //初始化绑定绑定映射\n            EventManager.dispatch(AppEvent.SYS_UPDATE_CMDMAPPING);\n            GPBWriteAndRead.Write.initCommonCmd(GlobalHeadCmdBinding, true);\n            GPBWriteAndRead.Read.initCommonCmd(GlobalHeadCmdBinding, true);\n            //初始化UI配置\n            LayerManager.initUIConfig(UIConfigData);\n        }\n    }\n}\nexport const GlobalController = _GlobalController.instance\n\n"]}