{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/scripts/GameChatPrefabCtr.ts"],"names":["Button","Color","LabelComponent","Node","Sprite","SpriteAtlas","_decorator","instantiate","Utils","resLoader","EventManager","BaseComponent","FXJConstant","FXJEvent","FXJRes","FXJSound","ccclass","property","menu","GameChatPrefabCtr","tooltip","type","onInitModuleEvent","onLoad","hideMaskNode","updateView","changeTag","tabMsg","maskNode","node","parent","getChildByName","active","start","chooseNode","getComponent","interactable","tabEmoji","msgList","emojiList","nodeMsg","nodeEmoji","updateMessageList","updateEmoList","chatTextData","hotTxtConfig","ChatText","hot","i","length","data","tag","index","String","text","push","classicTxtConfig","classic","currowDaysNum","msgContent","children","addChild","removeFromParent","updateMsgItem","item","isEndIndx","buttonComp","txtLabel","tab_line","frameName","string_format","Atlas_Game_Desk","plistKey","load","bundle","path","err","atlas","isValid","spriteFrame","getSpriteFrame","spriteComponent","sizeMode","fontColor","tag_role","tag_hot","tag_classic","labelComponent","string","color","emojiDataList","key","resConf","console","log","emojiContent","updateEmojiItem","onClickTabMenu","event","dispatch","SYS_PLAY_EFFECT","CommClick","currentTarget","onMsgClick","param","GAME_REQ_PLAYER_CHAET_MSG","destroy","onEmojiClick","GAME_REQ_PLAYER_CHAET_EMOJI","onCloseClick","onDestroy"],"mappings":"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","sourcesContent":["\nimport { Button, Color, EventTouch, LabelComponent, Node, Sprite, SpriteAtlas, _decorator, instantiate } from 'cc';\nimport { Utils } from '../../../framework/Utils';\nimport { resLoader } from '../../../framework/loader/ResLoader';\nimport { EventManager } from '../../../framework/manager/EventManager';\nimport { BaseComponent } from '../../../framework/vc/BaseComponent';\nimport { FXJConstant } from '../common/FXJConstant';\nimport { FXJEvent } from '../common/FXJEvent';\nimport { FXJRes } from '../common/FXJRes';\nimport { FXJSound } from '../common/FXJSound';\nconst { ccclass, property, menu } = _decorator;\n\n/**\n * Name = GameChatPrefabCtr\n * URL = db://assets/package/game/scripts/GameChatPrefabCtr.ts\n * Time = Fri Sep 09 2022 11:52:39 GMT+0800 (中国标准时间)\n * Author = Tomoe\n * 游戏聊天界面\n * Life: onLoad-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n */\n\n@ccclass('GameChatPrefabCtr')\n//方便编辑器识别的菜单项目\n@menu('prefab/game/GameChatPrefabCtr')\nexport class GameChatPrefabCtr extends BaseComponent {\n\n\t//标签-常用语\n\t@property({ tooltip: \"标签-常用语\", type: Node })\n\tprivate tabMsg: Node | null = null;\n\t//标签-表情\n\t@property({ tooltip: \"标签-表情\", type: Node })\n\tprivate tabEmoji: Node | null = null;\n\t//常用语列表\n\t@property({ tooltip: \"常用语列表\", type: Node })\n\tprivate msgList: Node | null = null;\n\n\t//表情列表\n\t@property({ tooltip: \"表情列表\", type: Node })\n\tprivate emojiList: Node | null = null;\n\n\t//常用语父节点\n\t@property({ tooltip: \"常用语父节点\", type: Node })\n\tprivate msgContent: Node | null = null;\n\n\t//表情父节点\n\t@property({ tooltip: \"表情父节点\", type: Node })\n\tprivate emojiContent: Node | null = null;\n\n\t//常用语节点\n\t@property({ tooltip: \"常用语节点\", type: Node })\n\tprivate nodeMsg: Node | null = null;\n\n\t//表情节点\n\t@property({ tooltip: \"表情节点\", type: Node })\n\tprivate nodeEmoji: Node | null = null;\n\n\tonInitModuleEvent() {\n\t\t\n\t}\n\tonLoad() {\n\t\tthis.hideMaskNode();\n\t\tthis.updateView();\n\t\tthis.changeTag(this.tabMsg);\n\t};\n\n\t/** 隐藏遮罩层 */\n\thideMaskNode() {\n\t\tlet maskNode = this.node.parent.getChildByName(\"Mask\");\n\t\tif (maskNode) {\n\t\t\tmaskNode.active = false;\n\t\t}\n\t}\n\tstart() {\n\n\t};\n\n\n\t/** 标签切换 */\n\tchangeTag(chooseNode: Node) {\n\t\tchooseNode.getComponent(Button).interactable = false;\n\t\tchooseNode.getChildByName(\"Checkmark\").active = true;\n\t\tif (chooseNode == this.tabMsg) {\n\t\t\tthis.tabEmoji.getComponent(Button).interactable = true;\n\t\t\tthis.tabEmoji.getChildByName(\"Checkmark\").active = false;\n\n\t\t\tthis.msgList.active = true;\n\t\t\tthis.emojiList.active = false;\n\t\t} else if (chooseNode == this.tabEmoji) {\n\t\t\tthis.tabMsg.getComponent(Button).interactable = true;\n\t\t\tthis.tabMsg.getChildByName(\"Checkmark\").active = false;\n\n\t\t\tthis.msgList.active = false;\n\t\t\tthis.emojiList.active = true;\n\t\t}\n\t}\n\tupdateView() {\n\t\tthis.nodeMsg.active = false;\n\t\tthis.nodeEmoji.active = false;\n\t\tthis.updateMessageList();\n\t\tthis.updateEmoList();\n\t}\n\t/** 更新消息列表 */\n\tupdateMessageList() {\n\t\tlet chatTextData = [];\n\t\t\n\t\t//热门聊天语\n\t\tlet hotTxtConfig = FXJConstant.ChatText.hot;\n\t\tfor (let i = 0; i < hotTxtConfig.length; i++) {\n\t\t\tlet data = {\n\t\t\t\ttag: \"tag_hot\",\n\t\t\t\tindex: String(i + 1),\n\t\t\t\ttext: hotTxtConfig[i],\n\t\t\t}\n\t\t\tif (i == 0) {\n\t\t\t\tdata[\"isTag\"] = true;\n\t\t\t}\n\t\t\tchatTextData.push(data);\n\t\t}\n\n\t\t//经典聊天语\n\t\tlet classicTxtConfig = FXJConstant.ChatText.classic;\n\t\tfor (let i = 0; i < classicTxtConfig.length; i++) {\n\t\t\tlet data = {\n\t\t\t\ttag: \"tag_classic\",\n\t\t\t\tindex: \"Classic_\" + String(i + 1),\n\t\t\t\ttext: classicTxtConfig[i],\n\t\t\t}\n\t\t\tif (i == 0) {\n\t\t\t\tdata[\"isTag\"] = true;\n\t\t\t}\n\t\t\tchatTextData.push(data);\n\t\t}\n\n\t\tlet currowDaysNum = this.msgContent.children.length;\n\t\tif (currowDaysNum < chatTextData.length) {\n\t\t\tfor (let i = currowDaysNum; i < chatTextData.length; i++) {\n\t\t\t\tlet node = instantiate(this.nodeMsg);\n\t\t\t\tthis.msgContent.addChild(node);\n\t\t\t}\n\t\t} else if (currowDaysNum > chatTextData.length) {\n\t\t\tfor (let i = (currowDaysNum - 1); i >= chatTextData.length; i--) {\n\t\t\t\tlet node = this.msgContent.children[i];\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.removeFromParent();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (let i = 0; i < this.msgContent.children.length; i++) {\n\t\t\tlet node = this.msgContent.children[i];\n\t\t\tthis.updateMsgItem(node, i, chatTextData[i], i == (chatTextData.length - 1));\n\t\t}\n\t}\n\t/** 更新单条消息 */\n\tupdateMsgItem(item: Node, index: number, data, isEndIndx: boolean = false) {\n\t\titem.active = true;\n\t\tlet buttonComp = item.getComponent(Button);\n\n\t\titem[\"chatMsg\"] = data;\n\n\t\tlet tag = item.getChildByName(\"tag\");\n\t\tlet txtLabel = item.getChildByName(\"Label\");\n\t\tlet tab_line = item.getChildByName(\"tab_line\");\n\n\t\ttab_line.active = (isEndIndx != true);\n\n\t\tif (data) {\n\t\t\tbuttonComp.interactable = true;\n\t\t\tif (data[\"isTag\"] && data[\"tag\"]) {\n\t\t\t\tlet frameName = Utils.string_format(FXJRes.Atlas_Game_Desk.plistKey, data[\"tag\"])\n\t\t\t\tresLoader.load(FXJRes.Atlas_Game_Desk.bundle, FXJRes.Atlas_Game_Desk.path, SpriteAtlas, (err: Error | null, atlas) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tif (!tag || tag.isValid == false) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tlet spriteFrame = atlas.getSpriteFrame(frameName)\n\t\t\t\t\tif (spriteFrame) {\n\t\t\t\t\t\tlet spriteComponent = tag.getComponent(Sprite);\n\t\t\t\t\t\tspriteComponent.sizeMode = 0;\n\t\t\t\t\t\tspriteComponent.spriteFrame = spriteFrame;\n\t\t\t\t\t\ttag.active = true;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\ttag.active = false;\n\t\t\t}\n\t\t\tif (data[\"text\"] != null) {\n\t\t\t\tlet fontColor = {\n\t\t\t\t\ttag_role: new Color(163, 138, 231),\n\t\t\t\t\ttag_hot: new Color(241, 110, 63),\n\t\t\t\t\ttag_classic: new Color(145, 81, 19),\n\t\t\t\t}\n\t\t\t\tlet labelComponent = txtLabel.getComponent(LabelComponent);\n\t\t\t\tlabelComponent.string = data[\"text\"] || \"\";\n\t\t\t\tif (fontColor[data[\"tag\"]]) {\n\t\t\t\t\tlabelComponent.color = fontColor[data[\"tag\"]];\n\t\t\t\t}\n\t\t\t\ttxtLabel.active = true;\n\t\t\t}\n\t\t} else {\n\t\t\ttag.active = false;\n\t\t\ttxtLabel.active = false;\n\t\t\tbuttonComp.interactable = false;\n\t\t}\n\t}\n\n\n\t/** 更新 */\n\tupdateEmoList() {\n\t\tlet emojiDataList = [];\n\t\tfor (let i = 0; i < 16; i++) {\n\t\t\tlet key = Utils.string_format(FXJRes.Atlas_Game_Desk.plistKey, \"emoji_default_\" + String(i + 1));\n\t\t\tlet resConf = {\n\t\t\t\tbundle: FXJRes.Atlas_Game_Desk.bundle,\n\t\t\t\tpath: FXJRes.Atlas_Game_Desk.path,\n\t\t\t\tplistKey: key\n\t\t\t}\n\t\t\temojiDataList.push(resConf);\n\t\t}\n\t\tconsole.log(\"emojiDataList==>\", emojiDataList)\n\t\tlet currowDaysNum = this.emojiContent.children.length;\n\t\tif (currowDaysNum < emojiDataList.length) {\n\t\t\tfor (let i = currowDaysNum; i < emojiDataList.length; i++) {\n\t\t\t\tlet node = instantiate(this.nodeEmoji);\n\t\t\t\tthis.emojiContent.addChild(node);\n\t\t\t}\n\t\t} else if (currowDaysNum > emojiDataList.length) {\n\t\t\tfor (let i = (currowDaysNum - 1); i >= emojiDataList.length; i--) {\n\t\t\t\tlet node = this.emojiContent.children[i];\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.removeFromParent();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (let i = 0; i < this.emojiContent.children.length; i++) {\n\t\t\tlet node = this.emojiContent.children[i];\n\t\t\tthis.updateEmojiItem(node, i, emojiDataList[i], i == (emojiDataList.length - 1));\n\t\t}\n\t}\n\t/** 更新单个表情 */\n\tupdateEmojiItem(item: Node, index: number, data, isEndIndx: boolean = false) {\n\t\tlet buttonComp = item.getComponent(Button);\n\n\t\titem[\"chatMsg\"] = String(index + 1);\n\n\t\tif (data) {\n\t\t\tbuttonComp.interactable = true;\n\t\t\tresLoader.load(data.bundle, data.path, SpriteAtlas, (err: Error | null, atlas) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tif (!item || item.isValid == false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet spriteFrame = atlas.getSpriteFrame(data.plistKey)\n\t\t\t\tif (spriteFrame) {\n\t\t\t\t\tlet spriteComponent = item.getComponent(Sprite);\n\t\t\t\t\tspriteComponent.sizeMode = 0;\n\t\t\t\t\tspriteComponent.spriteFrame = spriteFrame;\n\t\t\t\t\titem.active = true;\n\t\t\t\t}\n\t\t\t})\n\n\t\t} else {\n\t\t\tbuttonComp.interactable = false;\n\t\t}\n\n\t}\n\n\t/** tab标签的点击事件 */\n\tonClickTabMenu(event: EventTouch) {\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tthis.changeTag(event.currentTarget);\n\t}\n\n\t//点击发送快捷短语\n\tonMsgClick(event: EventTouch) {\n\t\tconsole.log(\"点击发送快捷短语\", event.currentTarget[\"chatMsg\"]);\n\t\tif (event.currentTarget[\"chatMsg\"] == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet param = event.currentTarget[\"chatMsg\"];\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tEventManager.dispatch(FXJEvent.GAME_REQ_PLAYER_CHAET_MSG, param[\"index\"], param[\"text\"])\n\t\tthis.node.destroy();\n\t}\n\n\t//点击发送表情\n\tonEmojiClick(event: EventTouch) {\n\t\tconsole.log(\"点击发送表情\", event.currentTarget[\"chatMsg\"]);\n\t\tif (event.currentTarget[\"chatMsg\"] == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet param = event.currentTarget[\"chatMsg\"];\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\n\t\tEventManager.dispatch(FXJEvent.GAME_REQ_PLAYER_CHAET_EMOJI, param)\n\n\t\tthis.node.destroy();\n\t}\n\n\t//点击关闭界面\n\tonCloseClick(event: Event) {\n\t\tconsole.log(\"点击事件响应===>>>>关闭界面\");\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tthis.node.destroy();\n\t}\n\n\t//销毁\n\tonDestroy() {\n\n\t};\n\n}\n\n"]}