{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/scripts/GameChatPrefabCtr.ts"],"names":["Button","Color","instantiate","LabelComponent","Node","Sprite","SpriteAtlas","_decorator","EventManager","Utils","BaseComponent","FXJConstant","FXJEvent","FXJRes","FXJSound","ccclass","property","menu","GameChatPrefabCtr","tooltip","type","onInitModuleEvent","onLoad","hideMaskNode","updateView","changeTag","tabMsg","maskNode","node","parent","getChildByName","active","start","chooseNode","getComponent","interactable","tabEmoji","msgList","emojiList","nodeMsg","nodeEmoji","updateMessageList","updateEmoList","chatTextData","hotTxtConfig","ChatText","hot","i","length","data","tag","index","String","text","push","classicTxtConfig","classic","majiangTxtConfig","majiang","currowDaysNum","msgContent","children","addChild","removeFromParent","updateMsgItem","item","isEndIndx","buttonComp","txtLabel","tab_line","frameName","string_format","Atlas_Game_Desk","plistKey","getPreLoaderRes","bundle","path","atlas","isValid","spriteFrame","getSpriteFrame","spriteComponent","sizeMode","fontColor","tag_role","tag_hot","tag_classic","labelComponent","string","color","emojiDataList","key","resConf","console","log","emojiContent","updateEmojiItem","onClickTabMenu","event","dispatch","SYS_PLAY_EFFECT","CommClick","currentTarget","onMsgClick","param","GAME_REQ_PLAYER_CHAET_MSG","destroy","onEmojiClick","GAME_REQ_PLAYER_CHAET_EMOJI","onCloseClick","onDestroy"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;AAAmBC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,c,OAAAA,c;AAAgBC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,U,OAAAA,U;;AACnFC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,K,iBAAAA,K;;AACAC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,M,iBAAAA,M;;AACAC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA,QAAX;AAAqBC,QAAAA;AAArB,O,GAA8BV,U;AAEpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;mCAKaW,iB,WAHZH,OAAO,CAAC,mBAAD,C,UAEPE,IAAI,CAAC,+BAAD,C,UAIHD,QAAQ,CAAC;AAAEG,QAAAA,OAAO,EAAE,QAAX;AAAqBC,QAAAA,IAAI,EAAEhB;AAA3B,OAAD,C,UAGRY,QAAQ,CAAC;AAAEG,QAAAA,OAAO,EAAE,OAAX;AAAoBC,QAAAA,IAAI,EAAEhB;AAA1B,OAAD,C,UAGRY,QAAQ,CAAC;AAAEG,QAAAA,OAAO,EAAE,OAAX;AAAoBC,QAAAA,IAAI,EAAEhB;AAA1B,OAAD,C,UAIRY,QAAQ,CAAC;AAAEG,QAAAA,OAAO,EAAE,MAAX;AAAmBC,QAAAA,IAAI,EAAEhB;AAAzB,OAAD,C,UAIRY,QAAQ,CAAC;AAAEG,QAAAA,OAAO,EAAE,QAAX;AAAqBC,QAAAA,IAAI,EAAEhB;AAA3B,OAAD,C,UAIRY,QAAQ,CAAC;AAAEG,QAAAA,OAAO,EAAE,OAAX;AAAoBC,QAAAA,IAAI,EAAEhB;AAA1B,OAAD,C,UAIRY,QAAQ,CAAC;AAAEG,QAAAA,OAAO,EAAE,OAAX;AAAoBC,QAAAA,IAAI,EAAEhB;AAA1B,OAAD,C,WAIRY,QAAQ,CAAC;AAAEG,QAAAA,OAAO,EAAE,MAAX;AAAmBC,QAAAA,IAAI,EAAEhB;AAAzB,OAAD,C,0CAhCV,MAGac,iBAHb;AAAA;AAAA,0CAGqD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAgCpDG,QAAAA,iBAAiB,GAAG,CAEnB;;AACDC,QAAAA,MAAM,GAAG;AACR,eAAKC,YAAL;AACA,eAAKC,UAAL;AACA,eAAKC,SAAL,CAAe,KAAKC,MAApB;AACA;;AAED;AACAH,QAAAA,YAAY,GAAG;AACd,cAAII,QAAQ,GAAG,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,cAAjB,CAAgC,MAAhC,CAAf;;AACA,cAAIH,QAAJ,EAAc;AACbA,YAAAA,QAAQ,CAACI,MAAT,GAAkB,KAAlB;AACA;AACD;;AACDC,QAAAA,KAAK,GAAG,CAEP;;AAGD;AACAP,QAAAA,SAAS,CAACQ,UAAD,EAAmB;AAC3BA,UAAAA,UAAU,CAACC,YAAX,CAAwBlC,MAAxB,EAAgCmC,YAAhC,GAA+C,KAA/C;AACAF,UAAAA,UAAU,CAACH,cAAX,CAA0B,WAA1B,EAAuCC,MAAvC,GAAgD,IAAhD;;AACA,cAAIE,UAAU,IAAI,KAAKP,MAAvB,EAA+B;AAC9B,iBAAKU,QAAL,CAAcF,YAAd,CAA2BlC,MAA3B,EAAmCmC,YAAnC,GAAkD,IAAlD;AACA,iBAAKC,QAAL,CAAcN,cAAd,CAA6B,WAA7B,EAA0CC,MAA1C,GAAmD,KAAnD;AAEA,iBAAKM,OAAL,CAAaN,MAAb,GAAsB,IAAtB;AACA,iBAAKO,SAAL,CAAeP,MAAf,GAAwB,KAAxB;AACA,WAND,MAMO,IAAIE,UAAU,IAAI,KAAKG,QAAvB,EAAiC;AACvC,iBAAKV,MAAL,CAAYQ,YAAZ,CAAyBlC,MAAzB,EAAiCmC,YAAjC,GAAgD,IAAhD;AACA,iBAAKT,MAAL,CAAYI,cAAZ,CAA2B,WAA3B,EAAwCC,MAAxC,GAAiD,KAAjD;AAEA,iBAAKM,OAAL,CAAaN,MAAb,GAAsB,KAAtB;AACA,iBAAKO,SAAL,CAAeP,MAAf,GAAwB,IAAxB;AACA;AACD;;AACDP,QAAAA,UAAU,GAAG;AACZ,eAAKe,OAAL,CAAaR,MAAb,GAAsB,KAAtB;AACA,eAAKS,SAAL,CAAeT,MAAf,GAAwB,KAAxB;AACA,eAAKU,iBAAL;AACA,eAAKC,aAAL;AACA;AACD;;;AACAD,QAAAA,iBAAiB,GAAG;AACnB,cAAIE,YAAY,GAAG,EAAnB,CADmB,CAGnB;;AACA,cAAIC,YAAY,GAAG;AAAA;AAAA,0CAAYC,QAAZ,CAAqBC,GAAxC;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,YAAY,CAACI,MAAjC,EAAyCD,CAAC,EAA1C,EAA8C;AAC7C,gBAAIE,IAAI,GAAG;AACVC,cAAAA,GAAG,EAAE,SADK;AAEVC,cAAAA,KAAK,EAAEC,MAAM,CAACL,CAAC,GAAG,CAAL,CAFH;AAGVM,cAAAA,IAAI,EAAET,YAAY,CAACG,CAAD;AAHR,aAAX;;AAKA,gBAAIA,CAAC,IAAI,CAAT,EAAY;AACXE,cAAAA,IAAI,CAAC,OAAD,CAAJ,GAAgB,IAAhB;AACA;;AACDN,YAAAA,YAAY,CAACW,IAAb,CAAkBL,IAAlB;AACA,WAfkB,CAiBnB;;;AACA,cAAIM,gBAAgB,GAAG;AAAA;AAAA,0CAAYV,QAAZ,CAAqBW,OAA5C;;AACA,eAAK,IAAIT,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGQ,gBAAgB,CAACP,MAArC,EAA6CD,CAAC,EAA9C,EAAkD;AACjD,gBAAIE,IAAI,GAAG;AACVC,cAAAA,GAAG,EAAE,aADK;AAEVC,cAAAA,KAAK,EAAE,aAAaC,MAAM,CAACL,CAAC,GAAG,CAAL,CAFhB;AAGVM,cAAAA,IAAI,EAAEE,gBAAgB,CAACR,CAAD;AAHZ,aAAX;;AAKA,gBAAIA,CAAC,IAAI,CAAT,EAAY;AACXE,cAAAA,IAAI,CAAC,OAAD,CAAJ,GAAgB,IAAhB;AACA;;AACDN,YAAAA,YAAY,CAACW,IAAb,CAAkBL,IAAlB;AACA,WA7BkB,CA+BnB;;;AACA,cAAIQ,gBAAgB,GAAG;AAAA;AAAA,0CAAYZ,QAAZ,CAAqBa,OAA5C;;AACA,eAAK,IAAIX,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGU,gBAAgB,CAACT,MAArC,EAA6CD,CAAC,EAA9C,EAAkD;AACjD,gBAAIE,IAAI,GAAG;AACVC,cAAAA,GAAG,EAAE,aADK;AAEVC,cAAAA,KAAK,EAAE,aAAaC,MAAM,CAACL,CAAC,GAAG,CAAL,CAFhB;AAGVM,cAAAA,IAAI,EAAEI,gBAAgB,CAACV,CAAD;AAHZ,aAAX;;AAKA,gBAAIA,CAAC,IAAI,CAAT,EAAY;AACXE,cAAAA,IAAI,CAAC,OAAD,CAAJ,GAAgB,IAAhB;AACA;;AACDN,YAAAA,YAAY,CAACW,IAAb,CAAkBL,IAAlB;AACA;;AAED,cAAIU,aAAa,GAAG,KAAKC,UAAL,CAAgBC,QAAhB,CAAyBb,MAA7C;;AACA,cAAIW,aAAa,GAAGhB,YAAY,CAACK,MAAjC,EAAyC;AACxC,iBAAK,IAAID,CAAC,GAAGY,aAAb,EAA4BZ,CAAC,GAAGJ,YAAY,CAACK,MAA7C,EAAqDD,CAAC,EAAtD,EAA0D;AACzD,kBAAInB,IAAI,GAAG1B,WAAW,CAAC,KAAKqC,OAAN,CAAtB;AACA,mBAAKqB,UAAL,CAAgBE,QAAhB,CAAyBlC,IAAzB;AACA;AACD,WALD,MAKO,IAAI+B,aAAa,GAAGhB,YAAY,CAACK,MAAjC,EAAyC;AAC/C,iBAAK,IAAID,CAAC,GAAIY,aAAa,GAAG,CAA9B,EAAkCZ,CAAC,IAAIJ,YAAY,CAACK,MAApD,EAA4DD,CAAC,EAA7D,EAAiE;AAChE,kBAAInB,IAAI,GAAG,KAAKgC,UAAL,CAAgBC,QAAhB,CAAyBd,CAAzB,CAAX;;AACA,kBAAInB,IAAJ,EAAU;AACTA,gBAAAA,IAAI,CAACmC,gBAAL;AACA;AACD;AACD;;AACD,eAAK,IAAIhB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKa,UAAL,CAAgBC,QAAhB,CAAyBb,MAA7C,EAAqDD,CAAC,EAAtD,EAA0D;AACzD,gBAAInB,IAAI,GAAG,KAAKgC,UAAL,CAAgBC,QAAhB,CAAyBd,CAAzB,CAAX;AACA,iBAAKiB,aAAL,CAAmBpC,IAAnB,EAAyBmB,CAAzB,EAA4BJ,YAAY,CAACI,CAAD,CAAxC,EAA6CA,CAAC,IAAKJ,YAAY,CAACK,MAAb,GAAsB,CAAzE;AACA;AACD;AACD;;;AACAgB,QAAAA,aAAa,CAACC,IAAD,EAAad,KAAb,EAA4BF,IAA5B,EAAkCiB,SAAkB,GAAG,KAAvD,EAA8D;AAC1ED,UAAAA,IAAI,CAAClC,MAAL,GAAc,IAAd;AACA,cAAIoC,UAAU,GAAGF,IAAI,CAAC/B,YAAL,CAAkBlC,MAAlB,CAAjB;AAEAiE,UAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkBhB,IAAlB;AAEA,cAAIC,GAAG,GAAGe,IAAI,CAACnC,cAAL,CAAoB,KAApB,CAAV;AACA,cAAIsC,QAAQ,GAAGH,IAAI,CAACnC,cAAL,CAAoB,OAApB,CAAf;AACA,cAAIuC,QAAQ,GAAGJ,IAAI,CAACnC,cAAL,CAAoB,UAApB,CAAf;AAEAuC,UAAAA,QAAQ,CAACtC,MAAT,GAAmBmC,SAAS,IAAI,IAAhC;;AAEA,cAAIjB,IAAJ,EAAU;AACTkB,YAAAA,UAAU,CAAChC,YAAX,GAA0B,IAA1B;;AACA,gBAAIc,IAAI,CAAC,OAAD,CAAJ,IAAiBA,IAAI,CAAC,KAAD,CAAzB,EAAkC;AACjC,kBAAIqB,SAAS,GAAG;AAAA;AAAA,kCAAMC,aAAN,CAAoB;AAAA;AAAA,oCAAOC,eAAP,CAAuBC,QAA3C,EAAqDxB,IAAI,CAAC,KAAD,CAAzD,CAAhB;AACA,mBAAKyB,eAAL,CAAqB;AAAA;AAAA,oCAAOF,eAAP,CAAuBG,MAA5C,EAAoD;AAAA;AAAA,oCAAOH,eAAP,CAAuBI,IAA3E,EAAiFtE,WAAjF,EAA+FuE,KAAD,IAAW;AACxG,oBAAI,CAACA,KAAL,EAAY;AACX;AACA;;AACD,oBAAI,CAAC3B,GAAD,IAAQA,GAAG,CAAC4B,OAAJ,IAAe,KAA3B,EAAkC;AACjC;AACA;;AACD,oBAAIC,WAAW,GAAGF,KAAK,CAACG,cAAN,CAAqBV,SAArB,CAAlB;;AACA,oBAAIS,WAAJ,EAAiB;AAChB,sBAAIE,eAAe,GAAG/B,GAAG,CAAChB,YAAJ,CAAiB7B,MAAjB,CAAtB;AACA4E,kBAAAA,eAAe,CAACC,QAAhB,GAA2B,CAA3B;AACAD,kBAAAA,eAAe,CAACF,WAAhB,GAA8BA,WAA9B;AACA7B,kBAAAA,GAAG,CAACnB,MAAJ,GAAa,IAAb;AACA;AACD,eAdD;AAeA,aAjBD,MAiBO;AACNmB,cAAAA,GAAG,CAACnB,MAAJ,GAAa,KAAb;AACA;;AACD,gBAAIkB,IAAI,CAAC,MAAD,CAAJ,IAAgB,IAApB,EAA0B;AACzB,kBAAIkC,SAAS,GAAG;AACfC,gBAAAA,QAAQ,EAAE,IAAInF,KAAJ,CAAU,GAAV,EAAe,GAAf,EAAoB,GAApB,CADK;AAEfoF,gBAAAA,OAAO,EAAE,IAAIpF,KAAJ,CAAU,GAAV,EAAe,GAAf,EAAoB,EAApB,CAFM;AAGfqF,gBAAAA,WAAW,EAAE,IAAIrF,KAAJ,CAAU,GAAV,EAAe,EAAf,EAAmB,EAAnB;AAHE,eAAhB;AAKA,kBAAIsF,cAAc,GAAGnB,QAAQ,CAAClC,YAAT,CAAsB/B,cAAtB,CAArB;AACAoF,cAAAA,cAAc,CAACC,MAAf,GAAwBvC,IAAI,CAAC,MAAD,CAAJ,IAAgB,EAAxC;;AACA,kBAAIkC,SAAS,CAAClC,IAAI,CAAC,KAAD,CAAL,CAAb,EAA4B;AAC3BsC,gBAAAA,cAAc,CAACE,KAAf,GAAuBN,SAAS,CAAClC,IAAI,CAAC,KAAD,CAAL,CAAhC;AACA;;AACDmB,cAAAA,QAAQ,CAACrC,MAAT,GAAkB,IAAlB;AACA;AACD,WAnCD,MAmCO;AACNmB,YAAAA,GAAG,CAACnB,MAAJ,GAAa,KAAb;AACAqC,YAAAA,QAAQ,CAACrC,MAAT,GAAkB,KAAlB;AACAoC,YAAAA,UAAU,CAAChC,YAAX,GAA0B,KAA1B;AACA;AACD;AAGD;;;AACAO,QAAAA,aAAa,GAAG;AACf,cAAIgD,aAAa,GAAG,EAApB;;AACA,eAAK,IAAI3C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AAC5B,gBAAI4C,GAAG,GAAG;AAAA;AAAA,gCAAMpB,aAAN,CAAoB;AAAA;AAAA,kCAAOC,eAAP,CAAuBC,QAA3C,EAAqD,mBAAmBrB,MAAM,CAACL,CAAC,GAAG,CAAL,CAA9E,CAAV;AACA,gBAAI6C,OAAO,GAAG;AACbjB,cAAAA,MAAM,EAAE;AAAA;AAAA,oCAAOH,eAAP,CAAuBG,MADlB;AAEbC,cAAAA,IAAI,EAAE;AAAA;AAAA,oCAAOJ,eAAP,CAAuBI,IAFhB;AAGbH,cAAAA,QAAQ,EAAEkB;AAHG,aAAd;AAKAD,YAAAA,aAAa,CAACpC,IAAd,CAAmBsC,OAAnB;AACA;;AACDC,UAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAAgCJ,aAAhC;AACA,cAAI/B,aAAa,GAAG,KAAKoC,YAAL,CAAkBlC,QAAlB,CAA2Bb,MAA/C;;AACA,cAAIW,aAAa,GAAG+B,aAAa,CAAC1C,MAAlC,EAA0C;AACzC,iBAAK,IAAID,CAAC,GAAGY,aAAb,EAA4BZ,CAAC,GAAG2C,aAAa,CAAC1C,MAA9C,EAAsDD,CAAC,EAAvD,EAA2D;AAC1D,kBAAInB,IAAI,GAAG1B,WAAW,CAAC,KAAKsC,SAAN,CAAtB;AACA,mBAAKuD,YAAL,CAAkBjC,QAAlB,CAA2BlC,IAA3B;AACA;AACD,WALD,MAKO,IAAI+B,aAAa,GAAG+B,aAAa,CAAC1C,MAAlC,EAA0C;AAChD,iBAAK,IAAID,CAAC,GAAIY,aAAa,GAAG,CAA9B,EAAkCZ,CAAC,IAAI2C,aAAa,CAAC1C,MAArD,EAA6DD,CAAC,EAA9D,EAAkE;AACjE,kBAAInB,IAAI,GAAG,KAAKmE,YAAL,CAAkBlC,QAAlB,CAA2Bd,CAA3B,CAAX;;AACA,kBAAInB,IAAJ,EAAU;AACTA,gBAAAA,IAAI,CAACmC,gBAAL;AACA;AACD;AACD;;AACD,eAAK,IAAIhB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKgD,YAAL,CAAkBlC,QAAlB,CAA2Bb,MAA/C,EAAuDD,CAAC,EAAxD,EAA4D;AAC3D,gBAAInB,IAAI,GAAG,KAAKmE,YAAL,CAAkBlC,QAAlB,CAA2Bd,CAA3B,CAAX;AACA,iBAAKiD,eAAL,CAAqBpE,IAArB,EAA2BmB,CAA3B,EAA8B2C,aAAa,CAAC3C,CAAD,CAA3C,EAAgDA,CAAC,IAAK2C,aAAa,CAAC1C,MAAd,GAAuB,CAA7E;AACA;AACD;AACD;;;AACAgD,QAAAA,eAAe,CAAC/B,IAAD,EAAad,KAAb,EAA4BF,IAA5B,EAAkCiB,SAAkB,GAAG,KAAvD,EAA8D;AAC5E,cAAIC,UAAU,GAAGF,IAAI,CAAC/B,YAAL,CAAkBlC,MAAlB,CAAjB;AAEAiE,UAAAA,IAAI,CAAC,SAAD,CAAJ,GAAkBb,MAAM,CAACD,KAAK,GAAG,CAAT,CAAxB;;AAEA,cAAIF,IAAJ,EAAU;AACTkB,YAAAA,UAAU,CAAChC,YAAX,GAA0B,IAA1B;AACA,iBAAKuC,eAAL,CAAqBzB,IAAI,CAAC0B,MAA1B,EAAkC1B,IAAI,CAAC2B,IAAvC,EAA6CtE,WAA7C,EAA2DuE,KAAD,IAAW;AACpE,kBAAI,CAACA,KAAL,EAAY;AACX;AACA;;AACD,kBAAI,CAACZ,IAAD,IAASA,IAAI,CAACa,OAAL,IAAgB,KAA7B,EAAoC;AACnC;AACA;;AACD,kBAAIC,WAAW,GAAGF,KAAK,CAACG,cAAN,CAAqB/B,IAAI,CAACwB,QAA1B,CAAlB;;AACA,kBAAIM,WAAJ,EAAiB;AAChB,oBAAIE,eAAe,GAAGhB,IAAI,CAAC/B,YAAL,CAAkB7B,MAAlB,CAAtB;AACA4E,gBAAAA,eAAe,CAACC,QAAhB,GAA2B,CAA3B;AACAD,gBAAAA,eAAe,CAACF,WAAhB,GAA8BA,WAA9B;AACAd,gBAAAA,IAAI,CAAClC,MAAL,GAAc,IAAd;AACA;AACD,aAdD;AAgBA,WAlBD,MAkBO;AACNoC,YAAAA,UAAU,CAAChC,YAAX,GAA0B,KAA1B;AACA;AAED;AAED;;;AACA8D,QAAAA,cAAc,CAACC,KAAD,EAAoB;AACjC;AAAA;AAAA,4CAAaC,QAAb,CAAsB;AAAA;AAAA,oCAASC,eAA/B,EAAgD;AAAA;AAAA,oCAASC,SAAzD;AACA,eAAK5E,SAAL,CAAeyE,KAAK,CAACI,aAArB;AACA,SAxQmD,CA0QpD;;;AACAC,QAAAA,UAAU,CAACL,KAAD,EAAoB;AAC7BL,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBI,KAAK,CAACI,aAAN,CAAoB,SAApB,CAAxB;;AACA,cAAIJ,KAAK,CAACI,aAAN,CAAoB,SAApB,KAAkC,IAAtC,EAA4C;AAC3C;AACA,WAJ4B,CAK7B;AACA;AACA;AACA;AACA;;;AACA,cAAIE,KAAK,GAAGN,KAAK,CAACI,aAAN,CAAoB,SAApB,CAAZ;AACA;AAAA;AAAA,4CAAaH,QAAb,CAAsB;AAAA;AAAA,oCAASC,eAA/B,EAAgD;AAAA;AAAA,oCAASC,SAAzD;AACA;AAAA;AAAA,4CAAaF,QAAb,CAAsB;AAAA;AAAA,oCAASM,yBAA/B,EAA0DD,KAAK,CAAC,OAAD,CAA/D,EAA0EA,KAAK,CAAC,MAAD,CAA/E;AACA,eAAK5E,IAAL,CAAU8E,OAAV;AACA,SAzRmD,CA2RpD;;;AACAC,QAAAA,YAAY,CAACT,KAAD,EAAoB;AAC/BL,UAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBI,KAAK,CAACI,aAAN,CAAoB,SAApB,CAAtB;;AACA,cAAIJ,KAAK,CAACI,aAAN,CAAoB,SAApB,KAAkC,IAAtC,EAA4C;AAC3C;AACA;;AACD,cAAIE,KAAK,GAAGN,KAAK,CAACI,aAAN,CAAoB,SAApB,CAAZ;AACA;AAAA;AAAA,4CAAaH,QAAb,CAAsB;AAAA;AAAA,oCAASC,eAA/B,EAAgD;AAAA;AAAA,oCAASC,SAAzD;AAEA;AAAA;AAAA,4CAAaF,QAAb,CAAsB;AAAA;AAAA,oCAASS,2BAA/B,EAA4DJ,KAA5D;AAEA,eAAK5E,IAAL,CAAU8E,OAAV;AACA,SAvSmD,CAySpD;;;AACAG,QAAAA,YAAY,CAACX,KAAD,EAAe;AAC1BL,UAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ;AACA;AAAA;AAAA,4CAAaK,QAAb,CAAsB;AAAA;AAAA,oCAASC,eAA/B,EAAgD;AAAA;AAAA,oCAASC,SAAzD;AACA,eAAKzE,IAAL,CAAU8E,OAAV;AACA,SA9SmD,CAgTpD;;;AACAI,QAAAA,SAAS,GAAG,CAEX;;AAnTmD,O;;;;;iBAItB,I;;;;;;;iBAGE,I;;;;;;;iBAGD,I;;;;;;;iBAIE,I;;;;;;;iBAIC,I;;;;;;;iBAIE,I;;;;;;;iBAIL,I;;;;;;;iBAIE,I","sourcesContent":["\nimport { Button, Color, EventTouch, instantiate, LabelComponent, Node, Sprite, SpriteAtlas, _decorator } from 'cc';\nimport { EventManager } from '../../../framework/manager/EventManager';\nimport { Utils } from '../../../framework/Utils';\nimport { BaseComponent } from '../../../framework/vc/BaseComponent';\nimport { FXJConstant } from '../common/FXJConstant';\nimport { FXJEvent } from '../common/FXJEvent';\nimport { FXJRes } from '../common/FXJRes';\nimport { FXJSound } from '../common/FXJSound';\nconst { ccclass, property, menu } = _decorator;\n\n/**\n * Name = GameChatPrefabCtr\n * URL = db://assets/package/game/scripts/GameChatPrefabCtr.ts\n * Time = Fri Sep 09 2022 11:52:39 GMT+0800 (中国标准时间)\n * Author = Tomoe\n * 游戏聊天界面\n * Life: onLoad-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n */\n\n@ccclass('GameChatPrefabCtr')\n//方便编辑器识别的菜单项目\n@menu('prefab/game/GameChatPrefabCtr')\nexport class GameChatPrefabCtr extends BaseComponent {\n\n\t//标签-常用语\n\t@property({ tooltip: \"标签-常用语\", type: Node })\n\tprivate tabMsg: Node | null = null;\n\t//标签-表情\n\t@property({ tooltip: \"标签-表情\", type: Node })\n\tprivate tabEmoji: Node | null = null;\n\t//常用语列表\n\t@property({ tooltip: \"常用语列表\", type: Node })\n\tprivate msgList: Node | null = null;\n\n\t//表情列表\n\t@property({ tooltip: \"表情列表\", type: Node })\n\tprivate emojiList: Node | null = null;\n\n\t//常用语父节点\n\t@property({ tooltip: \"常用语父节点\", type: Node })\n\tprivate msgContent: Node | null = null;\n\n\t//表情父节点\n\t@property({ tooltip: \"表情父节点\", type: Node })\n\tprivate emojiContent: Node | null = null;\n\n\t//常用语节点\n\t@property({ tooltip: \"常用语节点\", type: Node })\n\tprivate nodeMsg: Node | null = null;\n\n\t//表情节点\n\t@property({ tooltip: \"表情节点\", type: Node })\n\tprivate nodeEmoji: Node | null = null;\n\n\tonInitModuleEvent() {\n\n\t}\n\tonLoad() {\n\t\tthis.hideMaskNode();\n\t\tthis.updateView();\n\t\tthis.changeTag(this.tabMsg);\n\t};\n\n\t/** 隐藏遮罩层 */\n\thideMaskNode() {\n\t\tlet maskNode = this.node.parent.getChildByName(\"Mask\");\n\t\tif (maskNode) {\n\t\t\tmaskNode.active = false;\n\t\t}\n\t}\n\tstart() {\n\n\t};\n\n\n\t/** 标签切换 */\n\tchangeTag(chooseNode: Node) {\n\t\tchooseNode.getComponent(Button).interactable = false;\n\t\tchooseNode.getChildByName(\"Checkmark\").active = true;\n\t\tif (chooseNode == this.tabMsg) {\n\t\t\tthis.tabEmoji.getComponent(Button).interactable = true;\n\t\t\tthis.tabEmoji.getChildByName(\"Checkmark\").active = false;\n\n\t\t\tthis.msgList.active = true;\n\t\t\tthis.emojiList.active = false;\n\t\t} else if (chooseNode == this.tabEmoji) {\n\t\t\tthis.tabMsg.getComponent(Button).interactable = true;\n\t\t\tthis.tabMsg.getChildByName(\"Checkmark\").active = false;\n\n\t\t\tthis.msgList.active = false;\n\t\t\tthis.emojiList.active = true;\n\t\t}\n\t}\n\tupdateView() {\n\t\tthis.nodeMsg.active = false;\n\t\tthis.nodeEmoji.active = false;\n\t\tthis.updateMessageList();\n\t\tthis.updateEmoList();\n\t}\n\t/** 更新消息列表 */\n\tupdateMessageList() {\n\t\tlet chatTextData = [];\n\n\t\t//热门聊天语\n\t\tlet hotTxtConfig = FXJConstant.ChatText.hot;\n\t\tfor (let i = 0; i < hotTxtConfig.length; i++) {\n\t\t\tlet data = {\n\t\t\t\ttag: \"tag_hot\",\n\t\t\t\tindex: String(i + 1),\n\t\t\t\ttext: hotTxtConfig[i],\n\t\t\t}\n\t\t\tif (i == 0) {\n\t\t\t\tdata[\"isTag\"] = true;\n\t\t\t}\n\t\t\tchatTextData.push(data);\n\t\t}\n\n\t\t//经典聊天语\n\t\tlet classicTxtConfig = FXJConstant.ChatText.classic;\n\t\tfor (let i = 0; i < classicTxtConfig.length; i++) {\n\t\t\tlet data = {\n\t\t\t\ttag: \"tag_classic\",\n\t\t\t\tindex: \"Classic_\" + String(i + 1),\n\t\t\t\ttext: classicTxtConfig[i],\n\t\t\t}\n\t\t\tif (i == 0) {\n\t\t\t\tdata[\"isTag\"] = true;\n\t\t\t}\n\t\t\tchatTextData.push(data);\n\t\t}\n\n\t\t//麻将聊天语\n\t\tlet majiangTxtConfig = FXJConstant.ChatText.majiang;\n\t\tfor (let i = 0; i < majiangTxtConfig.length; i++) {\n\t\t\tlet data = {\n\t\t\t\ttag: \"tag_majiang\",\n\t\t\t\tindex: \"Majiang_\" + String(i + 1),\n\t\t\t\ttext: majiangTxtConfig[i],\n\t\t\t}\n\t\t\tif (i == 0) {\n\t\t\t\tdata[\"isTag\"] = true;\n\t\t\t}\n\t\t\tchatTextData.push(data);\n\t\t}\n\n\t\tlet currowDaysNum = this.msgContent.children.length;\n\t\tif (currowDaysNum < chatTextData.length) {\n\t\t\tfor (let i = currowDaysNum; i < chatTextData.length; i++) {\n\t\t\t\tlet node = instantiate(this.nodeMsg);\n\t\t\t\tthis.msgContent.addChild(node);\n\t\t\t}\n\t\t} else if (currowDaysNum > chatTextData.length) {\n\t\t\tfor (let i = (currowDaysNum - 1); i >= chatTextData.length; i--) {\n\t\t\t\tlet node = this.msgContent.children[i];\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.removeFromParent();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (let i = 0; i < this.msgContent.children.length; i++) {\n\t\t\tlet node = this.msgContent.children[i];\n\t\t\tthis.updateMsgItem(node, i, chatTextData[i], i == (chatTextData.length - 1));\n\t\t}\n\t}\n\t/** 更新单条消息 */\n\tupdateMsgItem(item: Node, index: number, data, isEndIndx: boolean = false) {\n\t\titem.active = true;\n\t\tlet buttonComp = item.getComponent(Button);\n\n\t\titem[\"chatMsg\"] = data;\n\n\t\tlet tag = item.getChildByName(\"tag\");\n\t\tlet txtLabel = item.getChildByName(\"Label\");\n\t\tlet tab_line = item.getChildByName(\"tab_line\");\n\n\t\ttab_line.active = (isEndIndx != true);\n\n\t\tif (data) {\n\t\t\tbuttonComp.interactable = true;\n\t\t\tif (data[\"isTag\"] && data[\"tag\"]) {\n\t\t\t\tlet frameName = Utils.string_format(FXJRes.Atlas_Game_Desk.plistKey, data[\"tag\"])\n\t\t\t\tthis.getPreLoaderRes(FXJRes.Atlas_Game_Desk.bundle, FXJRes.Atlas_Game_Desk.path, SpriteAtlas, (atlas) => {\n\t\t\t\t\tif (!atlas) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tif (!tag || tag.isValid == false) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tlet spriteFrame = atlas.getSpriteFrame(frameName)\n\t\t\t\t\tif (spriteFrame) {\n\t\t\t\t\t\tlet spriteComponent = tag.getComponent(Sprite);\n\t\t\t\t\t\tspriteComponent.sizeMode = 0;\n\t\t\t\t\t\tspriteComponent.spriteFrame = spriteFrame;\n\t\t\t\t\t\ttag.active = true;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\ttag.active = false;\n\t\t\t}\n\t\t\tif (data[\"text\"] != null) {\n\t\t\t\tlet fontColor = {\n\t\t\t\t\ttag_role: new Color(163, 138, 231),\n\t\t\t\t\ttag_hot: new Color(241, 110, 63),\n\t\t\t\t\ttag_classic: new Color(145, 81, 19),\n\t\t\t\t}\n\t\t\t\tlet labelComponent = txtLabel.getComponent(LabelComponent);\n\t\t\t\tlabelComponent.string = data[\"text\"] || \"\";\n\t\t\t\tif (fontColor[data[\"tag\"]]) {\n\t\t\t\t\tlabelComponent.color = fontColor[data[\"tag\"]];\n\t\t\t\t}\n\t\t\t\ttxtLabel.active = true;\n\t\t\t}\n\t\t} else {\n\t\t\ttag.active = false;\n\t\t\ttxtLabel.active = false;\n\t\t\tbuttonComp.interactable = false;\n\t\t}\n\t}\n\n\n\t/** 更新 */\n\tupdateEmoList() {\n\t\tlet emojiDataList = [];\n\t\tfor (let i = 0; i < 16; i++) {\n\t\t\tlet key = Utils.string_format(FXJRes.Atlas_Game_Desk.plistKey, \"emoji_default_\" + String(i + 1));\n\t\t\tlet resConf = {\n\t\t\t\tbundle: FXJRes.Atlas_Game_Desk.bundle,\n\t\t\t\tpath: FXJRes.Atlas_Game_Desk.path,\n\t\t\t\tplistKey: key\n\t\t\t}\n\t\t\temojiDataList.push(resConf);\n\t\t}\n\t\tconsole.log(\"emojiDataList==>\", emojiDataList)\n\t\tlet currowDaysNum = this.emojiContent.children.length;\n\t\tif (currowDaysNum < emojiDataList.length) {\n\t\t\tfor (let i = currowDaysNum; i < emojiDataList.length; i++) {\n\t\t\t\tlet node = instantiate(this.nodeEmoji);\n\t\t\t\tthis.emojiContent.addChild(node);\n\t\t\t}\n\t\t} else if (currowDaysNum > emojiDataList.length) {\n\t\t\tfor (let i = (currowDaysNum - 1); i >= emojiDataList.length; i--) {\n\t\t\t\tlet node = this.emojiContent.children[i];\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.removeFromParent();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (let i = 0; i < this.emojiContent.children.length; i++) {\n\t\t\tlet node = this.emojiContent.children[i];\n\t\t\tthis.updateEmojiItem(node, i, emojiDataList[i], i == (emojiDataList.length - 1));\n\t\t}\n\t}\n\t/** 更新单个表情 */\n\tupdateEmojiItem(item: Node, index: number, data, isEndIndx: boolean = false) {\n\t\tlet buttonComp = item.getComponent(Button);\n\n\t\titem[\"chatMsg\"] = String(index + 1);\n\n\t\tif (data) {\n\t\t\tbuttonComp.interactable = true;\n\t\t\tthis.getPreLoaderRes(data.bundle, data.path, SpriteAtlas, (atlas) => {\n\t\t\t\tif (!atlas) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tif (!item || item.isValid == false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet spriteFrame = atlas.getSpriteFrame(data.plistKey)\n\t\t\t\tif (spriteFrame) {\n\t\t\t\t\tlet spriteComponent = item.getComponent(Sprite);\n\t\t\t\t\tspriteComponent.sizeMode = 0;\n\t\t\t\t\tspriteComponent.spriteFrame = spriteFrame;\n\t\t\t\t\titem.active = true;\n\t\t\t\t}\n\t\t\t})\n\n\t\t} else {\n\t\t\tbuttonComp.interactable = false;\n\t\t}\n\n\t}\n\n\t/** tab标签的点击事件 */\n\tonClickTabMenu(event: EventTouch) {\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tthis.changeTag(event.currentTarget);\n\t}\n\n\t//点击发送快捷短语\n\tonMsgClick(event: EventTouch) {\n\t\tconsole.log(\"点击发送快捷短语\", event.currentTarget[\"chatMsg\"]);\n\t\tif (event.currentTarget[\"chatMsg\"] == null) {\n\t\t\treturn;\n\t\t}\n\t\t// {\n\t\t// \t\"tag\": \"tag_hot\",\n\t\t// \t\"index\": \"hot_1\",\n\t\t// \t\"text\": \"搞快点!搞快点!\"\n\t\t// }\n\t\tlet param = event.currentTarget[\"chatMsg\"];\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tEventManager.dispatch(FXJEvent.GAME_REQ_PLAYER_CHAET_MSG, param[\"index\"], param[\"text\"]);\n\t\tthis.node.destroy();\n\t}\n\n\t//点击发送表情\n\tonEmojiClick(event: EventTouch) {\n\t\tconsole.log(\"点击发送表情\", event.currentTarget[\"chatMsg\"]);\n\t\tif (event.currentTarget[\"chatMsg\"] == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet param = event.currentTarget[\"chatMsg\"];\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\n\t\tEventManager.dispatch(FXJEvent.GAME_REQ_PLAYER_CHAET_EMOJI, param)\n\n\t\tthis.node.destroy();\n\t}\n\n\t//点击关闭界面\n\tonCloseClick(event: Event) {\n\t\tconsole.log(\"点击事件响应===>>>>关闭界面\");\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tthis.node.destroy();\n\t}\n\n\t//销毁\n\tonDestroy() {\n\n\t};\n\n}\n\n"]}