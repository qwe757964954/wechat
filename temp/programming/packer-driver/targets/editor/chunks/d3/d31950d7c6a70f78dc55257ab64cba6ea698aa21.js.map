{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/scripts/NodeCardCtr.ts"],"names":["MeshRenderer","Node","Texture2D","Vec3","_decorator","instantiate","Utils","resLoader","BaseComponent","FXJRes","CardUtil","ccclass","property","NodeCardCtr","tooltip","type","albedo","nodeCardTab","byte","onInitModuleEvent","onLoad","setCardByte","cardStr","getCardValue","path","string_format","Picture_Game_Card","load","bundle","err","tex","console","log","nodeCardMesh","getComponent","material","setProperty","isNotNull","nodeCardTabTemplate","isLaizi","active","node","addChild","setCardAlbedo","value","setBlack","vlaue"],"mappings":"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","sourcesContent":["\nimport { MeshRenderer, Node, Texture2D, Vec3, _decorator, instantiate } from 'cc';\nimport { Utils } from '../../../framework/Utils';\nimport { resLoader } from '../../../framework/loader/ResLoader';\nimport { BaseComponent } from '../../../framework/vc/BaseComponent';\nimport { FXJRes } from '../common/FXJRes';\nimport { CardUtil } from '../util/CardUtil';\nconst { ccclass, property } = _decorator;\n\n/**\n * Name = NodeCardCtr\n * URL = db://assets/package/game/scripts/NodeCardCtr.ts\n * Time = Tue Aug 08 2023 15:30:03 GMT+0800 (中国标准时间)\n * Author = harvyson\n *\n * Life: onLoad-->onInitModuleEvent-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n * \n */\n\n@ccclass('NodeCardCtr')\nexport class NodeCardCtr extends BaseComponent {\n    // 手牌模型节点\n    @property({ tooltip: \"手牌模型节点\", type: Node })\n    private nodeCardMesh: Node | null = null;\n\n    // 手牌标签模板节点\n    @property({ tooltip: \"手牌标签模板节点\", type: Node })\n    private nodeCardTabTemplate: Node | null = null;\n\n    // 反射率\n    private albedo: Vec3 = new Vec3(1, 1, 1);\n\n    // 手牌标签节点\n    private nodeCardTab: Node = null;\n\n    public byte: number = 0;\n\n    /** override 初始化模块事件 */\n    protected onInitModuleEvent() {\n\n    };\n\n    onLoad(): void {\n        \n    }\n\n    /** 设置手牌数值 */\n    public setCardByte(byte: number) {\n        this.byte = byte;\n        let cardStr = CardUtil.getCardValue(byte);\n\n        let path = Utils.string_format(FXJRes.Picture_Game_Card.path, cardStr)\n        // console.log(\"NodeCardCtr\", \"setCardByte\", \"path\", path)\n        resLoader.load(FXJRes.Picture_Game_Card.bundle, path, Texture2D, (err: Error | null, tex) => {\n            if (err) {\n                console.log(\"NodeCardCtr\", \"setCardByte\", err)\n                return\n            }\n            if (tex) {\n                this.nodeCardMesh.getComponent(MeshRenderer)!.material!.setProperty('albedoMap', tex);\n            }\n        })\n\n        if (Utils.isNotNull(this.nodeCardTabTemplate)) {\n            let isLaizi = CardUtil.getCardValue(this.byte) === \"0x21\";\n            if (Utils.isNotNull(this.nodeCardTab)) {\n                this.nodeCardTab.active = isLaizi;\n            } else {\n                if (isLaizi) {\n                    this.nodeCardTab = instantiate(this.nodeCardTabTemplate);\n                    this.node.addChild(this.nodeCardTab);\n                    this.nodeCardTab.active = true;\n                }\n            }\n        }\n    }\n\n    /** 设置手牌反射率 */\n    public setCardAlbedo(value: Vec3) {\n        this.albedo = value;\n        this.nodeCardMesh.getComponent(MeshRenderer)!.material!.setProperty('albedo', this.albedo);\n    }\n\n    /** 设置是否变黑 */\n    public setBlack(vlaue: boolean) {\n        if (vlaue) {\n            this.nodeCardMesh.getComponent(MeshRenderer)!.material!.setProperty('albedo', new Vec3(0.2, 0.2, 0.2));\n        } else {\n            this.nodeCardMesh.getComponent(MeshRenderer)!.material!.setProperty('albedo', this.albedo);\n        }\n    }\n    \n    \n\n}\n\n"]}