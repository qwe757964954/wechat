{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/hall/scripts/mallPrefabCtr.ts"],"names":["Color","Label","Layout","Node","Prefab","ScrollView","Sprite","SpriteAtlas","SpriteFrame","UITransform","_decorator","instantiate","GCache","AppEvent","AppSound","APPState","GConstants","GameRes","GameTxt","ReportConfig","UIID","Utils","Encrypt","ButtonSimple","DelegateComponent","resLoader","EventManager","BaseComponent","Platform","commonBtnPrefabCtr","shopGoodsPrefabCtr","ccclass","property","menu","mallPrefabCtr","tooltip","type","mallViewLayer","currentScene","currowChooseSmallTagCid","currowChooseGoodsID","payScene","_FowardPayScene","_isOnload","_clickGoodItemCallBack","_isStartCountDown","_currowShareData","_bigTabList","scene","ShopBigTabType","SILVER_COIN","normal","choose","onInitModuleEvent","addModelListener","NOTIFY_GOODS_CHANGE","refreshViewByData","ACTIVITY_SHOPLIST_UPDATE","refreshViewByScene","SYS_SHOW_OR_HIDE","processApplicationActions","onLoad","silverView","PROPS","propView","getComp","initView","start","handler","onClickGoodsItem","dispatch","NET_REQ_GOODS_INFO","GoodsListID","MarketSilver","comp","node","getComponent","param","getParams","table_verify","updatePayScene","getShopData","res","ShopInfo","getDataList","clone","event","data","console","log","updateView","state","print","SHOW","isCanShare","ShareInfo","checkCanShareToFriend","NET_REQ_SHARE_AWARD","ReqUrl","shareType","shop","SYS_TOAST_TIP","content","shareFailMsg","HIDE","recodeShareFriendStart","isOnload","REPORT_CLIENT_CLICK","eventID","mall_4","cloneItemNode","active","key","pageNode","smallTabRoot","self","getPreLoaderRes","Prefab_HallTopUI","bundle","path","isShowShop","isValid","addChild","updateBigTab","setSpriteFrameByRemote","string_isHttp","loadRemote","ext","err","imageAsset","spriteFrame","image_ImageAssetToSpriteFrame","showChangeLightBuAni","changeAni","aniName","isLoop","aniConf","parentNode","spineQieHuan","resConf","Spine_Mall_Qiehuan","trackIndex","callEndFunc","removeAllChildren","childLength","bigTabLayer","children","length","max","i","nodeItem","destroy","bigTagData","shopTab","bigTab","onTouch","nodeNormal","getChildByName","nodeChoose","Atlas_Mall","atlas","getSpriteFrame","layout","updateLayout","addSchedulerOnce","width","bigTabScrollView","enabled","scrollToLeft","on","EventType","TOUCH_END","onClickBigTab","closeTouch","off","target","mall_1","mall_2","String","updateSmallTag","updateCenterLayout","smallTagData","getSubTbs","smallTabLayer","allSmallNode","cloneSmallTab","create_2DNode","roleAni","Spine_DengLongAni","string","push","buttonSimple","color","Interactable","Number","showSilverView","showPropView","PayModel","shop_silver_coin","shop_props","silverCoinLayer","goodsData","clickCallback","propLayer","showGoldView","onClickPageView","goodData","table_isEmpty","nodeGoodItem","parent","nodeGoodItemComp","isSelect","goodsID","mall_3","body","gsubname","getShopDataByGoodsID","payProcess","goodsItem","payData","getPriceByGoodsSceneId","limit_buy_way","bought_num","limit_buy_num","currency","PayType","RMB","title","DialogTitle","Goods_content","itemData","isConfirm","specialDesc","callFunc","pData","__paySure","payID","price","pmodes","JsonDecode","VIEW_UI_OPEN","BuyDialogPrefab","SILVER","willShowBuyPropDialog","TICKET","SHARE","_allowShareMsg","shareTimeAllowed","ShareSceneConf","shopshare","shareWXFriends","__doCallBackShare","VIDEO","isWXPlatform","playerAdVideo","__doCallBackWatchADs","status","NET_REQ_ADS_AWARD","User","getUserMoneyByID","goodsId","BuyPropDialogPrefab","CurrowPaySceneType","UBPaySceneConfig","kHallMarketGold","OTHER_PAY_WILL","gid","onClickSmallTag","SYS_PLAY_EFFECT","CommClick","cid","child","onClickReturn","onDestroy","SYS_PLAY_MUSIC_LAST"],"mappings":"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","sourcesContent":["\nimport { Color, EventTouch, Label, Layout, Node, Prefab, ScrollView, Sprite, SpriteAtlas, SpriteFrame, UITransform, _decorator, instantiate } from 'cc';\nimport { GCache } from '../../../cache/GCache';\nimport { AppEvent } from '../../../config/AppEvent';\nimport { AppSound } from '../../../config/AppSound';\nimport { APPState } from '../../../config/GameConfig';\nimport { GConstants } from '../../../config/GameConstant';\nimport { GameRes } from '../../../config/GameRes';\nimport { GameTxt } from '../../../config/GameTxt';\nimport { ReportConfig } from '../../../config/ReportConfig';\nimport { UIID } from '../../../config/UIConfig';\nimport { inf_SpineAniCreate } from '../../../framework/InterfaceDefines';\nimport { Utils } from '../../../framework/Utils';\nimport { Encrypt } from '../../../framework/crypto/Encrypto';\nimport ButtonSimple from '../../../framework/gui/button/ButtonSimple';\nimport { DelegateComponent } from '../../../framework/layer/DelegateComponent';\nimport { resLoader } from '../../../framework/loader/ResLoader';\nimport { EventManager } from '../../../framework/manager/EventManager';\nimport { BaseComponent } from '../../../framework/vc/BaseComponent';\nimport { Platform } from '../../../platform/Platform';\nimport { commonBtnPrefabCtr } from './commonBtnPrefabCtr';\nimport { shopGoodsPrefabCtr } from './shopGoodsPrefabCtr';\n\nconst { ccclass, property, menu } = _decorator;\n\n/**\n * Name = mallPrefabCtr\n * URL = db://assets/package/hall/scripts/mallPrefabCtr.ts\n * Time = Tue Sep 13 2022 15:54:48 GMT+0800 (中国标准时间)\n * Author = Tomoe\n * Life: onLoad-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n * 商城模块\n */\n\n@ccclass('mallPrefabCtr')\n@menu('prefab/hall/mallPrefabCtr')\nexport class mallPrefabCtr extends BaseComponent {\n\n    //背景动画根节点\n    @property({ tooltip: \"云-背景动画根节点\", type: Node })\n    private spineYun: Node | null = null;\n    //背景动画根节点\n    @property({ tooltip: \"树-背景动画根节点\", type: Node })\n    private spineShu: Node | null = null;\n    //背景动画根节点\n    @property({ tooltip: \"帘布-背景动画根节点\", type: Node })\n    private spineLianBu: Node | null = null;\n\n\n\n    //切换动画根节点\n    @property({ tooltip: \"切换动画根节点\", type: Node })\n    private spineQieHuan: Node | null = null;\n\n    //大标签滚动容器\n    @property({ tooltip: \"大标签滚动容器\", type: ScrollView })\n    private bigTabScrollView: ScrollView | null = null;\n\n    //大标签父节点\n    @property({ tooltip: \"大标签父节点\", type: Node })\n    private bigTabLayer: Node | null = null;\n\n    //大标签节点\n    @property({ tooltip: \"大标签节点\", type: Node })\n    private bigTab: Node | null = null;\n\n\n    //银币商品根节点\n    @property({ tooltip: \"银币根节点\", type: Node })\n    private silverCoinLayer: Node | null = null;\n\n    //银币页面节点\n    @property({ tooltip: \"银币页面节点\", type: Node })\n    private silverView: Node | null = null;\n\n    //道具商品根节点\n    @property({ tooltip: \"道具根节点\", type: Node })\n    private propLayer: Node | null = null;\n\n    //道具页面节点\n    @property({ tooltip: \"道具根节点\", type: Node })\n    private propView: Node | null = null;\n\n    // //金条商品根节点\n    // @property({ tooltip: \"金条根节点\", type: Node })\n    // private goldLayer: Node | null = null;\n\n    // //金条页面节点\n    // @property({ tooltip: \"金条根节点\", type: Node })\n    // private goldView: Node | null = null;\n\n    // 克隆的商品节点\n    @property({ tooltip: \"克隆的商品节点\", type: Node })\n    private cloneItemNode: Node | null = null;\n\n\n    //钻石Icon图片\n    @property({ tooltip: \"钻石Icon图片\", type: SpriteFrame })\n    private diamondIcon: SpriteFrame | null = null;\n\n    //金豆Icon图片\n    @property({ tooltip: \"金豆Icon图片\", type: SpriteFrame })\n    private goldIcon: SpriteFrame | null = null;\n\n\n    //二级标签和吊坠父节点\n    @property({ tooltip: \"二级标签和吊坠父节点\", type: Node })\n    private smallTabRoot: Node | null = null;\n\n    //二级标签父节点\n    @property({ tooltip: \"二级标签父节点\", type: Node })\n    private smallTabLayer: Node | null = null;\n\n    //克隆二级标签节点\n    @property({ tooltip: \"克隆二级标签节点\", type: Node })\n    private cloneSmallTab: Node | null = null;\n    //页面节点缓存\n    mallViewLayer = {};\n    //当前展示页面\n    currentScene: number = null;\n    //当前展示小标签\n    currowChooseSmallTagCid: number = null;\n    //当前选中物品ID\n    currowChooseGoodsID: number = null;\n    /** 当前支付场景 */\n    payScene = null;\n    /** 上一个跳转过来的付费场景 */\n    private _FowardPayScene: string = null;\n\n\n    private _isOnload = false;\n\n    private _clickGoodItemCallBack = null;\n    /** 读取前后台记录的时间 */\n    private _isStartCountDown = true;\n    /** 当前分享的data */\n    private _currowShareData = null;\n    /** 大标签定义 */\n    private _bigTabList = [\n        { scene: GConstants.ShopBigTabType.SILVER_COIN, normal: \"mall/tab_sliver_normal\", choose: \"mall/tab_silver_pressI\" },\n        // { scene: GConstants.ShopBigTabType.PROPS, normal: \"mall/tab_prop_normal\", choose: \"mall/tab_prop_pressI\" },\n    ]\n    /**初始化添加事件绑定 */\n    protected onInitModuleEvent(): void {\n        /**通知:商品有更新 */\n        this.addModelListener(AppEvent.NOTIFY_GOODS_CHANGE, this.refreshViewByData);\n        /**通知:商品场景 */\n        this.addModelListener(AppEvent.ACTIVITY_SHOPLIST_UPDATE, this.refreshViewByScene);\n        //前后台事件\n        this.addModelListener(AppEvent.SYS_SHOW_OR_HIDE, this.processApplicationActions)\n\n\n    }\n\n    onLoad() {\n        this.mallViewLayer = {\n            [GConstants.ShopBigTabType.SILVER_COIN]: this.silverView,\n            [GConstants.ShopBigTabType.PROPS]: this.propView,\n            // [GConstants.ShopBigTabType.GOLD]: this.goldView, //下一版本迭代\n        }\n        this.getComp();\n        this.initView(true);\n    };\n    start() {\n        this._isOnload = true;\n        this._clickGoodItemCallBack = Utils.handler(this, this.onClickGoodsItem);\n        this.initView();\n        // 根据BigTab请求拉取对应商城配置\n        EventManager.dispatch(AppEvent.NET_REQ_GOODS_INFO, { scene: GConstants.GoodsListID.MarketSilver });\n        // EventManager.dispatch(AppEvent.NET_REQ_GOODS_INFO, { scene: GConstants.GoodsListID.MarketProp });\n    };\n\n    getComp() {\n        let comp = this.node.getComponent(DelegateComponent)\n        if (comp) {\n            let param = comp.getParams();\n            param = Utils.table_verify(param);\n            //获取上一个付费场景\n            this._FowardPayScene = (param[\"pay_scene\"] || null);\n            this.currentScene = (param[\"id\"] != null ? param[\"id\"] : GConstants.ShopBigTabType.SILVER_COIN);\n            this.updatePayScene();\n        }\n    }\n    getShopData(type = null) {\n        let res = GCache.ShopInfo.getDataList(type);\n        return Utils.clone(res);\n    }\n    /**商城数据有更新 */\n    refreshViewByData(event, data) {\n        if (!this._isOnload) {\n            return;\n        }\n        console.log(\"商城数据有更新 或则角色刷新，或兑换成功===>>>\", data);\n        this.updateView();\n    }\n    /** 商城页签数据有关系 */\n    refreshViewByScene(event, scene) {\n        if (this.currentScene != scene) {\n            return;\n        }\n        this.updateView();\n    }\n\n    /**前后台事件 */\n    processApplicationActions(event: string, state: APPState) {\n        if (this._isStartCountDown != true) {\n            return;\n        }\n        //先后台再前台\n        this.print(`[商城前后台事件]:${state == APPState.SHOW && \"前台\" || \"后台\"}`);\n        if (state == APPState.SHOW) {\n            this._isStartCountDown = false;\n            let isCanShare = GCache.ShareInfo.checkCanShareToFriend()\n            console.log('isCanShare', isCanShare, this._currowShareData)\n            if (isCanShare == true && this._currowShareData) {\n                EventManager.dispatch(AppEvent.NET_REQ_SHARE_AWARD, this._currowShareData, GConstants.ReqUrl.shareType.shop, true)\n            } else {\n                EventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: GameTxt.shareFailMsg });\n            }\n\n        } else if (state == APPState.HIDE) {\n            //后台事件开始计时\n            GCache.ShareInfo.recodeShareFriendStart()\n        }\n    }\n    //初始化界面\n    initView(isOnload = false) {\n        // 初始化界面展示次数\n        EventManager.dispatch(AppEvent.REPORT_CLIENT_CLICK, { eventID: ReportConfig.mall_4 });\n        if (isOnload) {\n            this.cloneItemNode.active = false;\n            for (let key in this.mallViewLayer) {\n                let pageNode = this.mallViewLayer[key];\n                pageNode.active = false;\n            }\n            this.smallTabRoot.active = false;\n            let self = this;\n            this.getPreLoaderRes(GameRes.Prefab_HallTopUI.bundle, GameRes.Prefab_HallTopUI.path, Prefab, (res) => {\n                let comp = res.getComponent(commonBtnPrefabCtr);\n                comp.isShowShop = false;\n                if (self.node && self.node.isValid == true) {\n                    self.node.addChild(res);\n                }\n            })\n        } else {\n            this.updateBigTab();\n            this.updateView();\n        }\n    }\n    /**设置远端图片 */\n    setSpriteFrameByRemote(node, path) {\n        if (Utils.string_isHttp(path)) {\n            let self = this;\n            resLoader.loadRemote(path, { ext: '.jpg' }, (err, imageAsset) => {\n                if (!imageAsset) { //资源可能还在加载中\n                    return\n                }\n                if (!self.node || self.node.isValid == false) {\n                    return;\n                }\n                let spriteFrame = Utils.image_ImageAssetToSpriteFrame(imageAsset)\n                if (spriteFrame) {\n                    node.getComponent(Sprite).spriteFrame = spriteFrame;\n                    node.active = true;\n                }\n            })\n        }\n    }\n    //点击标签切换亮布\n    showChangeLightBuAni() {\n        let self = this;\n        let changeAni = function (aniName, isLoop = false) {\n            let aniConf: inf_SpineAniCreate = {\n                parentNode: self.spineQieHuan,\n                resConf: GameRes.Spine_Mall_Qiehuan,\n                aniName: aniName,\n                trackIndex: 0,\n                isLoop: isLoop,\n                callEndFunc: () => {\n                    if (aniName == \"qiehuan_lianbu\") {\n                        changeAni(\"loop_lianbu\", true)\n                    }\n                }\n            }\n            self.spineQieHuan.removeAllChildren();\n            // EventManager.dispatch(AppEvent.SYS_ANI_PLAY, aniConf);\n        }\n        changeAni(\"qiehuan_lianbu\", false);\n    }\n    /**更新大标签 */\n    updateBigTab() {\n        let childLength = this.bigTabLayer.children.length;\n        let max = this._bigTabList.length;\n        if (max < childLength) {\n            max = childLength;\n        }\n        for (let i = (max - 1); i >= 0; i--) {\n            let nodeItem = this.bigTabLayer.children[i];\n            if (nodeItem && !this._bigTabList[i]) {\n                nodeItem.destroy();\n            }\n        }\n\n        if (this.currentScene == null) {\n            this.currentScene = GConstants.ShopBigTabType.SILVER_COIN;\n        }\n        let bigTagData = GCache.ShopInfo.shopTab;\n        for (let i = 0; i < this._bigTabList.length; i++) {\n            let nodeItem = this.bigTabLayer.children[i];\n            if (!nodeItem) {\n                nodeItem = instantiate(this.bigTab);\n                this.bigTabLayer.addChild(nodeItem);\n                this.onTouch(nodeItem);\n                let nodeNormal: Node = nodeItem.getChildByName(\"normal\");\n                let nodeChoose: Node = nodeItem.getChildByName(\"choose\");\n                nodeItem[\"Normal\"] = nodeNormal;\n                nodeItem[\"Choose\"] = nodeChoose;\n            }\n            nodeItem.active = true;\n            let self = this;\n            if (nodeItem['pageID'] != this._bigTabList[i].scene) {\n                this.getPreLoaderRes(GameRes.Atlas_Mall.bundle, GameRes.Atlas_Mall.path, SpriteAtlas, (atlas) => {\n                    let normal: SpriteFrame = atlas.getSpriteFrame(self._bigTabList[i].normal)\n                    let choose: SpriteFrame = atlas.getSpriteFrame(self._bigTabList[i].choose)\n                    if (normal && choose) {\n                        nodeItem[\"Normal\"].getComponent(Sprite).spriteFrame = normal;\n                        nodeItem[\"Choose\"].getComponent(Sprite).spriteFrame = choose;\n                    }\n                })\n            }\n            if (bigTagData[this._bigTabList[i].scene]) {\n                nodeItem['pageID'] = this._bigTabList[i].scene\n            } else {\n                nodeItem['pageID'] = null;\n            }\n            if (this.currentScene == nodeItem['pageID']) {\n                nodeItem[\"Normal\"].active = false;\n                nodeItem[\"Choose\"].active = true;\n            } else {\n                nodeItem[\"Normal\"].active = true;\n                nodeItem[\"Choose\"].active = false;\n            }\n        }\n\n        let self = this;\n        let layout = self.bigTabLayer.getComponent(Layout);\n        layout.updateLayout();\n        this.addSchedulerOnce(0, () => {\n            if (self.bigTabLayer.getComponent(UITransform).width > self.bigTabScrollView.node.getComponent(UITransform).width) {\n                self.bigTabScrollView.enabled = true;\n                self.bigTabScrollView.scrollToLeft(0.01, false);\n            } else {\n                self.bigTabScrollView.enabled = false;\n            }\n        })\n    }\n    /**开启触摸监听*/\n    onTouch(node) {\n        node.on(Node.EventType.TOUCH_END, this.onClickBigTab, this);\n    }\n\n    /**关闭触摸监听*/\n    closeTouch(node) {\n        node.off(Node.EventType.TOUCH_END, this.onClickBigTab, this);\n    }\n\n    /** 底部大标签的点击大标签事件 */\n    onClickBigTab(event: EventTouch) {\n        if (event.target[\"pageID\"] == null || this.currentScene == event.target[\"pageID\"]) {\n            return;\n        }\n        if (event.type == \"touch-end\") {\n            this.currentScene = event.target[\"pageID\"];\n            this.currowChooseSmallTagCid = null;\n            this.currowChooseGoodsID = null;\n            this.updateBigTab();\n            this.updatePayScene();\n            this.updateView();\n            switch (this.currentScene) {\n                case GConstants.ShopBigTabType.SILVER_COIN:\n                    EventManager.dispatch(AppEvent.REPORT_CLIENT_CLICK, { eventID: ReportConfig.mall_1 });\n                    break;\n                case GConstants.ShopBigTabType.PROPS:\n                    EventManager.dispatch(AppEvent.REPORT_CLIENT_CLICK, { eventID: ReportConfig.mall_2 });\n                    break;\n            }\n        }\n    }\n    /**刷新商城页面 */\n    updateView() {\n        if (this.currentScene == null) {\n            this.currentScene = GConstants.ShopBigTabType.SILVER_COIN;\n            this.updatePayScene();\n        }\n        for (let key in this.mallViewLayer) {\n            let pageNode = this.mallViewLayer[key];\n            if (key == String(this.currentScene)) {\n                pageNode.active = true;\n            } else {\n                pageNode.active = false;\n            }\n        }\n        this.updateSmallTag();\n        this.updateCenterLayout();\n    }\n\n    //刷新小标签显示\n    updateSmallTag() {\n        let smallTagData = GCache.ShopInfo.getSubTbs(this.currentScene)\n        if (!smallTagData) {\n            this.smallTabRoot.active = false;\n            return;\n        }\n        let childLength = this.smallTabLayer.children.length;\n        let max = smallTagData.length;\n        if (max < childLength) {\n            max = childLength;\n        }\n        for (let i = (max - 1); i >= 0; i--) {\n            let nodeItem = this.smallTabLayer.children[i];\n            if (nodeItem && !smallTagData[i]) {\n                nodeItem.destroy();\n            }\n        }\n\n        let allSmallNode = [];\n        for (let i = 0; i < smallTagData.length; i++) {\n            let nodeItem = this.smallTabLayer.children[i];\n            if (!nodeItem) {\n                nodeItem = instantiate(this.cloneSmallTab);\n                this.smallTabLayer.addChild(nodeItem);\n            }\n            nodeItem[\"lantern_light_bg\"] = nodeItem.getChildByName(\"lantern_light_bg\");\n            nodeItem[\"label\"] = nodeItem.getChildByName(\"label\");\n\n            if (!nodeItem[\"aniNode\"]) {\n                nodeItem[\"aniNode\"] = Utils.create_2DNode(\"aniNode\");\n                nodeItem[\"lantern_light_bg\"].addChild(nodeItem[\"aniNode\"]);\n\n                let roleAni: inf_SpineAniCreate = {\n                    parentNode: nodeItem[\"aniNode\"],\n                    resConf: GameRes.Spine_DengLongAni,\n                    aniName: \"XC_denglong_loop\",\n                    trackIndex: 0,\n                    isLoop: true,\n                }\n                // EventManager.dispatch(AppEvent.SYS_ANI_PLAY, roleAni);\n            }\n            nodeItem[\"label\"].getComponent(Label).string = smallTagData[i][\"name\"];\n            nodeItem[\"cid\"] = smallTagData[i][\"cid\"];\n\n            allSmallNode.push(nodeItem);\n        }\n        if (this.currowChooseSmallTagCid == null) {\n            if (allSmallNode.length > 0) {\n                this.currowChooseSmallTagCid = allSmallNode[0][\"cid\"];\n            }\n        }\n        if (this.currowChooseSmallTagCid != null && allSmallNode.length > 0) {\n            for (let i = 0; i < allSmallNode.length; i++) {\n                let buttonSimple: ButtonSimple = allSmallNode[i].getComponent(ButtonSimple);\n\n                if (this.currowChooseSmallTagCid == allSmallNode[i][\"cid\"]) {\n                    allSmallNode[i][\"lantern_light_bg\"].active = true;\n                    allSmallNode[i][\"label\"].getComponent(Label).color = new Color(163, 139, 104, 255);\n                    buttonSimple.Interactable = false;\n                } else {\n                    allSmallNode[i][\"lantern_light_bg\"].active = false;\n                    buttonSimple.Interactable = true;\n                    allSmallNode[i][\"label\"].getComponent(Label).color = new Color(78, 70, 58, 255);\n                }\n            }\n        }\n        if (this.currowChooseSmallTagCid != null) {\n            this.smallTabRoot.active = true;\n            this.smallTabLayer.active = true;\n            this.smallTabLayer.getComponent(Layout).updateLayout();\n            this.smallTabRoot.getComponent(Layout).updateLayout();\n            this.showChangeLightBuAni();\n        } else {\n            this.smallTabRoot.active = false;\n        }\n\n    }\n    /** 更新中间商品界面 */\n    updateCenterLayout() {\n        switch (Number(this.currentScene)) {\n            case GConstants.ShopBigTabType.SILVER_COIN:\n                this.showSilverView();\n                break;\n            case GConstants.ShopBigTabType.PROPS:\n                this.showPropView();\n                break;\n            default:\n                break;\n        }\n    }\n    //更新支付场景ID\n    updatePayScene() {\n        console.log('更新了支付场景,updatePayScene')\n        switch (this.currentScene) {\n            case GConstants.ShopBigTabType.SILVER_COIN:\n                this.payScene = GConstants.PayModel.shop_silver_coin;\n                break;\n            case GConstants.ShopBigTabType.PROPS:\n                this.payScene = GConstants.PayModel.shop_props;\n                break;\n            default:\n                this.payScene = GConstants.PayModel.shop;\n                break;\n        }\n    }\n\n\n    /**显示银币商品 */\n    showSilverView() {\n        let childLength = this.silverCoinLayer.children.length;\n        let goodsData = this.getShopData(this.currowChooseSmallTagCid);\n        goodsData = Utils.table_verify(goodsData, true);\n        console.log('当前商品类别==》》', this.currowChooseSmallTagCid)\n        console.log('当前渲染的商品', goodsData)\n\n        let max = goodsData.length;\n        if (max < childLength) {\n            max = childLength;\n        }\n        for (let i = (max - 1); i >= 0; i--) {\n            let nodeItem = this.silverCoinLayer.children[i];\n            if (nodeItem && !goodsData[i]) {\n                nodeItem.destroy();\n            }\n        }\n        for (let i = 0; i < goodsData.length; i++) {\n            let nodeItem = this.silverCoinLayer.children[i];\n            if (!nodeItem) {\n                nodeItem = instantiate(this.cloneItemNode);\n                this.silverCoinLayer.addChild(nodeItem);\n            }\n            let comp = nodeItem.getComponent(shopGoodsPrefabCtr);\n            comp.goodsData = goodsData[i];  //赋值渲染数据\n            comp.clickCallback = this._clickGoodItemCallBack;\n            nodeItem.active = true;\n        }\n    }\n\n    // /**显示道具商品 */\n    showPropView() {\n        let childLength = this.propLayer.children.length;\n        let goodsData = this.getShopData(this.currowChooseSmallTagCid);\n        goodsData = Utils.table_verify(goodsData, true);\n\n        let max = goodsData.length;\n        if (max < childLength) {\n            max = childLength;\n        }\n        for (let i = (max - 1); i >= 0; i--) {\n            let nodeItem = this.propLayer.children[i];\n            if (nodeItem && !goodsData[i]) {\n                nodeItem.destroy();\n            }\n        }\n        for (let i = 0; i < goodsData.length; i++) {\n            let nodeItem = this.propLayer.children[i];\n            if (!nodeItem) {\n                nodeItem = instantiate(this.cloneItemNode);\n                this.propLayer.addChild(nodeItem);\n            }\n            let comp = nodeItem.getComponent(shopGoodsPrefabCtr);\n            comp.goodsData = goodsData[i];;\n            comp.clickCallback = this._clickGoodItemCallBack;\n\n            nodeItem.active = true;\n        }\n    }\n    // /**显示金条商品 下一期迭代 */\n    showGoldView() {\n        // let childLength = this.goldLayer.children.length;\n        // let goodsData = this.getShopData(this.currowChooseSmallTagCid);\n        // goodsData = Utils.table_verify(goodsData, true);\n\n        // let max = goodsData.length;\n        // if (max < childLength) {\n        // \tmax = childLength;\n        // }\n        // for (let i = (max - 1); i >= 0; i--) {\n        // \tlet nodeItem = this.goldLayer.children[i];\n        // \tif (nodeItem && !goodsData[i]) {\n        // \t\tnodeItem.destroy();\n        // \t}\n        // }\n        // for (let i = 0; i < goodsData.length; i++) {\n        // \tlet nodeItem = this.goldLayer.children[i];\n        // \tif (!nodeItem) {\n        // \t\tnodeItem = instantiate(this.cloneItemNode);\n        // \t\tthis.goldLayer.addChild(nodeItem);\n        // \t}\n        // \tlet comp = nodeItem.getComponent(shopGoodsPrefabCtr);\n        // \tcomp.goodsData = goodsData[i];;\n        // \tcomp.clickCallback = this._clickGoodItemCallBack;\n\n        // \tnodeItem.active = true;\n        // }\n    }\n\n    /** 点击了页签 */\n    onClickPageView(event: EventTouch) {\n        //EventManager.dispatch(AppEvent.SYS_PLAY_EFFECT, AppSound.CommClick);\n        let goodData = event.target[\"GoodData\"];\n        if (Utils.table_isEmpty(goodData)) {\n            return;\n        }\n        console.log(\"点击了页签==>\", event.target[\"GoodData\"]);\n        console.log(\"即将跳转==>\", goodData[\"item_url\"])\n        if (goodData[\"item_url\"] != null) {\n            //EventManager.dispatch(AppEvent.VIEW_UI_JUMP, { url: goodData[\"item_url\"] })\n        }\n    }\n\n    /** 商品点击*/\n    onClickGoodsItem(event: EventTouch) {\n        let nodeGoodItem: Node = event.target.parent;\n        let nodeGoodItemComp: shopGoodsPrefabCtr = nodeGoodItem.getComponent(shopGoodsPrefabCtr);\n        nodeGoodItemComp.isSelect = true;\n        let parentNode = nodeGoodItem.parent;\n        for (let node of parentNode.children) {\n            if (node != nodeGoodItem) {\n                node.getComponent(shopGoodsPrefabCtr).isSelect = false;\n            }\n        }\n        let goodsID = Utils.table_verify(nodeGoodItemComp.goodsData)[\"gid\"];\n        EventManager.dispatch(AppEvent.REPORT_CLIENT_CLICK, { eventID: ReportConfig.mall_3, body: { gsubname: goodsID } });\n        if (!goodsID) {\n            return\n        }\n        this.currowChooseGoodsID = goodsID;\n        //以最新的缓存数据为准再次查找数据\n        let goodsData = GCache.ShopInfo.getShopDataByGoodsID(this.currowChooseGoodsID)\n        console.log('普通商品点击===>，在缓存里查找对应的数据', goodsData)\n        this.payProcess(goodsData)\n    }\n\n    /**先走一遍支付流程 */\n    payProcess(goodsItem) {\n        let payData = GCache.ShopInfo.getPriceByGoodsSceneId(this.currentScene, this.currowChooseGoodsID);\n        console.log('当前要支付的商品', goodsItem, '缓存查到的支付的信息', payData)\n        // 如果超过最大购买数量，直接弹出提示\n        if (Number(goodsItem.limit_buy_way) == 1 && Number(goodsItem.bought_num) > 0 && Number(goodsItem.bought_num) >= Number(goodsItem.limit_buy_num)) {\n            return EventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: \"已超过最大购买上限\" })\n        }\n        let self = this\n        switch (goodsItem.currency) {\n            case GConstants.PayType.RMB: //rmb 1\n                //获取人民币类型\n                let param = {\n                    title: GConstants.DialogTitle.Goods_content,\n                    itemData: goodsItem,\n                    isConfirm: goodsItem.specialDesc ? false : true, //没有加赠 值为 'false  \n                    callFunc: (pData) => {\n                        //模拟支付\n                        self.__paySure(pData, { payID: GConstants.PayType.RMB, price: goodsItem.price });\n                    }\n                }\n                // 人民币时实际的支付 todo\n                let pmodes = Encrypt.JsonDecode(goodsItem.pmodes);\n                EventManager.dispatch(AppEvent.VIEW_UI_OPEN, UIID.BuyDialogPrefab, param);\n                break;\n            case GConstants.PayType.SILVER: //银币支付 2\n                //银币购买道具\n                if (this.currentScene == GConstants.ShopBigTabType.PROPS) {\n                    //考虑配置多种支付\n                    return this.willShowBuyPropDialog(goodsItem, { payID: payData['payID'], price: payData['price'] });\n                }\n                break;\n            case GConstants.PayType.TICKET://兑换券支付\n                break;\n            case GConstants.PayType.SHARE:\n                // 判断是否可以分享 返回分享的参数和距离下次分享的时间\n                let _allowShareMsg = GCache.ShareInfo.shareTimeAllowed(goodsItem['gid'], GConstants.ShareSceneConf.shopshare)\n                if (_allowShareMsg['allowShare']) {\n                    Platform.shareWXFriends(_allowShareMsg['shareParams'], Utils.handler(self, self.__doCallBackShare), _allowShareMsg['gid'])\n                } else {\n                    // 请勿在短时间内重复分享\n                    EventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: `请在${_allowShareMsg['nextSharetime']}秒后再次分享` });\n                }\n                break;\n            case GConstants.PayType.VIDEO://看视频\n                if (Platform.isWXPlatform()) {\n                    Platform.playerAdVideo(Utils.handler(this, this.__doCallBackWatchADs), goodsItem['gid'])\n                } else {\n                    EventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: \"点击了看视频\" });\n                }\n                break;\n        }\n    }\n    /** 分享完商品发放奖励发奖励 */\n    __doCallBackShare(data) {\n        this._currowShareData = data;\n        this._isStartCountDown = true;\n    }\n    /** 看完视频广告发奖励 */\n    __doCallBackWatchADs(status, goodsID) {\n        if (status != true) {\n            EventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: \"err:看广告失败\" });\n            return;\n        }\n        EventManager.dispatch(AppEvent.NET_REQ_ADS_AWARD, goodsID, GConstants.ReqUrl.shareType.shop, true)\n    }\n    /** 即将显示购买道具弹窗 */\n    willShowBuyPropDialog(goodData, payData) {\n        if (GCache.User.getUserMoneyByID(0) < payData.price) {\n            //银币不够且只有一个方式 跳转商城购买 商城内不用跳转\n            EventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: \"银币不足\" });\n        } else {\n            let param = {\n                goodsId: goodData[\"gid\"],\n                scene: GConstants.PayModel.shop_props\n            }\n            EventManager.dispatch(AppEvent.VIEW_UI_OPEN, UIID.BuyPropDialogPrefab, param);\n        }\n    }\n    /**支付确认 */\n    __paySure(data, payData) {\n        if (Utils.table_isEmpty(data) || Utils.table_isEmpty(payData)) {\n            return;\n        }\n        switch (payData.payID) {\n            case GConstants.PayType.SILVER:\n                // EventManager.dispatch(AppEvent.SYS_TOAST_TIP, { content: \"调接口去开始兑换\" });\n                break;\n            case GConstants.PayType.RMB:\n                GCache.CurrowPaySceneType = GConstants.UBPaySceneConfig.kHallMarketGold;\n                EventManager.dispatch(AppEvent.OTHER_PAY_WILL, GConstants.ShopBigTabType.SILVER_COIN, data.gid);\n                break;\n        }\n    }\n    //点击小标签\n    onClickSmallTag(event: EventTouch) {\n        EventManager.dispatch(AppEvent.SYS_PLAY_EFFECT, AppSound.CommClick);\n        let node = event.target;\n        let cid = node[\"cid\"];\n        for (let child of this.smallTabLayer.children) {\n            if (child[\"cid\"]) {\n                let buttonSimple = child.getComponent(ButtonSimple);\n                if (child[\"cid\"] == cid) {\n                    child[\"lantern_light_bg\"].active = true;\n                    child[\"label\"].getComponent(Label).color = new Color(163, 139, 104, 255);\n                    buttonSimple.Interactable = false;\n\n                } else {\n                    child.getChildByName(\"lantern_light_bg\").active = false;\n                    buttonSimple.Interactable = true;\n                    child[\"label\"].getComponent(Label).color = new Color(78, 70, 58, 255);\n                }\n            }\n        }\n        this.currowChooseSmallTagCid = cid;\n        this.showChangeLightBuAni();\n        this.updateCenterLayout();\n    }\n    //点击返回按钮\n    onClickReturn(event: EventTouch) {\n        for (let child of this.bigTabLayer.children) {\n            this.closeTouch(child);\n        }\n        this.node.destroy();\n    }\n\n    //销毁\n    onDestroy() {\n        EventManager.dispatch(AppEvent.SYS_PLAY_MUSIC_LAST);\n    };\n\n}\n\n"]}