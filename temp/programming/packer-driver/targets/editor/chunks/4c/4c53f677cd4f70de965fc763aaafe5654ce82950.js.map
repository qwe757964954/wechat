{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/scripts/GameDeskPrefabCtr.ts"],"names":["Node","_decorator","Utils","EventManager","BaseComponent","OperationMgr","PlayerMgr","RoomMgr","OPCode","FXJController","FXJEvent","FXJSound","GameEvent","GameViewConfig","NodeClockCtr","NodeDiceCtr","NodeHandCardCtr","NodeHuCardCtr","NodeMeldCardCtr","NodeOutCardCtr","NodeWallCtr","ccclass","property","menu","GameDeskPrefabCtr","tooltip","type","constructor","_gangCount","_soundConfig","console","log","init","getInstance","GameDeskCtr","onInitModuleEvent","addModelListener","VIEW_BROADCAST_GAME_START","onGameStart","VIEW_BROADCAST_ZHI_TOU","onRollDices","VIEW_BROADCAST_DEAL_CARD","onDealCard","VIEW_BROADCAST_OPERATION_START","onOperationStart","VIEW_USER_OPERATION","onOperationSelect","UPDATE_USER_OPERATION_RESULT","onOperationResult","VIEW_BROADCAST_GRAB_CARD","onTakeCard","VIEW_BROADCAST_GAME_OVER","onGameOver","RECEIVE_DEAL_CARD","onReconnect","onLoad","initData","initView","start","updateView","resetView","OnChangedSeat","hostDir","nodeWall","nodeHandCard","nodeOutCard","nodeMeldCard","nodeHuCard","nodeClock","mySeatId","node","setRotationFromEuler","nodeDesk","dataAnim","seatId","aniType","AnimType","GameStart","dispatch","VIEW_OUT_CARD_ANI_PLAY","event","data","isNull","table_isEmpty","diceInfo","bankerSeatId","diceList","dices","length","i","dice","nodeDice","cards","opCode","OPE_OUT_CARD","onOutCard","OPE_RIGHT_CHI","OPE_MIDDLE_CHI","OPE_LEFT_CHI","OPE_PENG","OPE_QIANG_PENG","onPengGang","OPE_AN_GANG","OPE_GANG","OPE_BU_GANG","OPE_HU","OPE_ZI_MO","onHu","OPE_DIAO","playEffect","roleName","player","findPlayerWithSeatId","isNotNull","sex","number_valueOf","gameUserInfo","cardValue","opCard","cardType","path","string_format","GameDiscard","SYS_PLAY_EFFECT","bundle","GameChi","GamePeng","GameGang","GameHu","GameZiMo","dataTakeCard","gangCount","remian","remainCardNum","cardSeatId","handCards","bankSeatId","remain","remainCardsCount","playerList","operationSeatId","operationTimePass","timePass","forEach","value","index","array","opGroups","dataItem","onDestroy","args"],"mappings":"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","sourcesContent":["\nimport { Node, _decorator } from 'cc';\nimport { Utils } from '../../../framework/Utils';\nimport { EventManager } from '../../../framework/manager/EventManager';\nimport { BaseComponent } from '../../../framework/vc/BaseComponent';\nimport { OperationMgr } from '../cache/OperationMgr';\nimport { PlayerMgr } from '../cache/PlayerMgr';\nimport { RoomMgr } from '../cache/RoomMgr';\nimport { OPCode } from '../common/FXJConfig';\nimport { FXJController } from '../common/FXJController';\nimport { FXJEvent } from '../common/FXJEvent';\nimport { FXJSound } from '../common/FXJSound';\nimport { GameEvent } from '../common/GameEvent';\nimport { GameViewConfig } from '../common/GameViewConfig';\nimport { Game } from '../common/idl/Game';\nimport { NodeClockCtr } from './NodeClockCtr';\nimport { NodeDiceCtr } from './NodeDiceCtr';\nimport { NodeHandCardCtr } from './NodeHandCardCtr';\nimport { NodeHuCardCtr } from './NodeHuCardCtr';\nimport { NodeMeldCardCtr } from './NodeMeldCardCtr';\nimport { NodeOutCardCtr } from './NodeOutCardCtr';\nimport { NodeWallCtr } from './NodeWallCtr';\nconst { ccclass, property, menu } = _decorator;\n\n/**\n * Name = GameDeskPrefabCtr\n * URL = db://assets/package/game/scripts/GameDeskPrefabCtr.ts\n * Time = Thu Aug 03 2023 11:48:42 GMT+0800 (中国标准时间)\n * Author = harvyson\n *\n * Life: onLoad-->onInitModuleEvent-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n * \n */\n\n@ccclass('GameDeskPrefabCtr')\n//方便编辑器识别的菜单项目\n@menu('prefab/game/GameDeskPrefabCtr')\nexport class GameDeskPrefabCtr extends BaseComponent {\n    // 桌子节点\n    @property({ tooltip: \"桌子节点\", type: Node })\n    private nodeDesk: Node = null;\n\n    // 牌墙节点\n    @property({ tooltip: \"牌墙节点\", type: NodeWallCtr })\n    private nodeWall: NodeWallCtr = null;\n\n    // 出牌节点\n    @property({ tooltip: \"出牌节点\", type: NodeOutCardCtr })\n    private nodeOutCard: NodeOutCardCtr = null;\n\n    // 手牌节点\n    @property({ tooltip: \"手牌节点\", type: NodeHandCardCtr })\n    private nodeHandCard: NodeHandCardCtr = null;\n\n    // 碰杠牌节点\n    @property({ tooltip: \"碰杠牌节点\", type: NodeMeldCardCtr })\n    private nodeMeldCard: NodeMeldCardCtr = null;\n\n    // 胡牌节点\n    @property({ tooltip: \"胡牌节点\", type: NodeHuCardCtr })\n    private nodeHuCard: NodeHuCardCtr = null;\n\n    // 闹钟节点\n    @property({ tooltip: \"闹钟节点\", type: NodeClockCtr })\n    private nodeClock: NodeClockCtr = null;\n\n    // 色子节点\n    @property({ tooltip: \"色子节点\", type: NodeDiceCtr })\n    private nodeDice: NodeDiceCtr = null;\n\n    // 杠牌数 计数，用于界面逻辑\n    private _gangCount: number = 0;\n\n    /** 音效配置 */\n    private _soundConfig = [\"wan\", \"tong\", \"tiao\", \"feng\", \"jian\"];\n\n    constructor() {\n        super()\n        console.log(\"==============飞小鸡游戏桌子初始化========\");\n        this.init();\n    }\n\n    //加载初始化\n    init() {\n        FXJController.getInstance().GameDeskCtr = this;\n    }\n\n    /** override 初始化模块事件 */\n    protected onInitModuleEvent() {\n        // 游戏开始\n        this.addModelListener(GameEvent.VIEW_BROADCAST_GAME_START, this.onGameStart);\n        // 摇色子\n        this.addModelListener(GameEvent.VIEW_BROADCAST_ZHI_TOU, this.onRollDices);\n        // 发牌\n        this.addModelListener(GameEvent.VIEW_BROADCAST_DEAL_CARD, this.onDealCard);\n        // 操作开始\n        this.addModelListener(GameEvent.VIEW_BROADCAST_OPERATION_START, this.onOperationStart);\n        // 操作选项\n        this.addModelListener(GameEvent.VIEW_USER_OPERATION, this.onOperationSelect);\n        // 出牌 吃碰杠 胡\n        this.addModelListener(GameEvent.UPDATE_USER_OPERATION_RESULT, this.onOperationResult);\n        // 抓牌\n        this.addModelListener(GameEvent.VIEW_BROADCAST_GRAB_CARD, this.onTakeCard);\n        // 游戏结束\n        this.addModelListener(GameEvent.VIEW_BROADCAST_GAME_OVER, this.onGameOver);\n        \n        this.addModelListener(GameEvent.RECEIVE_DEAL_CARD, this.onReconnect);\n        \n    };\n\n    onLoad() {\n        this.initData()\n        this.initView()\n    };\n\n\n    start() {\n\n    };\n\n    /** 初始化数据 */\n    initData() {\n\n    };\n\n    /** 初始化界面 */\n    initView() {\n\n    };\n\n    /** 更新界面 */\n    updateView() {\n\n    };\n\n    /** 重置界面 */\n    resetView() {\n        this._gangCount = 0;\n    }\n\n    /** 换位 */\n    OnChangedSeat(hostDir: number) {\n        this.nodeWall.OnChangedSeat(hostDir);\n        this.nodeHandCard.OnChangedSeat(hostDir);\n        this.nodeOutCard.OnChangedSeat(hostDir);\n        this.nodeMeldCard.OnChangedSeat(hostDir);\n        this.nodeHuCard.OnChangedSeat(hostDir);\n        this.nodeClock.OnChangedSeat(hostDir);\n    }\n\n    // 牌墙 ---------------------------------------------------------------------\n    /** 开始游戏 */\n    onGameStart() {\n        this.log(\"GameDeskPrefabCtr.onGameStart\");\n        // 需要根据玩家位置旋转方位\n        let hostDir = RoomMgr.getInstance().mySeatId - 1;\n        this.node.setRotationFromEuler(0, -90 * hostDir, 0);\n        this.nodeDesk.setRotationFromEuler(0, 90 * hostDir, 0); // 为了保留桌子水印，反向旋转桌子\n        this.resetView();\n        \n        this.nodeWall.onGameStart();\n        this.nodeHandCard.onGameStart();\n        this.nodeOutCard.onGameStart();\n        this.nodeMeldCard.onGameStart();\n        this.nodeHuCard.onGameStart();\n        this.nodeClock.onGameStart();\n\n        let dataAnim: GameViewConfig.AnimConfig = {\n            seatId : RoomMgr.getInstance().mySeatId,\n            aniType : GameViewConfig.AnimType.GameStart,\n        }\n        EventManager.dispatch(FXJEvent.VIEW_OUT_CARD_ANI_PLAY, dataAnim);\n    }\n\n    /** 摇色子 */\n    onRollDices(event, data: Game.IRollDice) {\n        this.log(\"GameDeskPrefabCtr.onRollDices\", data);\n\n        if (Utils.isNull(data) || Utils.table_isEmpty(data.diceInfo)) {\n            this.log(\"GameDeskPrefabCtr.onRollDices\", \"数据异常\", data);\n            return;\n        }\n\n        let bankerSeatId = data.diceInfo[0].seatId;\n        let diceList = data.diceInfo[0].dices;\n\n        if (Utils.isNull(bankerSeatId) || bankerSeatId < 1 || bankerSeatId > 4) {\n            this.log(\"GameDeskPrefabCtr.onRollDices\", \"庄家座位非法\", bankerSeatId);\n            return;\n        }\n\n        if (Utils.table_isEmpty(diceList) || diceList.length != 2) {\n            this.log(\"GameDeskPrefabCtr.onRollDices\", \"骰子数量非法\", diceList);\n            return;\n        }\n\n        for (let i = 0; i < diceList.length; i++) {\n            let dice = diceList[i];\n            if (dice < 1 || dice > 6) {\n                this.log(\"GameDeskPrefabCtr.onRollDices\", \"骰子数值非法\", diceList);\n                return;\n            }\n        }\n\n        this.nodeWall.onRollDices(data);\n        this.nodeDice.onRollDices(data);\n    }\n\n    /** 发牌 */\n    onDealCard(event, data: Game.IDealCard) {\n        this.log(\"GameDeskPrefabCtr.onDealCard\", data);\n        if (Utils.isNull(data) || Utils.table_isEmpty(data.cards)) {\n            this.log(\"GameDeskPrefabCtr.onDealCard\", \"没有手牌数据\");\n            return;\n        }\n\n        this.nodeWall.onDealCard(data);\n        this.nodeHandCard.onDealCard(data);\n    }\n\n    /** 操作开始 */\n    onOperationStart(event, data: Game.IFixBanker) {\n        this.log(\"GameDeskPrefabCtr.onOperationStart\", data);\n        \n        this.nodeClock.onOperationStart(data);\n        this.nodeDice.onOperationStart(data);\n    }\n\n    /** 操作选项 */\n    onOperationSelect(event, data: Game.IOperation) {\n        this.log(\"GameDeskPrefabCtr.onOperationSelect\", data);\n\n        this.nodeClock.onOperationSelect(data);\n    }\n\n    /** 操作结果 */\n    onOperationResult(event, data: Game.IOperationResult) {\n        if (Utils.isNull(data) || Utils.isNull(data.seatId) || Utils.isNull(data.opCode)) {\n            this.log(\"GameDeskPrefabCtr.onOperationResult\", \"数据异常\", data);\n            return;\n        }\n        \n        \n        switch (data.opCode) {\n            case OPCode.OPE_OUT_CARD: // 出牌\n                this.onOutCard(event, data);       \n                break;\n            case OPCode.OPE_RIGHT_CHI: // 右吃\n            case OPCode.OPE_MIDDLE_CHI: // 中吃\n            case OPCode.OPE_LEFT_CHI: // 左吃\n            case OPCode.OPE_PENG: // 碰\n            case OPCode.OPE_QIANG_PENG: // 抢碰\n                this.onPengGang(event, data)\n                break;\n            case OPCode.OPE_AN_GANG: // 暗杠\n            case OPCode.OPE_GANG: // 杠\n            case OPCode.OPE_BU_GANG: // 补杠\n                this.onPengGang(event, data)\n                this._gangCount++;\n                break;\n            case OPCode.OPE_HU: // 胡\n            case OPCode.OPE_ZI_MO: // 自摸\n                this.onHu(event, data)\n                break;\n            case OPCode.OPE_DIAO:// 调牌\n                break;\n            default:\n                break;\n        }\n\n        this.playEffect(event, data);\n    }\n\n    private playEffect(event, data: Game.IOperationResult) {\n        let roleName = \"xiaobo\"\n        let player = PlayerMgr.getInstance().findPlayerWithSeatId(data.seatId);\n        if (Utils.isNotNull(player)) {\n            let sex = Utils.number_valueOf(player.gameUserInfo.sex);\n            if (sex == 2) {\n                roleName = \"xiaoya\"\n            }\n        }\n\n        switch (data.opCode) {\n            case OPCode.OPE_OUT_CARD: // 出牌\n                let cardValue = data.opCard >> 8 & 0x0F;\n                let cardType = data.opCard >> 12;\n                if (Utils.isNotNull(this._soundConfig[cardType])) {\n                    let path = Utils.string_format(FXJSound.GameDiscard.path, roleName, this._soundConfig[cardType], cardValue)\n                    EventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, {bundle: FXJSound.GameDiscard.bundle, path: path});\n                }\n                break;\n            case OPCode.OPE_RIGHT_CHI: // 右吃\n            case OPCode.OPE_MIDDLE_CHI: // 中吃\n            case OPCode.OPE_LEFT_CHI: // 左吃\n                EventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, {bundle: FXJSound.GameChi.bundle, path: Utils.string_format(FXJSound.GameChi.path, roleName)});\n                break;\n            case OPCode.OPE_PENG: // 碰\n            case OPCode.OPE_QIANG_PENG: // 抢碰\n                EventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, {bundle: FXJSound.GamePeng.bundle, path: Utils.string_format(FXJSound.GamePeng.path, roleName)});\n                break;\n            case OPCode.OPE_AN_GANG: // 暗杠\n            case OPCode.OPE_GANG: // 杠\n            case OPCode.OPE_BU_GANG: // 补杠\n                EventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, {bundle: FXJSound.GameGang.bundle, path: Utils.string_format(FXJSound.GameGang.path, roleName)});\n                break;\n            case OPCode.OPE_HU: // 胡\n                EventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, {bundle: FXJSound.GameHu.bundle, path: Utils.string_format(FXJSound.GameHu.path, roleName)});\n                break;\n            case OPCode.OPE_ZI_MO: // 自摸\n                EventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, {bundle: FXJSound.GameZiMo.bundle, path: Utils.string_format(FXJSound.GameZiMo.path, roleName)});\n                break;\n            case OPCode.OPE_DIAO:// 调牌\n                break;\n            default:\n                break;\n        }\n    }\n\n    /** 抓牌 */\n    onTakeCard(event, data: Game.IGrabCard) {\n        \n        if (Utils.isNull(data)) {\n            this.log(\"GameDeskPrefabCtr.onTakeCard\", \"没有抓牌数据\");\n            return;\n        }\n\n        let dataTakeCard = {\n            seatId: data.seatId,\n            gangCount: this._gangCount,\n            remian: data.remainCardNum,\n        }\n        this.log(\"GameDeskPrefabCtr.onTakeCard\", dataTakeCard);\n        this.nodeWall.onTakeCard(dataTakeCard);\n        this.nodeHandCard.onTakeCard(dataTakeCard);\n        this.nodeClock.onTakeCard(dataTakeCard);\n    }\n\n    // 出牌 ---------------------------------------------------------------------\n    /** 出牌 */\n    onOutCard(event, data: Game.IOperationResult) {\n        this.log(\"GameDeskPrefabCtr.onOutCard\", data);\n        if (Utils.isNull(data) || Utils.isNull(data.seatId) || Utils.isNull(data.opCard)) {\n            this.log(\"GameDeskPrefabCtr.onOutCard\", \"出牌数据错误\");\n            return;\n        }\n\n        this.nodeOutCard.onOutCard(data);\n        this.nodeHandCard.onOutCard(data);\n    }\n\n    /** 碰杠 */\n    onPengGang(event, data: Game.IOperationResult) {\n        if (Utils.isNull(data) || Utils.isNull(data.seatId) || Utils.isNull(data.cardSeatId) || Utils.isNull(data.opCard)) {\n            this.log(\"GameDeskPrefabCtr.onPengGang\", \"碰杠数据错误\");\n            return;\n        }\n\n        if (data.cardSeatId == 0) {\n            this.log(\"GameDeskPrefabCtr.onPengGang\", \"无效座位号\");\n            return;\n        }\n\n        this.log(\"GameDeskPrefabCtr.onPengGang\", data);\n        \n        this.nodeOutCard.onPengGang(data);\n        this.nodeHandCard.onPengGang(data);\n        this.nodeMeldCard.onPengGang(data);\n    }\n\n    /** 胡牌 */\n    onHu(event, data: Game.IOperationResult) {\n        if (Utils.isNull(data) || Utils.isNull(data.seatId) || Utils.isNull(data.cardSeatId) || Utils.isNull(data.opCard)) {\n            this.log(\"GameDeskPrefabCtr.onHu\", \"胡牌数据错误\");\n            return;\n        }\n\n        if (data.cardSeatId == 0) {\n            this.log(\"GameDeskPrefabCtr.onHu\", \"无效座位号\");\n            return;\n        }\n\n        this.log(\"GameDeskPrefabCtr.onHu\", data);\n\n        this.nodeOutCard.onHu(data);\n        this.nodeHandCard.onHu(data);\n        this.nodeHuCard.onHu(data);\n    }\n\n    /** 清理 */\n    onGameOver(event, data: Game.IHandCards) {\n        this.log(\"GameDeskPrefabCtr.onGameOver\", data);\n        if (Utils.isNull(data) || Utils.table_isEmpty(data.handCards)) {\n            this.log(\"GameDeskPrefabCtr.onGameOver\", \"结算数据错误\");\n            return;\n        }\n\n        this.nodeWall.onGameOver(data);\n        this.nodeHandCard.onGameOver(data);\n        this.nodeOutCard.onGameOver(data);\n        this.nodeMeldCard.onGameOver(data);\n        this.nodeHuCard.onGameOver(data);\n        this.nodeClock.onGameOver(data);\n\n        let dataAnim: GameViewConfig.AnimConfig = {\n            seatId : RoomMgr.getInstance().mySeatId,\n            aniType : GameViewConfig.AnimType.GameStart,\n        }\n        EventManager.dispatch(FXJEvent.VIEW_OUT_CARD_ANI_PLAY, dataAnim);\n    }\n\n\n    // ---------------------------------------------------------------------\n\n    /** 重连 */\n    onReconnect() {\n        let data = {\n            bankSeatId: RoomMgr.getInstance().bankSeatId,\n            dices: RoomMgr.getInstance().dices,\n            remain: RoomMgr.getInstance().remainCardsCount,\n            gangCount: 0,\n            playerList: PlayerMgr.getInstance().playerList,\n            operationSeatId: OperationMgr.getInstance().seatId,\n            operationTimePass: RoomMgr.getInstance().timePass,\n        }\n\n        if (Utils.isNull(data) || Utils.table_isEmpty(data.dices)) {\n            this.log(\"GameDeskPrefabCtr.onReconnect\", \"数据异常\", data);\n            return;\n        }\n\n        if (Utils.isNull(data.bankSeatId) || data.bankSeatId < 1 || data.bankSeatId > 4) {\n            this.log(\"GameDeskPrefabCtr.onReconnect\", \"庄家座位非法\", data.bankSeatId);\n            return;\n        }\n\n        if (Utils.table_isEmpty(data.dices) || data.dices.length != 2) {\n            this.log(\"GameDeskPrefabCtr.onReconnect\", \"骰子数量非法\", data);\n            return;\n        }\n\n        for (let i = 0; i < data.dices.length; i++) {\n            let dice = data.dices[i];\n            if (dice < 1 || dice > 6) {\n                this.log(\"GameDeskPrefabCtr.onReconnect\", \"骰子数值非法\", data);\n                return;\n            }\n        }\n\n        if (Utils.table_isEmpty(data.playerList)) {\n            this.log(\"GameDeskPrefabCtr.onReconnect\", \"玩家数据异常\", data);\n            return;\n        }\n\n        data.playerList.forEach((value, index, array) => {\n            for (let i = 0; i < value.opGroups.length; i++) { \n                let dataItem = value.opGroups[i];\n                switch (dataItem.opCode) {\n                    case OPCode.OPE_AN_GANG: // 暗杠\n                        data.gangCount++;\n                        break;\n                    case OPCode.OPE_GANG: // 杠\n                        data.gangCount++;\n                        break;\n                    case OPCode.OPE_BU_GANG: // 补杠\n                        data.gangCount++;\n                        break;\n                    default:\n                        break;\n                }\n            }\n        });\n        \n        this._gangCount = data.gangCount;\n        \n        this.nodeWall.onReconnect(data);\n        this.nodeHandCard.onReconnect(data);\n        this.nodeOutCard.onReconnect(data);\n        this.nodeMeldCard.onReconnect(data);\n        this.nodeHuCard.onReconnect(data);\n        this.nodeClock.onReconnect(data);\n    }   \n\n    //销毁\n    onDestroy() {\n\n    };\n\n    log(...args: any[]) {\n        console.log(args);\n\t}\n\n}\n\n"]}