{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/framework/crypto/UTF.ts"],"names":["UTF16_to_UTF8","src","dst","c1","c2","Encode_UTF16_to_UTF8","cp","Encode_UTF8","UTF8_to_UTF16","Decode_UTF8_to_UTF16","funcSrc","Decode_UTF8","a","b","c","d","fail","slice","indexOf","err","Error","toString","name","RangeError","UTF"],"mappings":"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","sourcesContent":["/**\n * Name = UTF\n * URL = db://assets/framework/crypto/UTF.ts\n * Time = Mon Apr 18 2022 20:45:37 GMT+0800 (中国标准时间)\n * Author = xueya\n * utf相关\n */\n\nexport module UTF {\n\n\texport function UTF16_to_UTF8(src, dst) {\n\t\tlet c1, c2 = null;\n\t\twhile (true) {\n\t\t\tif ((c1 = c2 !== null ? c2 : src()) === null)\n\t\t\t\tbreak;\n\t\t\tif (c1 >= 0xD800 && c1 <= 0xDFFF) {\n\t\t\t\tif ((c2 = src()) !== null) {\n\t\t\t\t\tif (c2 >= 0xDC00 && c2 <= 0xDFFF) {\n\t\t\t\t\t\tdst((c1 - 0xD800) * 0x400 + c2 - 0xDC00 + 0x10000);\n\t\t\t\t\t\tc2 = null; continue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tdst(c1);\n\t\t}\n\t\tif (c2 !== null) dst(c2);\n\t}\n\t/**编码  UTF16toUTF8 */\n\texport function Encode_UTF16_to_UTF8(src, dst) {\n\t\tUTF16_to_UTF8(src, function (cp) {\n\t\t\tEncode_UTF8(cp, dst);\n\t\t});\n\t};\n\texport function Encode_UTF8(src, dst) {\n\t\tvar cp = null;\n\t\tif (typeof src === 'number') {\n\t\t\tcp = src,\n\t\t\t\tsrc = function () { return null; };\n\t\t}\n\t\twhile (cp !== null || (cp = src()) !== null) {\n\t\t\tif (cp < 0x80)\n\t\t\t\tdst(cp & 0x7F);\n\t\t\telse if (cp < 0x800)\n\t\t\t\tdst(((cp >> 6) & 0x1F) | 0xC0),\n\t\t\t\t\tdst((cp & 0x3F) | 0x80);\n\t\t\telse if (cp < 0x10000)\n\t\t\t\tdst(((cp >> 12) & 0x0F) | 0xE0),\n\t\t\t\t\tdst(((cp >> 6) & 0x3F) | 0x80),\n\t\t\t\t\tdst((cp & 0x3F) | 0x80);\n\t\t\telse\n\t\t\t\tdst(((cp >> 18) & 0x07) | 0xF0),\n\t\t\t\t\tdst(((cp >> 12) & 0x3F) | 0x80),\n\t\t\t\t\tdst(((cp >> 6) & 0x3F) | 0x80),\n\t\t\t\t\tdst((cp & 0x3F) | 0x80);\n\t\t\tcp = null;\n\t\t}\n\t};\n\texport function UTF8_to_UTF16(src, dst) {\n\t\tvar cp = null;\n\t\tif (typeof src === 'number')\n\t\t\tcp = src, src = function () { return null; };\n\t\twhile (cp !== null || (cp = src()) !== null) {\n\t\t\tif (cp <= 0xFFFF)\n\t\t\t\tdst(cp);\n\t\t\telse\n\t\t\t\tcp -= 0x10000,\n\t\t\t\t\tdst((cp >> 10) + 0xD800),\n\t\t\t\t\tdst((cp % 0x400) + 0xDC00);\n\t\t\tcp = null;\n\t\t}\n\t};\n\n\t/**解码 */\n\texport function Decode_UTF8_to_UTF16(funcSrc, dst) {\n\t\tDecode_UTF8(funcSrc, function (cp) {\n\t\t\tUTF8_to_UTF16(cp, dst);\n\t\t});\n\t};\n\n\texport function Decode_UTF8(funcSrc, dst) {\n\t\tvar a, b, c, d, fail = function (b) {\n\t\t\tb = b.slice(0, b.indexOf(null));\n\t\t\tvar err = Error(b.toString());\n\t\t\terr.name = \"TruncatedError\";\n\t\t\terr['bytes'] = b;\n\t\t\tthrow err;\n\t\t};\n\t\twhile ((a = funcSrc()) !== null) {\n\t\t\tif ((a & 0x80) === 0)\n\t\t\t\tdst(a);\n\t\t\telse if ((a & 0xE0) === 0xC0)\n\t\t\t\t((b = funcSrc()) === null) && fail([a, b]),\n\t\t\t\t\tdst(((a & 0x1F) << 6) | (b & 0x3F));\n\t\t\telse if ((a & 0xF0) === 0xE0)\n\t\t\t\t((b = funcSrc()) === null || (c = funcSrc()) === null) && fail([a, b, c]),\n\t\t\t\t\tdst(((a & 0x0F) << 12) | ((b & 0x3F) << 6) | (c & 0x3F));\n\t\t\telse if ((a & 0xF8) === 0xF0)\n\t\t\t\t((b = funcSrc()) === null || (c = funcSrc()) === null || (d = funcSrc()) === null) && fail([a, b, c, d]),\n\t\t\t\t\tdst(((a & 0x07) << 18) | ((b & 0x3F) << 12) | ((c & 0x3F) << 6) | (d & 0x3F));\n\t\t\telse throw RangeError(\"Illegal starting byte: \" + a);\n\t\t}\n\t};\n\n\n}\n\n"]}