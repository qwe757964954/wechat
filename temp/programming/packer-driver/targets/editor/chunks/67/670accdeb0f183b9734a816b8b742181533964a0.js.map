{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/module/match/src/Player.ts"],"names":["Label","Node","sp","Sprite","SpriteAtlas","_decorator","GCache","resLoader","BaseComponent","FXJRes","NodeHead","ccclass","property","Player","Skeleton","seatId","onInitModuleEvent","changeSkin","sex","spineConfig","Spine_XiaoYa","Spine_XiaoBo","load","bundle","path","SkeletonData","err","spineAsset","player","console","log","skeletonData","ani","setAnimation","changeHeadBg","userId","frameName","User","getUserMid","Prefab_Match_Image","atlas","spriteFrame","getSpriteFrame","y_head_bg","updatePlayerProperty","playerInfo","JSON","parse","strUserInfo","nick_name","string","nickName","nodeHeadCtr","headNode","getComponent","updateUserHead","updateUserHeadBox"],"mappings":"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","sourcesContent":["\nimport { Label, Node, sp, Sprite, SpriteAtlas, _decorator } from 'cc';\nimport { GCache } from '../../../../../cache/GCache';\nimport { resLoader } from '../../../../../framework/loader/ResLoader';\nimport { BaseComponent } from '../../../../../framework/vc/BaseComponent';\nimport { FXJRes } from '../../../common/FXJRes';\nimport { Common } from '../../../common/idl/Common';\nimport { NodeHead } from '../../settle/src/NodeHead';\nconst { ccclass, property } = _decorator;\n\n/**\n * Name = Player\n * URL = db://assets/package/game/module/match/src/Player.ts\n * Time = Fri Aug 04 2023 14:49:13 GMT+0800 (中国标准时间)\n * Author = qwe757964\n *\n * Life: onLoad-->onInitModuleEvent-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n * \n */\n\n@ccclass('Player')\nexport class Player extends BaseComponent {\n\n\t@property(Label)\n\tpublic nick_name: Label | null = null;\n\n\t@property(Sprite)\n\tpublic y_head_bg: Sprite | null = null;\n\n\t@property(Node)\n\tpublic headNode: Node | null = null;\n\n\t@property(sp.Skeleton)\n\tpublic player: sp.Skeleton = null;\n\n\tpublic seatId?: number = 0;\n\n\n\n\t/** override 初始化模块事件 */\n\tprotected onInitModuleEvent() {\n\n\t};\n\n\tchangeSkin(sex: number) {\n\t\tlet spineConfig: any = sex == 2 ? FXJRes.Spine_XiaoYa : FXJRes.Spine_XiaoBo;\n\t\tresLoader.load(spineConfig.bundle, spineConfig.path, sp.SkeletonData, (err, spineAsset) => {\n\t\t\tif (err || this.player === null) {\n\t\t\t\tconsole.log(\"Failed to load asset\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// let comp = this.getComponent('sp.Skeleton') as sp.Skeleton;\n\t\t\tthis.player.skeletonData = spineAsset!;\n\t\t\tlet ani = this.player.setAnimation(0, 'idle1', true);\n\t\t\tconsole.log(\"Load Success\");\n\t\t})\n\t}\n\tchangeHeadBg(userId: number) {\n\t\t// let spriteLoad = this.y_head_bg.getComponent(SpriteLoad);\n\t\tlet frameName: string = \"\"\n\t\tif (GCache.User.getUserMid() === userId) {\n\t\t\tframeName = \"r_head_bg\";\n\t\t} else {\n\t\t\tframeName = \"y_head_bg\";\n\t\t}\n\n\t\tresLoader.load(FXJRes.Prefab_Match_Image.bundle, FXJRes.Prefab_Match_Image.path, SpriteAtlas, (err: Error | null, atlas) => {\n\t\t\tif (err) {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tlet spriteFrame = atlas.getSpriteFrame(frameName)\n\t\t\tif (spriteFrame && this.y_head_bg) {\n\t\t\t\tthis.y_head_bg.spriteFrame = spriteFrame;\n\t\t\t}\n\t\t})\n\t}\n\tpublic updatePlayerProperty(player: Common.IPlayerInfo) {\n\t\tthis.seatId = player.seatId;\n\t\tlet playerInfo: Common.GameUserInfo = JSON.parse(player.strUserInfo)\n\t\tthis.nick_name.string = playerInfo.nickName;\n\t\tlet nodeHeadCtr = this.headNode.getComponent(NodeHead)\n\t\tnodeHeadCtr.updateUserHead(playerInfo);\n\t\tnodeHeadCtr.updateUserHeadBox(playerInfo);\n\t\tthis.changeSkin(playerInfo.sex);\n\t\tthis.changeHeadBg(player.userId);\n\t}\n}\n\n"]}