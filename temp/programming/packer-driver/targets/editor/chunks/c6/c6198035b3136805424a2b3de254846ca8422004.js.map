{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/cache/PlayerMgr.ts"],"names":["PlayerMgr","BaseCache","MahjongMap","CardUtil","RoomMgr","constructor","name","playerList","handOpGroup","myPlayerInfo","gangCount","observers","getInstance","instance","addObserver","observer","push","removeObserver","index","indexOf","splice","setPlayerList","data","parseUseInfo","sortPlayersBySeatId","mySeatId","resertPlayer","notifyObservers","updatePlayerList","getOpIndexs","opCards","myPlayer","getMyPlayerInfo","indexs","i","length","handCards","updateMyhands","nums","getMyhands","getHandCardByIndex","deleteMyHands","bytes","getIndexByHandCards","insertCard","removeCard","myCards","cards","getCardValue","card","checkIndex","dumpMyHands","majiangMap","cardStr","get","console","log","updatePlayerCardsNum","cardsCount","player","findPlayerWithSeatId","cardCount","findOtherPlayer","filter","user","seatId","findPlayerWithUserId","userId","addPlayerList","info","Array","isArray","newItems","item","some","exists","forEach","gameUserInfo","JSON","parse","strUserInfo","deletePlayerList","otherItem","clear","getPlayerReadyStatus","isReady","updatePlayerReadyStatus","updatePlayerMoney","moneys","money","updateOutCards","resp","status","outCards","updateHandCards","huCard","opGroups","tingCard","isUnTing","customData","deletePlayerLeave","updatePlayerAiStatus","isAi"],"mappings":";;;wEAkBaA,S;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAhBJC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,U,iBAAAA,U;;AAGAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,O,iBAAAA,O;;;;;;;2BAWIJ,S,GAAN,MAAMA,SAAN;AAAA;AAAA,kCAAkC;AASrCK,QAAAA,WAAW,CAACC,IAAI,GAAG,EAAR,EAAY;AACzB,gBAAMA,IAAN;AADyB,eARhBC,UAQgB,GARoB,EAQpB;AAAA,eAPhBC,WAOgB,GAPoB,IAOpB;AAAA,eANhBC,YAMgB,GANoB,IAMpB;AAAA,eALnBC,SAKmB,GALE,CAKF;AAAA,eAJnBC,SAImB,GAJK,EAIL;AAEzB;;AAC2B,eAAXC,WAAW,GAAc;AACnC,cAAI,CAACZ,SAAS,CAACa,QAAf,EAAyB;AACrBb,YAAAA,SAAS,CAACa,QAAV,GAAqB,IAAIb,SAAJ,EAArB;AACH;;AACD,iBAAOA,SAAS,CAACa,QAAjB;AACH;;AACJC,QAAAA,WAAW,CAACC,QAAD,EAAqB;AAC/B,eAAKJ,SAAL,CAAeK,IAAf,CAAoBD,QAApB;AACA,SApBuC,CAsBtC;;;AACFE,QAAAA,cAAc,CAACF,QAAD,EAAqB;AAClC,gBAAMG,KAAK,GAAG,KAAKP,SAAL,CAAeQ,OAAf,CAAuBJ,QAAvB,CAAd;;AACA,cAAIG,KAAK,KAAK,CAAC,CAAf,EAAkB;AACjB,iBAAKP,SAAL,CAAeS,MAAf,CAAsBF,KAAtB,EAA6B,CAA7B;AACA;AACD,SA5BuC,CA8BtC;;;AAEKG,QAAAA,aAAa,CAACC,IAAD,EAAmC;AACtD,eAAKC,YAAL,CAAkBD,IAAlB;AACA,eAAKf,UAAL,GAAkB;AAAA;AAAA,oCAASiB,mBAAT,CAA6BF,IAA7B,EAAkC;AAAA;AAAA,kCAAQV,WAAR,GAAsBa,QAAxD,CAAlB;AACA;;AAEMC,QAAAA,YAAY,GAAO;AACzB,eAAKnB,UAAL,GAAkB,EAAlB;AACA;;AAEMoB,QAAAA,eAAe,GAAS;AAC9B,eAAK,MAAMZ,QAAX,IAAuB,KAAKJ,SAA5B,EAAuC;AACpCI,YAAAA,QAAQ,CAACa,gBAAT,CAA0B,KAAKrB,UAA/B;AACF;AACD;;AAEMsB,QAAAA,WAAW,CAACC,OAAD,EAA2B;AAC5C,cAAIC,QAA2B,GAAG/B,SAAS,CAACY,WAAV,GAAwBoB,eAAxB,EAAlC;AACA,cAAIC,MAAe,GAAG,EAAtB;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,OAAO,CAACK,MAA5B,EAAoCD,CAAC,EAArC,EAAyC;AACxC,kBAAMhB,KAAK,GAAGa,QAAQ,CAACK,SAAT,CAAmBjB,OAAnB,CAA2BW,OAAO,CAACI,CAAD,CAAlC,CAAd,CADwC,CAExC;;AACA,gBAAGhB,KAAK,KAAK,CAAC,CAAd,EAAgB;AACfe,cAAAA,MAAM,CAACjB,IAAP,CAAYE,KAAZ;AACA;AACD;;AACD,iBAAOe,MAAP;AACA;;AAEMI,QAAAA,aAAa,CAACC,IAAD,EAAe;AAClC,cAAIP,QAA2B,GAAG/B,SAAS,CAACY,WAAV,GAAwBoB,eAAxB,EAAlC;AACAD,UAAAA,QAAQ,CAACK,SAAT,GAAqBE,IAArB;AACA;;AAEMC,QAAAA,UAAU,GAAY;AAC5B,cAAIR,QAA2B,GAAG/B,SAAS,CAACY,WAAV,GAAwBoB,eAAxB,EAAlC;AACA,iBAAOD,QAAQ,CAACK,SAAhB;AACA;;AAEMI,QAAAA,kBAAkB,CAACtB,KAAD,EAAqB;AAC7C,cAAIa,QAA2B,GAAG/B,SAAS,CAACY,WAAV,GAAwBoB,eAAxB,EAAlC;AACA,iBAAOD,QAAQ,CAACK,SAAT,CAAmBlB,KAAnB,CAAP;AACA;;AAEDuB,QAAAA,aAAa,CAACC,KAAD,EAAgB,CAE5B,CA7EuC,CA+ExC;;;AACUC,QAAAA,mBAAmB,CAACC,UAAD,EAAqBC,UAArB,EAAiD;AACvE,cAAIC,OAAO,GAAG,KAAKP,UAAL,EAAd;AACA,cAAIQ,KAAK,GAAG,CAAC,GAAGD,OAAJ,CAAZ;;AACA,eAAK,IAAIZ,CAAC,GAAGa,KAAK,CAACZ,MAAN,GAAe,CAA5B,EAA+BD,CAAC,IAAI,CAApC,EAAuCA,CAAC,EAAxC,EAA4C;AAAE;AAC1C,gBAAIa,KAAK,CAACb,CAAD,CAAL,KAAaW,UAAjB,EAA6B;AACzBE,cAAAA,KAAK,CAAC3B,MAAN,CAAac,CAAb,EAAgB,CAAhB;AACA;AACH;AACJ,WARsE,CASvE;AACN;;;AACA,cAAG;AAAA;AAAA,oCAASc,YAAT,CAAsBJ,UAAtB,MAAsC,MAAzC,EAAgD;AAC/C,mBAAO,CAAP;AACA;;AAEK,eAAK,IAAI1B,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAG6B,KAAK,CAACZ,MAAlC,EAA0CjB,KAAK,EAA/C,EAAmD;AAC/C,gBAAI+B,IAAI,GAAGF,KAAK,CAAC7B,KAAD,CAAhB;AACT,gBAAIgC,UAAJ;;AACS,gBAAID,IAAI,IAAIL,UAAZ,EAAwB;AACpBM,cAAAA,UAAU,GAAGhC,KAAb;AACH,aAFD,MAEO,IAAI+B,IAAI,GAAGL,UAAP,IAAqB1B,KAAK,GAAG,CAAR,GAAY6B,KAAK,CAACZ,MAAvC,IAAiDS,UAAU,IAAIG,KAAK,CAAC7B,KAAK,GAAG,CAAT,CAAxE,EAAqF;AACxFgC,cAAAA,UAAU,GAAGhC,KAAK,GAAG,CAArB;AACH,aAFM,MAEA,IAAIA,KAAK,IAAI6B,KAAK,CAACZ,MAAN,GAAe,CAAxB,IAA6BS,UAAU,GAAGK,IAA9C,EAAoD;AACvDC,cAAAA,UAAU,GAAGH,KAAK,CAACZ,MAAnB;AACH;;AAED,gBAAIe,UAAJ,EAAgB;AACZ,qBAAOA,UAAP;AACH;AACJ;;AAED,iBAAO,CAAP;AACH;;AAEGC,QAAAA,WAAW,GAAE;AACnB,cAAIpB,QAA2B,GAAG/B,SAAS,CAACY,WAAV,GAAwBoB,eAAxB,EAAlC;AACA,cAAIoB,UAAmB,GAAG,EAA1B;;AACA,eAAK,IAAIlB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,QAAQ,CAACK,SAAT,CAAmBD,MAAvC,EAA+CD,CAAC,EAAhD,EAAoD;AAC1C,gBAAImB,OAAO,GAAG;AAAA;AAAA,sCAASL,YAAT,CAAsBjB,QAAQ,CAACK,SAAT,CAAmBF,CAAnB,CAAtB,CAAd;AACTkB,YAAAA,UAAU,CAACpC,IAAX,CAAgB;AAAA;AAAA,0CAAWsC,GAAX,CAAeD,OAAf,CAAhB;AACM;;AACPE,UAAAA,OAAO,CAACC,GAAR,CAAY,mCAAZ,EAAgDJ,UAAhD;AACA;;AAEMK,QAAAA,oBAAoB,CAACC,UAAD,EAAqB;AAC/C,eAAK,IAAIxB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGwB,UAAU,CAACvB,MAA/B,EAAuCD,CAAC,EAAxC,EAA4C;AAC3C,gBAAIyB,MAA0B,GAAG,KAAKC,oBAAL,CAA0B1B,CAAC,GAAC,CAA5B,CAAjC;AACAyB,YAAAA,MAAM,CAACE,SAAP,GAAmBH,UAAU,CAACxB,CAAD,CAA7B;AACA;AACD;;AAEM4B,QAAAA,eAAe,GAAuB;AAC5C,iBAAO,KAAKvD,UAAL,CAAgBwD,MAAhB,CAAuBC,IAAI,IAAIA,IAAI,CAACC,MAAL,KAAgB;AAAA;AAAA,kCAAQrD,WAAR,GAAsBa,QAArE,CAAP;AACA;;AAEMyC,QAAAA,oBAAoB,CAAEC,MAAF,EAAsC;AAChE,iBAAO,KAAK5D,UAAL,CAAgBwD,MAAhB,CAAuBC,IAAI,IAAIA,IAAI,CAACG,MAAL,KAAgBA,MAA/C,EAAuD,CAAvD,CAAP;AACA;;AAEMP,QAAAA,oBAAoB,CAAEK,MAAF,EAAsC;AAChE,iBAAO,KAAK1D,UAAL,CAAgBwD,MAAhB,CAAuBC,IAAI,IAAIA,IAAI,CAACC,MAAL,KAAgBA,MAA/C,EAAuD,CAAvD,CAAP;AACA;;AAEMjC,QAAAA,eAAe,GAAsB;AAC3C,eAAKvB,YAAL,GAAoB,KAAKmD,oBAAL,CAA0B;AAAA;AAAA,kCAAQhD,WAAR,GAAsBa,QAAhD,CAApB;AACA,iBAAO,KAAKhB,YAAZ;AACA,SAlJuC,CAoJrC;;;AACI2D,QAAAA,aAAa,CAACC,IAAD,EAAwD;AAC3E,eAAK9C,YAAL,CAAkB8C,IAAlB;;AACA,cAAIC,KAAK,CAACC,OAAN,CAAcF,IAAd,CAAJ,EAAyB;AACxB,kBAAMG,QAAQ,GAAGH,IAAI,CAACN,MAAL,CAAYU,IAAI,IAAI,CAAC,KAAKlE,UAAL,CAAgBmE,IAAhB,CAAqB,CAAC;AAAEP,cAAAA;AAAF,aAAD,KAAgBA,MAAM,KAAKM,IAAI,CAACN,MAArD,CAArB,CAAjB;AACA,iBAAK5D,UAAL,CAAgBS,IAAhB,CAAqB,GAAGwD,QAAxB;AACA,WAHD,MAGO;AAEN,kBAAMG,MAAM,GAAG,KAAKpE,UAAL,CAAgBmE,IAAhB,CAAqBV,IAAI,IAAIA,IAAI,CAACG,MAAL,KAAgBE,IAAI,CAACF,MAAlD,CAAf;;AACA,gBAAG,CAACQ,MAAJ,EAAW;AACV,mBAAKpE,UAAL,CAAgBS,IAAhB,CAAqBqD,IAArB;AACA;AACD;;AACD,eAAK9D,UAAL,GAAkB;AAAA;AAAA,oCAASiB,mBAAT,CAA6B,KAAKjB,UAAlC,EAA6C;AAAA;AAAA,kCAAQK,WAAR,GAAsBa,QAAnE,CAAlB;AACA,SAlKuC,CAmKxC;;;AACOF,QAAAA,YAAY,CAAC8C,IAAD,EAAiD;AACnE,cAAIC,KAAK,CAACC,OAAN,CAAcF,IAAd,CAAJ,EAAyB;AACxBA,YAAAA,IAAI,CAACO,OAAL,CAAaH,IAAI,IAAI;AACpBA,cAAAA,IAAI,CAACI,YAAL,GAAoBC,IAAI,CAACC,KAAL,CAAWN,IAAI,CAACO,WAAhB,CAApB;AACA,aAFD;AAGA,WAJD,MAIO;AACNX,YAAAA,IAAI,CAACQ,YAAL,GAAoBC,IAAI,CAACC,KAAL,CAAWV,IAAI,CAACW,WAAhB,CAApB;AACA;AACD,SA5KuC,CA6KxC;;;AACOC,QAAAA,gBAAgB,CAACZ,IAAD,EAAwD;AAC9E,cAAIC,KAAK,CAACC,OAAN,CAAcF,IAAd,CAAJ,EAAyB;AACxB,iBAAK9D,UAAL,GAAkB,KAAKA,UAAL,CAAgBwD,MAAhB,CAAwBU,IAAD,IACxC,CAACJ,IAAI,CAACK,IAAL,CAAWQ,SAAD,IAAeA,SAAS,CAACf,MAAV,KAAqBM,IAAI,CAACN,MAAnD,CADgB,CAAlB;AAGA,WAJD,MAIO;AACN,iBAAK5D,UAAL,GAAkB,KAAKA,UAAL,CAAgBwD,MAAhB,CAAuBU,IAAI,IAAIA,IAAI,CAACN,MAAL,KAAgBE,IAAI,CAACF,MAApD,CAAlB;AACA;;AACD,eAAK5D,UAAL,GAAkB;AAAA;AAAA,oCAASiB,mBAAT,CAA6B,KAAKjB,UAAlC,EAA6C;AAAA;AAAA,kCAAQK,WAAR,GAAsBa,QAAnE,CAAlB;AACA,SAvLuC,CA0LrC;;;AACI0D,QAAAA,KAAK,GAAS;AACpB,eAAK5E,UAAL,GAAkB,IAAlB;AACA;;AACD6E,QAAAA,oBAAoB,CAACjB,MAAD,EAAsB;AACzC,cAAIR,MAA0B,GAAG,KAAKO,oBAAL,CAA0BC,MAA1B,CAAjC;AACA,iBAAOR,MAAM,CAAC0B,OAAd;AACA;;AACDC,QAAAA,uBAAuB,CAACnB,MAAD,EAAqB;AAC3C,cAAIR,MAA0B,GAAG,KAAKO,oBAAL,CAA0BC,MAA1B,CAAjC;AACAR,UAAAA,MAAM,CAAC0B,OAAP,GAAiB,CAAjB;AACA;;AAEDE,QAAAA,iBAAiB,CAACC,MAAD,EAAuB;AACvC,eAAK,IAAItD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsD,MAAM,CAACrD,MAA3B,EAAmCD,CAAC,EAApC,EAAwC;AACvC,gBAAIyB,MAA0B,GAAG,KAAKC,oBAAL,CAA0B1B,CAAC,GAAC,CAA5B,CAAjC;AACAyB,YAAAA,MAAM,CAAC8B,KAAP,GAAeD,MAAM,CAACtD,CAAD,CAArB;AACA;AACD;;AAGDwD,QAAAA,cAAc,CAACC,IAAD,EAA4B;AACzC,cAAIhC,MAA0B,GAAG,KAAKO,oBAAL,CAA0ByB,IAAI,CAACxB,MAA/B,CAAjC;AACA,cAAIlB,IAAiB,GAAG;AACvBA,YAAAA,IAAI,EAAE0C,IAAI,CAAC1C,IADY;AAEvB2C,YAAAA,MAAM,EAAC;AAFgB,WAAxB;AAIAjC,UAAAA,MAAM,CAACkC,QAAP,CAAgB7E,IAAhB,CAAqBiC,IAArB;AACA;;AAED6C,QAAAA,eAAe,CAACH,IAAD,EAA4B;AAC1C,eAAK,IAAIzD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGyD,IAAI,CAACvD,SAAL,CAAeD,MAAnC,EAA2CD,CAAC,EAA5C,EAAgD;AAC/C,gBAAIyB,MAA0B,GAAG,KAAKC,oBAAL,CAA0B1B,CAAC,GAAC,CAA5B,CAAjC;AACAyB,YAAAA,MAAM,CAACvB,SAAP,GAAmBuD,IAAI,CAACvD,SAAL,CAAeF,CAAf,EAAkBE,SAArC;AACAuB,YAAAA,MAAM,CAACoC,MAAP,GAAgBJ,IAAI,CAACvD,SAAL,CAAeF,CAAf,EAAkB6D,MAAlC;AACApC,YAAAA,MAAM,CAACqC,QAAP,GAAkBL,IAAI,CAACvD,SAAL,CAAeF,CAAf,EAAkB8D,QAApC;AACArC,YAAAA,MAAM,CAACsC,QAAP,GAAkBN,IAAI,CAACvD,SAAL,CAAeF,CAAf,EAAkB+D,QAApC;AACAtC,YAAAA,MAAM,CAACuC,QAAP,GAAkBP,IAAI,CAACvD,SAAL,CAAeF,CAAf,EAAkBgE,QAApC;AACAvC,YAAAA,MAAM,CAACwC,UAAP,GAAoBR,IAAI,CAACvD,SAAL,CAAeF,CAAf,EAAkBiE,UAAtC;AACA;AACD,SAlOuC,CAoOxC;AACA;AACA;;;AAEAC,QAAAA,iBAAiB,CAACjC,MAAD,EAAqB;AACrC,eAAK5D,UAAL,GAAkB,KAAKA,UAAL,CAAgBwD,MAAhB,CAAuBU,IAAI,IAAIA,IAAI,CAACN,MAAL,KAAgBA,MAA/C,CAAlB;AACA;;AAEDkC,QAAAA,oBAAoB,CAAClC,MAAD,EAAemC,IAAf,EAAiC;AACpD,cAAI3C,MAA0B,GAAG,KAAKO,oBAAL,CAA0BC,MAA1B,CAAjC;AACAR,UAAAA,MAAM,CAAC2C,IAAP,GAAcA,IAAd;AACA;;AA/OuC,O;;AAA5BtG,MAAAA,S,CAQMa,Q,GAA6B,I","sourcesContent":["\n\nimport { BaseCache } from \"../../../framework/vc/BaseCache\";\nimport { MahjongMap } from \"../common/FXJConfig\";\nimport { Common } from \"../common/idl/Common\";\nimport { Game } from \"../common/idl/Game\";\nimport { CardUtil } from \"../util/CardUtil\";\nimport { RoomMgr } from \"./RoomMgr\";\n\nexport interface Observer {\n\tupdatePlayerList(data: Common.IPlayerInfo[]): void;\n\tupdateCardsCount():void;\n}\n\n\n  \n\n\nexport class PlayerMgr extends BaseCache {\n    public playerList?: Common.IPlayerInfo[] = [];\n    public handOpGroup?: Common.IHandOpGroup = null;\n    public myPlayerInfo?: Common.IPlayerInfo = null;\n\tpublic gangCount?: number = 0;\n\tpublic observers: Observer[] = [];\n\t\n\n    private static instance: PlayerMgr | null = null;\n    constructor(name = \"\") {\n\t\tsuper(name);\n\t};\n    public static getInstance(): PlayerMgr {\n        if (!PlayerMgr.instance) {\n            PlayerMgr.instance = new PlayerMgr();\n        }\n        return PlayerMgr.instance;\n    }\n\taddObserver(observer: Observer) {\n\t\tthis.observers.push(observer);\n\t}\n\t\n\t  // 取消注册观察者\n\tremoveObserver(observer: Observer) {\n\t\tconst index = this.observers.indexOf(observer);\n\t\tif (index !== -1) {\n\t\t\tthis.observers.splice(index, 1);\n\t\t}\n\t}\n\t\n\t  // 当数据发生变化时，通知所有观察者\n\n\tpublic setPlayerList(data: Common.IPlayerInfo[]): void {\n\t\tthis.parseUseInfo(data);\n\t\tthis.playerList = CardUtil.sortPlayersBySeatId(data,RoomMgr.getInstance().mySeatId);\n\t}\n\n\tpublic resertPlayer():void{\n\t\tthis.playerList = [];\n\t}\n\n\tpublic notifyObservers(): void {\n\t\tfor (const observer of this.observers) {\n\t\t  \tobserver.updatePlayerList(this.playerList);\n\t\t}\n\t}\n\n\tpublic getOpIndexs(opCards:number[]):number[]{\n\t\tlet myPlayer:Common.IPlayerInfo = PlayerMgr.getInstance().getMyPlayerInfo();\n\t\tlet indexs:number[] = []\n\t\tfor (let i = 0; i < opCards.length; i++) {\n\t\t\tconst index = myPlayer.handCards.indexOf(opCards[i]);\n\t\t\t//如果存在则添加\n\t\t\tif(index !== -1){\n\t\t\t\tindexs.push(index);\n\t\t\t}\n\t\t}\n\t\treturn indexs;\n\t}\n\n\tpublic updateMyhands(nums:number[]){\n\t\tlet myPlayer:Common.IPlayerInfo = PlayerMgr.getInstance().getMyPlayerInfo();\n\t\tmyPlayer.handCards = nums;\n\t}\n\n\tpublic getMyhands(): number[]{\n\t\tlet myPlayer:Common.IPlayerInfo = PlayerMgr.getInstance().getMyPlayerInfo();\n\t\treturn myPlayer.handCards\n\t}\n\n\tpublic getHandCardByIndex(index:number):number{\n\t\tlet myPlayer:Common.IPlayerInfo = PlayerMgr.getInstance().getMyPlayerInfo();\n\t\treturn myPlayer.handCards[index];\n\t}\n\n\tdeleteMyHands(bytes:number[]){\n\t\t\n\t}\n\n\t//要插入的牌在手牌中应有的位置\n    public getIndexByHandCards(insertCard: number, removeCard: number): number {\n        let myCards = this.getMyhands();\n        let cards = [...myCards];\n        for (let i = cards.length - 1; i >= 0; i--) { //如果此时手牌中还存在要移除的牌，则先移除，再计算插入牌的index\n            if (cards[i] === removeCard) {\n                cards.splice(i, 1);\n                break;\n            }\n        }\n        // console.log(\"=getIndexByHandCards=cards==\", cards, insertCard.toString(16), removeCard);\n\t\t//如果要插入的牌是小鸡，放在第一位\n\t\tif(CardUtil.getCardValue(insertCard) === \"0x21\"){\n\t\t\treturn 0;\n\t\t}\n\n        for (let index = 0; index < cards.length; index++) {\n            let card = cards[index];\n\t\t\tlet checkIndex\n            if (card == insertCard) {\n                checkIndex = index;\n            } else if (card < insertCard && index + 1 < cards.length && insertCard <= cards[index + 1]) {\n                checkIndex = index + 1;\n            } else if (index == cards.length - 1 && insertCard > card) {\n                checkIndex = cards.length;\n            }\n\t\t\t\n            if (checkIndex) {\n                return checkIndex;\n            }\n        }\n\t\t\n        return 0;\n    }\n\n\tpublic dumpMyHands(){\n\t\tlet myPlayer:Common.IPlayerInfo = PlayerMgr.getInstance().getMyPlayerInfo();\n\t\tlet majiangMap:string[] = [];\n\t\tfor (let i = 0; i < myPlayer.handCards.length; i++) {\n            let cardStr = CardUtil.getCardValue(myPlayer.handCards[i]);\n\t\t\tmajiangMap.push(MahjongMap.get(cardStr));\n        }\n\t\tconsole.log(\"dumpMyHands______________________\",majiangMap);\n\t}\n\n\tpublic updatePlayerCardsNum(cardsCount:number[]){\n\t\tfor (let i = 0; i < cardsCount.length; i++) {\n\t\t\tlet player :Common.IPlayerInfo = this.findPlayerWithSeatId(i+1);\n\t\t\tplayer.cardCount = cardsCount[i];\n\t\t}\n\t}\n\n\tpublic findOtherPlayer():Common.IPlayerInfo[]{\n\t\treturn this.playerList.filter(user => user.seatId === RoomMgr.getInstance().mySeatId);\n\t}\n\n\tpublic findPlayerWithUserId( userId: number): Common.IPlayerInfo {\n\t\treturn this.playerList.filter(user => user.userId === userId)[0];\n\t}\n\n\tpublic findPlayerWithSeatId( seatId: number): Common.IPlayerInfo {\n\t\treturn this.playerList.filter(user => user.seatId === seatId)[0];\n\t}\n\n\tpublic getMyPlayerInfo(): Common.IPlayerInfo{\n\t\tthis.myPlayerInfo = this.findPlayerWithSeatId(RoomMgr.getInstance().mySeatId);\n\t\treturn this.myPlayerInfo;\n\t}\n\n    //增加玩家\n\tpublic addPlayerList(info: Common.IPlayerInfo | Common.IPlayerInfo[]): void {\n\t\tthis.parseUseInfo(info);\n\t\tif (Array.isArray(info)) {\n\t\t\tconst newItems = info.filter(item => !this.playerList.some(({ userId }) => userId === item.userId));\n\t\t\tthis.playerList.push(...newItems);\n\t\t} else {\n\t\t\t\n\t\t\tconst exists = this.playerList.some(user => user.userId === info.userId);\n\t\t\tif(!exists){\n\t\t\t\tthis.playerList.push(info);\n\t\t\t}\n\t\t}\n\t\tthis.playerList = CardUtil.sortPlayersBySeatId(this.playerList,RoomMgr.getInstance().mySeatId);\n\t}\n\t//将玩家str解析\n\tpublic parseUseInfo(info: Common.IPlayerInfo | Common.IPlayerInfo[]){\n\t\tif (Array.isArray(info)) {\n\t\t\tinfo.forEach(item => {\n\t\t\t\titem.gameUserInfo = JSON.parse(item.strUserInfo)\n\t\t\t});\n\t\t} else {\n\t\t\tinfo.gameUserInfo = JSON.parse(info.strUserInfo)\n\t\t}\n\t}\n\t//删除玩家\n\tpublic deletePlayerList(info: Common.IPlayerInfo | Common.IPlayerInfo[]): void {\n\t\tif (Array.isArray(info)) {\n\t\t\tthis.playerList = this.playerList.filter((item) =>\n\t\t\t\t!info.some((otherItem) => otherItem.userId === item.userId)\n\t\t\t);\n\t\t} else {\n\t\t\tthis.playerList = this.playerList.filter(item => item.userId !== info.userId);\n\t\t}\n\t\tthis.playerList = CardUtil.sortPlayersBySeatId(this.playerList,RoomMgr.getInstance().mySeatId);\n\t}\n\t\n\n    //清理房间数据\n\tpublic clear(): void {\n\t\tthis.playerList = null;\n\t}\n\tgetPlayerReadyStatus(userId:number):number{\n\t\tlet player :Common.IPlayerInfo = this.findPlayerWithUserId(userId);\n\t\treturn player.isReady;\n\t}\n\tupdatePlayerReadyStatus(userId:number):void {\n\t\tlet player :Common.IPlayerInfo = this.findPlayerWithUserId(userId);\n\t\tplayer.isReady = 1;\n\t}\n\n\tupdatePlayerMoney(moneys:number[]):void {\n\t\tfor (let i = 0; i < moneys.length; i++) {\n\t\t\tlet player :Common.IPlayerInfo = this.findPlayerWithSeatId(i+1);\n\t\t\tplayer.money = moneys[i];\n\t\t}\n\t}\n\n\n\tupdateOutCards(resp:Game.IGrabCard): void {\n\t\tlet player :Common.IPlayerInfo = this.findPlayerWithUserId(resp.userId);\n\t\tlet card:Common.ICard = {\n\t\t\tcard: resp.card,\n\t\t\tstatus:0\n\t\t}\n\t\tplayer.outCards.push(card); \n\t}\n\n\tupdateHandCards(resp:Game.IHandCards):void {\n\t\tfor (let i = 0; i < resp.handCards.length; i++) {\n\t\t\tlet player :Common.IPlayerInfo = this.findPlayerWithSeatId(i+1);\n\t\t\tplayer.handCards = resp.handCards[i].handCards;\n\t\t\tplayer.huCard = resp.handCards[i].huCard;\n\t\t\tplayer.opGroups = resp.handCards[i].opGroups;\n\t\t\tplayer.tingCard = resp.handCards[i].tingCard;\n\t\t\tplayer.isUnTing = resp.handCards[i].isUnTing;\n\t\t\tplayer.customData = resp.handCards[i].customData;\n\t\t}\n\t}\n\t\n\t// public userOperationResult(resp:Game.IOperationResult) : void {\n\t// \tPlayerMgr.getInstance().userOperationResult(resp);\n\t// }\n\n\tdeletePlayerLeave(userId:number):void {\n\t\tthis.playerList = this.playerList.filter(item => item.userId !== userId);\n\t}\n\t\n\tupdatePlayerAiStatus(userId:number,isAi:number):void {\n\t\tlet player :Common.IPlayerInfo = this.findPlayerWithUserId(userId);\n\t\tplayer.isAi = isAi;\n\t}\n\n}"]}