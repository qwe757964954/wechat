{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/cache/SettleMgr.ts"],"names":["SettleMgr","BaseCache","CardUtil","PlayerMgr","RoomMgr","constructor","name","settleType","isShowGameOver","isBaoSanJia","jiesuanCustomData","settleModel","getInstance","instance","updateSelectInfo","resp","sortTotalInfo","totalInfo","forEach","info","player","findPlayerWithUserId","userId","seatId","sortPlayersBySeatId","mySeatId","getOpponentTotalInfo","myPlayer","getMyPlayerInfo","opponentInfo","filter","item","getMyTotalInfo","getWinPlayerInfo","moneyItemList","findPlayerWithSeatId","winSeatId","clear"],"mappings":"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","sourcesContent":["import { BaseCache } from \"../../../framework/vc/BaseCache\";\nimport { Common } from \"../common/idl/Common\";\nimport { Game } from \"../common/idl/Game\";\nimport { CardUtil } from \"../util/CardUtil\";\nimport { PlayerMgr } from \"./PlayerMgr\";\nimport { RoomMgr } from \"./RoomMgr\";\n\n\n\n\nexport class SettleMgr extends BaseCache {\n    \n    public settleType?: string = \"\";\n    \n    public isShowGameOver?: number = 0;\n\n    public isBaoSanJia?: boolean = false;\n\n    public jiesuanCustomData?: string = \"\";\n\n    public settleModel?: Game.ISettleModel = null;\n\n    // public isBaoSanJia?: boolean = false;\n\n    private static instance: SettleMgr | null = null;\n    \n\n    constructor(name = \"\") {\n\t\tsuper(name);\n\t};\n    public static getInstance(): SettleMgr {\n        if (!SettleMgr.instance) {\n            SettleMgr.instance = new SettleMgr();\n        }\n        return SettleMgr.instance;\n    }\n    updateSelectInfo(resp:Game.ISettleItem){\n        this.settleType = resp.settleType;\n        this.isShowGameOver = resp.isShowGameOver;\n        this.isBaoSanJia = resp.isBaoSanJia;\n        this.jiesuanCustomData = resp.jiesuanCustomData;\n        this.settleModel = resp.settleModel;\n        this.sortTotalInfo()\n    }\n\n    sortTotalInfo(){\n        this.settleModel.totalInfo.forEach(info => {\n            let player:Common.IPlayerInfo = PlayerMgr.getInstance().findPlayerWithUserId(info.userId);\n            info.seatId = player.seatId;\n        });\n        this.settleModel.totalInfo = CardUtil.sortPlayersBySeatId(this.settleModel.totalInfo,RoomMgr.getInstance().mySeatId);\n    }\n    \n\n    getOpponentTotalInfo():Game.ITotalInfo[]{\n        let myPlayer:Common.IPlayerInfo = PlayerMgr.getInstance().getMyPlayerInfo();\n        let opponentInfo:Game.ITotalInfo[] = this.settleModel.totalInfo.filter(item => item.userId !== myPlayer.userId);\n        return opponentInfo;\n    }\n\n    getMyTotalInfo():Game.ITotalInfo{\n        let myPlayer:Common.IPlayerInfo = PlayerMgr.getInstance().getMyPlayerInfo();\n        let opponentInfo:Game.ITotalInfo = this.settleModel.totalInfo.filter(item => item.userId === myPlayer.userId)[0];\n        return opponentInfo;\n    }\n\n    getWinPlayerInfo():Common.IPlayerInfo{\n        let player:Common.IPlayerInfo = null;\n        this.settleModel.moneyItemList.forEach((item:Game.ISettleMoneyItem) => {\n            player = PlayerMgr.getInstance().findPlayerWithSeatId(item.winSeatId);\n        });\n        return player\n    }\n\n    //清理房间数据\n\tpublic clear(): void {\n\t\t\n\t}\n}\n"]}