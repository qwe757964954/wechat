{"version":3,"sources":["file:///Users/mac/work/WXGame_FlySmallChick/assets/package/game/scripts/GameChatPrefabCtr.ts"],"names":["Button","Color","LabelComponent","Node","Sprite","SpriteAtlas","_decorator","instantiate","GCache","Utils","resLoader","EventManager","BaseComponent","FXJConstant","FXJEvent","FXJRes","FXJSound","ccclass","property","menu","GameChatPrefabCtr","tooltip","type","onInitModuleEvent","onLoad","hideMaskNode","updateView","changeTag","tabMsg","maskNode","node","parent","getChildByName","active","start","chooseNode","getComponent","interactable","tabEmoji","msgList","emojiList","nodeMsg","nodeEmoji","updateMessageList","updateEmoList","chatTextData","hotTxtConfig","ChatText","hot","i","length","data","tag","index","String","text","push","classicTxtConfig","classic","majiangTxtConfig","majiang","currowDaysNum","msgContent","children","addChild","removeFromParent","updateMsgItem","item","isEndIndx","buttonComp","txtLabel","tab_line","frameName","string_format","Atlas_Game_Desk","plistKey","load","bundle","path","err","atlas","isValid","spriteFrame","getSpriteFrame","spriteComponent","sizeMode","fontColor","tag_role","tag_hot","tag_classic","labelComponent","string","color","emojiDataList","key","resConf","console","log","emojiContent","updateEmojiItem","onClickTabMenu","event","dispatch","SYS_PLAY_EFFECT","CommClick","currentTarget","onMsgClick","param","GAME_REQ_PLAYER_CHAET_MSG","gender","User","getUserSex","QuickChatXiaoBo","QuickChatXiaoYa","destroy","onEmojiClick","GAME_REQ_PLAYER_CHAET_EMOJI","onCloseClick","onDestroy"],"mappings":"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","sourcesContent":["\nimport { Button, Color, EventTouch, LabelComponent, Node, Sprite, SpriteAtlas, _decorator, instantiate } from 'cc';\nimport { GCache } from '../../../cache/GCache';\nimport { Utils } from '../../../framework/Utils';\nimport { resLoader } from '../../../framework/loader/ResLoader';\nimport { EventManager } from '../../../framework/manager/EventManager';\nimport { BaseComponent } from '../../../framework/vc/BaseComponent';\nimport { FXJConstant } from '../common/FXJConstant';\nimport { FXJEvent } from '../common/FXJEvent';\nimport { FXJRes } from '../common/FXJRes';\nimport { FXJSound } from '../common/FXJSound';\nconst { ccclass, property, menu } = _decorator;\n\n/**\n * Name = GameChatPrefabCtr\n * URL = db://assets/package/game/scripts/GameChatPrefabCtr.ts\n * Time = Fri Sep 09 2022 11:52:39 GMT+0800 (中国标准时间)\n * Author = Tomoe\n * 游戏聊天界面\n * Life: onLoad-->onEnable->start->update->lateUpdate->onDisable->onDestroy\n */\n\n@ccclass('GameChatPrefabCtr')\n//方便编辑器识别的菜单项目\n@menu('prefab/game/GameChatPrefabCtr')\nexport class GameChatPrefabCtr extends BaseComponent {\n\n\t//标签-常用语\n\t@property({ tooltip: \"标签-常用语\", type: Node })\n\tprivate tabMsg: Node | null = null;\n\t//标签-表情\n\t@property({ tooltip: \"标签-表情\", type: Node })\n\tprivate tabEmoji: Node | null = null;\n\t//常用语列表\n\t@property({ tooltip: \"常用语列表\", type: Node })\n\tprivate msgList: Node | null = null;\n\n\t//表情列表\n\t@property({ tooltip: \"表情列表\", type: Node })\n\tprivate emojiList: Node | null = null;\n\n\t//常用语父节点\n\t@property({ tooltip: \"常用语父节点\", type: Node })\n\tprivate msgContent: Node | null = null;\n\n\t//表情父节点\n\t@property({ tooltip: \"表情父节点\", type: Node })\n\tprivate emojiContent: Node | null = null;\n\n\t//常用语节点\n\t@property({ tooltip: \"常用语节点\", type: Node })\n\tprivate nodeMsg: Node | null = null;\n\n\t//表情节点\n\t@property({ tooltip: \"表情节点\", type: Node })\n\tprivate nodeEmoji: Node | null = null;\n\n\tonInitModuleEvent() {\n\t\t\n\t}\n\tonLoad() {\n\t\tthis.hideMaskNode();\n\t\tthis.updateView();\n\t\tthis.changeTag(this.tabMsg);\n\t};\n\n\t/** 隐藏遮罩层 */\n\thideMaskNode() {\n\t\tlet maskNode = this.node.parent.getChildByName(\"Mask\");\n\t\tif (maskNode) {\n\t\t\tmaskNode.active = false;\n\t\t}\n\t}\n\tstart() {\n\n\t};\n\n\n\t/** 标签切换 */\n\tchangeTag(chooseNode: Node) {\n\t\tchooseNode.getComponent(Button).interactable = false;\n\t\tchooseNode.getChildByName(\"Checkmark\").active = true;\n\t\tif (chooseNode == this.tabMsg) {\n\t\t\tthis.tabEmoji.getComponent(Button).interactable = true;\n\t\t\tthis.tabEmoji.getChildByName(\"Checkmark\").active = false;\n\n\t\t\tthis.msgList.active = true;\n\t\t\tthis.emojiList.active = false;\n\t\t} else if (chooseNode == this.tabEmoji) {\n\t\t\tthis.tabMsg.getComponent(Button).interactable = true;\n\t\t\tthis.tabMsg.getChildByName(\"Checkmark\").active = false;\n\n\t\t\tthis.msgList.active = false;\n\t\t\tthis.emojiList.active = true;\n\t\t}\n\t}\n\tupdateView() {\n\t\tthis.nodeMsg.active = false;\n\t\tthis.nodeEmoji.active = false;\n\t\tthis.updateMessageList();\n\t\tthis.updateEmoList();\n\t}\n\t/** 更新消息列表 */\n\tupdateMessageList() {\n\t\tlet chatTextData = [];\n\t\t\n\t\t//热门聊天语\n\t\tlet hotTxtConfig = FXJConstant.ChatText.hot;\n\t\tfor (let i = 0; i < hotTxtConfig.length; i++) {\n\t\t\tlet data = {\n\t\t\t\ttag: \"tag_hot\",\n\t\t\t\t// index: String(i + 1),\n\t\t\t\tindex: \"hot_\"+String(i),\n\t\t\t\ttext: hotTxtConfig[i],\n\t\t\t}\n\t\t\tif (i == 0) {\n\t\t\t\tdata[\"isTag\"] = true;\n\t\t\t}\n\t\t\tchatTextData.push(data);\n\t\t}\n\n\t\t//经典聊天语\n\t\tlet classicTxtConfig = FXJConstant.ChatText.classic;\n\t\tfor (let i = 0; i < classicTxtConfig.length; i++) {\n\t\t\tlet data = {\n\t\t\t\ttag: \"tag_classic\",\n\t\t\t\t// index: \"Classic_\" + String(i + 1),\n\t\t\t\tindex: \"classic_\" + String(i),\n\t\t\t\ttext: classicTxtConfig[i],\n\t\t\t}\n\t\t\tif (i == 0) {\n\t\t\t\tdata[\"isTag\"] = true;\n\t\t\t}\n\t\t\tchatTextData.push(data);\n\t\t}\n\n\t\t//麻将聊天语\n\t\tlet majiangTxtConfig = FXJConstant.ChatText.majiang;\n\t\tfor (let i = 0; i < majiangTxtConfig.length; i++) {\n\t\t\tlet data = {\n\t\t\t\ttag: \"tag_majiang\",\n\t\t\t\t// index: \"majiang_\" + String(i + 1),\n\t\t\t\tindex: \"majiang_\" + String(i),\n\t\t\t\ttext: majiangTxtConfig[i],\n\t\t\t}\n\t\t\tif (i == 0) {\n\t\t\t\tdata[\"isTag\"] = true;\n\t\t\t}\n\t\t\tchatTextData.push(data);\n\t\t}\n\t\t\n\t\tlet currowDaysNum = this.msgContent.children.length;\n\t\tif (currowDaysNum < chatTextData.length) {\n\t\t\tfor (let i = currowDaysNum; i < chatTextData.length; i++) {\n\t\t\t\tlet node = instantiate(this.nodeMsg);\n\t\t\t\tthis.msgContent.addChild(node);\n\t\t\t}\n\t\t} else if (currowDaysNum > chatTextData.length) {\n\t\t\tfor (let i = (currowDaysNum - 1); i >= chatTextData.length; i--) {\n\t\t\t\tlet node = this.msgContent.children[i];\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.removeFromParent();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (let i = 0; i < this.msgContent.children.length; i++) {\n\t\t\tlet node = this.msgContent.children[i];\n\t\t\tthis.updateMsgItem(node, i, chatTextData[i], i == (chatTextData.length - 1));\n\t\t}\n\t}\n\t/** 更新单条消息 */\n\tupdateMsgItem(item: Node, index: number, data, isEndIndx: boolean = false) {\n\t\titem.active = true;\n\t\tlet buttonComp = item.getComponent(Button);\n\n\t\titem[\"chatMsg\"] = data;\n\n\t\tlet tag = item.getChildByName(\"tag\");\n\t\tlet txtLabel = item.getChildByName(\"Label\");\n\t\tlet tab_line = item.getChildByName(\"tab_line\");\n\n\t\ttab_line.active = (isEndIndx != true);\n\n\t\tif (data) {\n\t\t\tbuttonComp.interactable = true;\n\t\t\tif (data[\"isTag\"] && data[\"tag\"]) {\n\t\t\t\tlet frameName = Utils.string_format(FXJRes.Atlas_Game_Desk.plistKey, data[\"tag\"])\n\t\t\t\tresLoader.load(FXJRes.Atlas_Game_Desk.bundle, FXJRes.Atlas_Game_Desk.path, SpriteAtlas, (err: Error | null, atlas) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tif (!tag || tag.isValid == false) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tlet spriteFrame = atlas.getSpriteFrame(frameName)\n\t\t\t\t\tif (spriteFrame) {\n\t\t\t\t\t\tlet spriteComponent = tag.getComponent(Sprite);\n\t\t\t\t\t\tspriteComponent.sizeMode = 0;\n\t\t\t\t\t\tspriteComponent.spriteFrame = spriteFrame;\n\t\t\t\t\t\ttag.active = true;\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\ttag.active = false;\n\t\t\t}\n\t\t\tif (data[\"text\"] != null) {\n\t\t\t\tlet fontColor = {\n\t\t\t\t\ttag_role: new Color(163, 138, 231),\n\t\t\t\t\ttag_hot: new Color(241, 110, 63),\n\t\t\t\t\ttag_classic: new Color(145, 81, 19),\n\t\t\t\t}\n\t\t\t\tlet labelComponent = txtLabel.getComponent(LabelComponent);\n\t\t\t\tlabelComponent.string = data[\"text\"] || \"\";\n\t\t\t\tif (fontColor[data[\"tag\"]]) {\n\t\t\t\t\tlabelComponent.color = fontColor[data[\"tag\"]];\n\t\t\t\t}\n\t\t\t\ttxtLabel.active = true;\n\t\t\t}\n\t\t} else {\n\t\t\ttag.active = false;\n\t\t\ttxtLabel.active = false;\n\t\t\tbuttonComp.interactable = false;\n\t\t}\n\t}\n\n\n\t/** 更新 */\n\tupdateEmoList() {\n\t\tlet emojiDataList = [];\n\t\tfor (let i = 0; i < 16; i++) {\n\t\t\tlet key = Utils.string_format(FXJRes.Atlas_Game_Desk.plistKey, \"emoji_default_\" + String(i + 1));\n\t\t\tlet resConf = {\n\t\t\t\tbundle: FXJRes.Atlas_Game_Desk.bundle,\n\t\t\t\tpath: FXJRes.Atlas_Game_Desk.path,\n\t\t\t\tplistKey: key\n\t\t\t}\n\t\t\temojiDataList.push(resConf);\n\t\t}\n\t\tconsole.log(\"emojiDataList==>\", emojiDataList)\n\t\tlet currowDaysNum = this.emojiContent.children.length;\n\t\tif (currowDaysNum < emojiDataList.length) {\n\t\t\tfor (let i = currowDaysNum; i < emojiDataList.length; i++) {\n\t\t\t\tlet node = instantiate(this.nodeEmoji);\n\t\t\t\tthis.emojiContent.addChild(node);\n\t\t\t}\n\t\t} else if (currowDaysNum > emojiDataList.length) {\n\t\t\tfor (let i = (currowDaysNum - 1); i >= emojiDataList.length; i--) {\n\t\t\t\tlet node = this.emojiContent.children[i];\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.removeFromParent();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (let i = 0; i < this.emojiContent.children.length; i++) {\n\t\t\tlet node = this.emojiContent.children[i];\n\t\t\tthis.updateEmojiItem(node, i, emojiDataList[i], i == (emojiDataList.length - 1));\n\t\t}\n\t}\n\t/** 更新单个表情 */\n\tupdateEmojiItem(item: Node, index: number, data, isEndIndx: boolean = false) {\n\t\tlet buttonComp = item.getComponent(Button);\n\n\t\titem[\"chatMsg\"] = String(index + 1);\n\n\t\tif (data) {\n\t\t\tbuttonComp.interactable = true;\n\t\t\tresLoader.load(data.bundle, data.path, SpriteAtlas, (err: Error | null, atlas) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tif (!item || item.isValid == false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet spriteFrame = atlas.getSpriteFrame(data.plistKey)\n\t\t\t\tif (spriteFrame) {\n\t\t\t\t\tlet spriteComponent = item.getComponent(Sprite);\n\t\t\t\t\tspriteComponent.sizeMode = 0;\n\t\t\t\t\tspriteComponent.spriteFrame = spriteFrame;\n\t\t\t\t\titem.active = true;\n\t\t\t\t}\n\t\t\t})\n\n\t\t} else {\n\t\t\tbuttonComp.interactable = false;\n\t\t}\n\n\t}\n\n\t/** tab标签的点击事件 */\n\tonClickTabMenu(event: EventTouch) {\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tthis.changeTag(event.currentTarget);\n\t}\n\n\t//点击发送快捷短语\n\tonMsgClick(event: EventTouch) {\n\t\tconsole.log(\"点击发送快捷短语\", event.currentTarget[\"chatMsg\"]);\n\t\tif (event.currentTarget[\"chatMsg\"] == null) {\n\t\t\treturn;\n\t\t}\n\t\t// {\n\t\t// \t\"tag\": \"tag_hot\",\n\t\t// \t\"index\": \"hot_1\",\n\t\t// \t\"text\": \"搞快点!搞快点!\"\n\t\t// }\n\t\tlet param = event.currentTarget[\"chatMsg\"];\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tEventManager.dispatch(FXJEvent.GAME_REQ_PLAYER_CHAET_MSG, param[\"index\"], param[\"text\"]);\n\t\tlet gender = GCache.User.getUserSex();\n\t\tif (gender==2) {\n\t\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, { bundle: FXJSound.QuickChatXiaoBo.bundle, path: FXJSound.QuickChatXiaoYa.path + param['index']});\n\t\t} else {\n\t\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, { bundle: FXJSound.QuickChatXiaoBo.bundle, path: FXJSound.QuickChatXiaoBo.path + param['index']});\n\t\t}\t\n\t\tthis.node.destroy();\n\t}\n\n\t//点击发送表情\n\tonEmojiClick(event: EventTouch) {\n\t\tconsole.log(\"点击发送表情\", event.currentTarget[\"chatMsg\"]);\n\t\tif (event.currentTarget[\"chatMsg\"] == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet param = event.currentTarget[\"chatMsg\"];\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\n\t\tEventManager.dispatch(FXJEvent.GAME_REQ_PLAYER_CHAET_EMOJI, param)\n\n\t\tthis.node.destroy();\n\t}\n\n\t//点击关闭界面\n\tonCloseClick(event: Event) {\n\t\tconsole.log(\"点击事件响应===>>>>关闭界面\");\n\t\tEventManager.dispatch(FXJEvent.SYS_PLAY_EFFECT, FXJSound.CommClick);\n\t\tthis.node.destroy();\n\t}\n\n\t//销毁\n\tonDestroy() {\n\n\t};\n\n}\n\n"]}